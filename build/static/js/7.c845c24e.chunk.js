(this["webpackJsonpbarnbridge-frontend"]=this["webpackJsonpbarnbridge-frontend"]||[]).push([[7],{1709:function(e,t,a){e.exports={tabs:"s_tabs__28uev",simple:"s_simple__3E-6U"}},1715:function(e,t,a){e.exports={divider:"s_divider__3YM-J"}},1717:function(e,t,a){e.exports={skeleton:"s_skeleton__3FB8I"}},1727:function(e,t,a){e.exports={component:"s_component__2OyQF",separator:"s_separator__2jXLs",list:"s_list__1TTsx",row:"s_row__1G0VL",term:"s_term__1Hf4T",termIcon:"s_termIcon__2ojvb",data:"s_data__PBmCp",dataIcon:"s_dataIcon__2hNBh"}},1728:function(e,t,a){e.exports={component:"s_component__3Mvxm",items:"s_items__12xaa",ratio:"s_ratio__2PnO1"}},1729:function(e,t,a){e.exports={component:"s_component__1YiEf",acceptance:"s_acceptance__3YfK4",fulfilled:"s_fulfilled__3gPu5"}},1735:function(e,t,a){e.exports={component:"s_component___p2il"}},1812:function(e,t,a){e.exports={cards:"s_cards__Stj_L"}},1813:function(e,t,a){e.exports={tabs:"s_tabs__32Wke",shadows:"s_shadows__12PQF",tab:"s_tab__2wEah",active:"s_active__1mayN",disabled:"s_disabled__xaH2p",elasticTabs:"s_elasticTabs__2URoC",elasticToggle:"s_elasticToggle__3M_xZ",small:"s_small__c6etg",horizontalMenu:"s_horizontalMenu__3BcI1"}},1814:function(e,t,a){e.exports={form:"s_form__36nMg",item:"s_item__2gbuN"}},1828:function(e,t,a){e.exports={component:"s_component__2RWFR"}},1829:function(e,t,a){e.exports={list:"s_list__mhVNU"}},1830:function(e,t,a){e.exports={divider:"s_divider__1jS-8"}},1831:function(e,t,a){e.exports={component:"s_component__bp6jU"}},1836:function(e,t,a){e.exports={form:"s_form__373JW",disabled:"s_disabled__gL2Qr"}},1837:function(e,t,a){e.exports={spinner:"s_spinner__2lxg5",rotate:"s_rotate__K9I_G",container:"s_container__2DwVy",children:"s_children__1ZC_G"}},1838:function(e,t,a){e.exports={statusTag:"s_statusTag__qs55u",red:"s_red__1poW_",green:"s_green__2QiFO",blue:"s_blue__1mk4Q"}},1839:function(e,t,a){e.exports={component:"s_component__2HckH",disabled:"s_disabled__3ybza"}},1849:function(e,t,a){e.exports={component:"s_component__2hCqz"}},1850:function(e,t,a){e.exports={cards:"s_cards__SMmvy",card:"s_card__3ZxAU",selected:"s_selected__5uLwB"}},1852:function(e,t,a){e.exports={tokenSelectList:"s_tokenSelectList__1rsig",tokenSelectListButton:"s_tokenSelectListButton__898YC",active:"s_active__1VA0m",dropdown:"s_dropdown__2I7kF",large:"s_large__uF7P8",dropdownChevron:"s_dropdownChevron__3cfM7"}},1854:function(e,t,a){e.exports={input:"s_input__1b3rZ"}},1855:function(e,t,a){e.exports={tokenAmount:"s_tokenAmount__2n5WY",error:"s_error__3x3RW",tokenAmountBefore:"s_tokenAmountBefore__3YeAZ",tokenAmountValues:"s_tokenAmountValues__1qT2P",tokenAmountValue:"s_tokenAmountValue__2mG1w",tokenAmountHint:"s_tokenAmountHint__3Jk8f",tokenAmountSlider:"s_tokenAmountSlider__2LNhd",tokenAmountPreview:"s_tokenAmountPreview__1qEON",tokenAmountPreviewBefore:"s_tokenAmountPreviewBefore__2ZTVO",tokenAmountPreviewValues:"s_tokenAmountPreviewValues__3WU83",tokenAmountPreviewValue:"s_tokenAmountPreviewValue__2CGmA",tokenAmountPreviewHint:"s_tokenAmountPreviewHint__1XGYo",tokenSelectTrigger:"s_tokenSelectTrigger__39PsM",tokenSelectChevron:"s_tokenSelectChevron__3_diD",tokenSelectListButton:"s_tokenSelectListButton__qrRSq",active:"s_active__hEyw6",tokenAmountSelectToken:"s_tokenAmountSelectToken__8QBHp"}},1857:function(e,t,a){e.exports={component:"s_component__3feGb",dropdown:"s_dropdown__ggOEG"}},1871:function(e,t,a){e.exports={component:"s_component__HvMmO"}},1872:function(e,t,a){e.exports={component:"s_component__QDW8F"}},1873:function(e,t,a){e.exports={component:"s_component__1YTqh"}},1874:function(e,t,a){e.exports={component:"s_component__lLKM4",content:"s_content__VOUyb",footer:"s_footer__teV8K"}},1880:function(e,t,a){e.exports={content:"s_content__3uru7",address:"s_address__1a35W",paragraph:"s_paragraph__2QppP",expanded:"s_expanded__1OewS"}},1898:function(e,t,a){e.exports={component:"s_component__2wkK2",wrap:"s_wrap__s3gkd",form:"s_form__2n-lq",textarea:"s_textarea__2EyBJ",actions:"s_actions__2fHLy"}},1901:function(e,t,a){e.exports={addActionBtn:"s_addActionBtn__mtRzB",cardsContainer:"s_cardsContainer__1ejSo"}},1902:function(e,t,a){e.exports={component:"s_component__3DYra",tabs:"s_tabs__WlGiL",table:"s_table__KDN67",powerCell:"s_powerCell__2ikNm",forTag:"s_forTag__3hKyp",againstTag:"s_againstTag__2mGqw"}},1903:function(e,t,a){e.exports={component:"s_component__3p9EE",row:"s_row__2g1jK",changeGroup:"s_changeGroup__139DU",actionBtn:"s_actionBtn__3HPoz"}},1904:function(e,t,a){e.exports={component:"s_component__3oQBs"}},1905:function(e,t,a){e.exports={component:"s_component__1YyNj",tabs:"s_tabs__2j20Y",table:"s_table__1-kJz",powerCell:"s_powerCell__21xuC",forTag:"s_forTag__3h46w",againstTag:"s_againstTag__3ZoLW"}},1906:function(e,t,a){e.exports={component:"s_component__9_R9p",row:"s_row__1roRu",changeGroup:"s_changeGroup__1yheK",actionBtn:"s_actionBtn__1d105"}},1907:function(e,t,a){e.exports={component:"s_component__rqoCF",row:"s_row__2-bC9",actionBtn:"s_actionBtn__33Ovt"}},1908:function(e,t,a){e.exports={cardsAndSidebarContainer:"s_cardsAndSidebarContainer__1Pd9o",cardsContainer:"s_cardsContainer__29QWl",sidebarContainer:"s_sidebarContainer__288P0"}},1909:function(e,t,a){e.exports={tabs:"s_tabs__3o4xa",search:"s_search__1fxlk"}},1910:function(e,t,a){e.exports={pagination:"s_pagination__3UMZt",page:"s_page__29oPu",separator:"s_separator__1n_F1",prev:"s_prev__2g1Q9",next:"s_next__d_WwI",active:"s_active__ec-7d"}},1911:function(e,t,a){e.exports={tableContainer:"s_tableContainer__2Dki2",loading:"s_loading__1OMuZ",table:"s_table__Nd1Ke",clickable:"s_clickable__1x0tg",arrowIcon:"s_arrowIcon__1zygh",tableFooter:"s_tableFooter__3iZZl",spinner:"s_spinner__1axuf"}},1912:function(e,t,a){e.exports={tabs:"s_tabs__2blvo"}},1930:function(e,t,a){"use strict";a.r(t);var n=a(5),o=a(0),r=a.n(o),c=a(53),i=a(4),s=a(17),l=a(1534),d=a.n(l),u=a(8),b=a.n(u),j=a(1709),p=a.n(j),h=a(1),m=["className"],O=["className","simple"],f=function(e){var t=e.className,a=e.simple,n=void 0!==a&&a,o=Object(s.a)(e,O);return Object(h.jsx)(d.a,Object(i.a)({className:b()(p.a.tabs,t,n&&p.a.simple),tabBarGutter:32},o))};f.Tab=function(e){var t=e.className,a=Object(s.a)(e,m);return Object(h.jsx)(d.a.TabPane,Object(i.a)({className:b()(p.a.tab,t)},a))};var g,v,x=f,w=a(39),y=a(47),k=a(63),N=a(12),A=a(19),C=a.n(A),_=a(600),S=a.n(_),V=a(62),P=a(45),D=a(57),E=a(70),T=["status"],F=["status"],R=["status"],I=["status"];!function(e){e.CREATED="CREATED",e.WARMUP="WARMUP",e.ACTIVE="ACTIVE",e.CANCELED="CANCELED",e.FAILED="FAILED",e.ACCEPTED="ACCEPTED",e.QUEUED="QUEUED",e.GRACE="GRACE",e.EXPIRED="EXPIRED",e.EXECUTED="EXECUTED",e.ABROGATED="ABROGATED"}(g||(g={})),function(e){e[e.WARMUP=0]="WARMUP",e[e.ACTIVE=1]="ACTIVE",e[e.CANCELED=2]="CANCELED",e[e.FAILED=3]="FAILED",e[e.ACCEPTED=4]="ACCEPTED",e[e.QUEUED=5]="QUEUED",e[e.GRACE=6]="GRACE",e[e.EXPIRED=7]="EXPIRED",e[e.EXECUTED=8]="EXECUTED",e[e.ABROGATED=9]="ABROGATED"}(v||(v={}));var B=new Map([[g.CREATED,"Created"],[g.WARMUP,"Warm-Up"],[g.ACTIVE,"Voting"],[g.CANCELED,"Canceled"],[g.FAILED,"Failed"],[g.ACCEPTED,"Accepted"],[g.QUEUED,"Queued for execution"],[g.GRACE,"Pending execution"],[g.EXPIRED,"Expired"],[g.EXECUTED,"Executed"],[g.ABROGATED,"Abrogated"]]),U=Object(o.createContext)(Object(D.a)("DaoAPIProvider"));function M(){return Object(o.useContext)(U)}var L=function(e){var t=Object(P.b)();var a={fetchOverviewData:function(){var e=new URL("/api/governance/overview",t.api.baseUrl);return fetch(e.toString()).then((function(e){return e.json()})).then((function(e){return Object(i.a)(Object(i.a)({},e.data),{},{totalDelegatedPower:Object(V.e)(C.a.from(e.data.totalDelegatedPower),18),totalVbond:Object(V.e)(C.a.from(e.data.totalVbond),18)})}))},fetchVoters:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=new URL("/api/governance/voters?page=".concat(e,"&limit=").concat(a),t.api.baseUrl);return fetch(n.toString()).then((function(e){return e.json()})).then((function(e){var t;return Object(i.a)(Object(i.a)({},e),{},{data:(null!==(t=e.data)&&void 0!==t?t:[]).map((function(e){return Object(i.a)(Object(i.a)({},e),{},{bondStaked:Object(V.e)(C.a.from(e.bondStaked),18),delegatedPower:Object(V.e)(C.a.from(e.delegatedPower),18),votingPower:Object(V.e)(C.a.from(e.votingPower),18)})}))})}))},fetchProposals:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,r=S.a.stringify({page:String(e),limit:String(a),state:n,title:o},{skipNull:!0,skipEmptyString:!0,encode:!0}),c=new URL("/api/governance/proposals?".concat(r),t.api.baseUrl);return fetch(c.toString()).then((function(e){return e.json()})).then((function(e){var t=e.status,a=Object(s.a)(e,T);return 200!==t?Promise.reject(t):a})).then((function(e){var t;return Object(i.a)(Object(i.a)({},e),{},{data:(null!==(t=e.data)&&void 0!==t?t:[]).map((function(e){return Object(i.a)(Object(i.a)({},e),{},{forVotes:Object(V.e)(C.a.from(e.forVotes),18),againstVotes:Object(V.e)(C.a.from(e.againstVotes),18)})}))})}))},fetchProposal:function(e){var a=new URL("/api/governance/proposals/".concat(e),t.api.baseUrl);return fetch(a.toString()).then((function(e){return e.json()})).then((function(e){var t=e.data,a=e.status;return 200!==a?Promise.reject(a):t})).then((function(e){return Object(i.a)(Object(i.a)({},e),{},{forVotes:Object(V.e)(C.a.from(e.forVotes),18),againstVotes:Object(V.e)(C.a.from(e.againstVotes),18)})}))},fetchProposalVoters:function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,o=arguments.length>3?arguments[3]:void 0,r=S.a.stringify({page:String(a),limit:String(n),support:o},{skipNull:!0,skipEmptyString:!0,encode:!0}),c=new URL("/api/governance/proposals/".concat(e,"/votes?").concat(r),t.api.baseUrl);return fetch(c.toString()).then((function(e){return e.json()})).then((function(e){var t=e.status,a=Object(s.a)(e,F);return 200!==t?Promise.reject(t):a})).then((function(e){var t;return Object(i.a)(Object(i.a)({},e),{},{data:(null!==(t=e.data)&&void 0!==t?t:[]).map((function(e){return Object(i.a)(Object(i.a)({},e),{},{power:Object(V.e)(C.a.from(e.power),18)})}))})}))},fetchAbrogation:function(e){var a=new URL("/api/governance/abrogation-proposals/".concat(e),t.api.baseUrl);return fetch(a.toString()).then((function(e){return e.json()})).then((function(e){var t=e.data,a=e.status;return 200!==a?Promise.reject(a):t})).then((function(e){return Object(i.a)(Object(i.a)({},e),{},{forVotes:Object(V.e)(C.a.from(e.forVotes),18),againstVotes:Object(V.e)(C.a.from(e.againstVotes),18)})}))},fetchAbrogationVoters:function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,o=arguments.length>3?arguments[3]:void 0,r=S.a.stringify({page:String(a),limit:String(n),support:o},{skipNull:!0,skipEmptyString:!0,encode:!0}),c=new URL("/api/governance/abrogation-proposals/".concat(e,"/votes?").concat(r),t.api.baseUrl);return fetch(c.toString()).then((function(e){return e.json()})).then((function(e){var t=e.status,a=Object(s.a)(e,R);return 200!==t?Promise.reject(t):a})).then((function(e){var t;return Object(i.a)(Object(i.a)({},e),{},{data:(null!==(t=e.data)&&void 0!==t?t:[]).map((function(e){return Object(i.a)(Object(i.a)({},e),{},{power:Object(V.e)(C.a.from(e.power),18)})}))})}))},fetchTreasuryTokens:function(){var e,a=new URL("/api/governance/treasury/tokens?address=".concat(null===(e=t.contracts.dao)||void 0===e?void 0:e.governance),t.api.baseUrl);return fetch(a.toString()).then((function(e){return e.json()})).then((function(e){var t=e.status,a=e.data;return 200!==t?Promise.reject(t):a}))},fetchTreasuryHistory:function(){var e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,o=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,c=S.a.stringify({address:null===(e=t.contracts.dao)||void 0===e?void 0:e.governance,page:String(a),limit:String(n),tokenAddress:o,transactionDirection:r},{skipNull:!0,skipEmptyString:!0,encode:!0}),l=new URL("/api/governance/treasury/transactions?".concat(c),t.api.baseUrl);return fetch(l.toString()).then((function(e){return e.json()})).then((function(e){var t=e.status,a=Object(s.a)(e,I);return 200!==t?Promise.reject(t):a})).then((function(e){var t;return Object(i.a)(Object(i.a)({},e),{},{data:(null!==(t=e.data)&&void 0!==t?t:[]).map((function(e){return Object(i.a)(Object(i.a)({},e),{},{amount:Number(e.amount)})}))})}))}};return Object(h.jsx)(U.Provider,{value:a,children:e.children})};var q=a(73),G=a(68),Y=a(179),W=a(409),z=a(27),Q=a(14),Z=a(16),H=a(22),K=a(23),X=a(9),$=a.n(X),J=a(36),ee=[Object(J.b)("bondStaked",[],["uint256"]),Object(J.b)("balanceOf",["address"],["uint256"]),Object(J.b)("votingPower",["address"],["uint256"]),Object(J.b)("userLockedUntil",["address"],["uint256"]),Object(J.b)("delegatedPower",["address"],["uint256"]),Object(J.b)("userDelegatedTo",["address"],["address"]),Object(J.b)("bondStakedAtTs",["uint256"],["uint256"]),Object(J.b)("votingPowerAtTs",["address","uint256"],["uint256"]),Object(J.b)("multiplierAtTs",["address","uint256"],["uint256"]),Object(J.b)("deposit",["uint256"],[]),Object(J.b)("withdraw",["uint256"],[]),Object(J.b)("delegate",["address"],[]),Object(J.b)("stopDelegate",[],[]),Object(J.b)("lock",["uint256"],[])],te=function(e){Object(H.a)(a,e);var t=Object(K.a)(a);function a(e){var n;return Object(Q.a)(this,a),(n=t.call(this,ee,e,"DAO Barn")).bondStaked=void 0,n.balance=void 0,n.votingPower=void 0,n.userLockedUntil=void 0,n.delegatedPower=void 0,n.userDelegatedTo=void 0,n.on(J.c.UPDATE_ACCOUNT,(function(){n.balance=void 0,n.votingPower=void 0,n.userLockedUntil=void 0,n.delegatedPower=void 0,n.userDelegatedTo=void 0})),n}return Object(Z.a)(a,[{key:"isUserLocked",get:function(){var e;return(null!==(e=this.userLockedUntil)&&void 0!==e?e:0)>Date.now()/1e3}},{key:"loadCommonData",value:function(){var e=Object(z.a)($.a.mark((function e(){var t,a,o;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.batch([{method:"bondStaked"}]);case 2:t=e.sent,a=Object(n.a)(t,1),o=a[0],this.bondStaked=new C.a(o).unscaleBy(18),this.emit(J.c.UPDATE_DATA);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadUserData",value:function(){var e=Object(z.a)($.a.mark((function e(){var t,a,o,r,c,i,s,l;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.account,this.assertAccount(),e.next=4,this.batch([{method:"balanceOf",methodArgs:[t]},{method:"votingPower",methodArgs:[t]},{method:"userLockedUntil",methodArgs:[t]},{method:"delegatedPower",methodArgs:[t]},{method:"userDelegatedTo",methodArgs:[t]}]);case 4:a=e.sent,o=Object(n.a)(a,5),r=o[0],c=o[1],i=o[2],s=o[3],l=o[4],this.balance=new C.a(r).unscaleBy(18),this.votingPower=new C.a(c).unscaleBy(18),this.userLockedUntil=Number(i),this.delegatedPower=new C.a(s).unscaleBy(18),this.userDelegatedTo=l,this.emit(J.c.UPDATE_DATA);case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getBondStakedAtTs",value:function(e){return this.call("bondStakedAtTs",[e]).then((function(e){return new C.a(e).unscaleBy(18)}))}},{key:"getVotingPower",value:function(e){return this.call("votingPower",[e]).then((function(e){return new C.a(e).unscaleBy(18)}))}},{key:"getVotingPowerAtTs",value:function(e,t){return this.call("votingPowerAtTs",[e,t]).then((function(e){return new C.a(e).unscaleBy(18)}))}},{key:"getMultiplierAtTs",value:function(e,t){return this.call("votingPowerAtTs",[e,t]).then((function(e){return new C.a(e).unscaleBy(18)}))}},{key:"deposit",value:function(e,t){return this.send("deposit",[e],{},t)}},{key:"withdraw",value:function(e,t){return this.send("withdraw",[e],{},t)}},{key:"delegate",value:function(e,t){return this.send("delegate",[e],{},t)}},{key:"stopDelegate",value:function(e){return this.send("stopDelegate",[],{},e)}},{key:"lock",value:function(e,t){return this.send("lock",[e],{},t)}}]),a}(J.c),ae=te,ne=[Object(J.b)("isActive",[],["bool"]),Object(J.b)("state",["uint256"],["uint8"]),Object(J.b)("latestProposalIds",["address"],["uint256"]),Object(J.b)("getReceipt",["uint256","address"],[new J.a(["bool","uint256","bool"])]),Object(J.b)("abrogationProposals",["uint256"],["address","uint256","string","uint256","uint256"]),Object(J.b)("getAbrogationProposalReceipt",["uint256","address"],[new J.a(["bool","uint256","bool"])]),Object(J.b)("activate",[],[]),Object(J.b)("propose",["address[]","uint256[]","string[]","bytes[]","string","string"],["uint256"]),Object(J.b)("cancelProposal",["uint256"],[]),Object(J.b)("queue",["uint256"],[]),Object(J.b)("execute",["uint256"],[]),Object(J.b)("castVote",["uint256","bool"],[]),Object(J.b)("cancelVote",["uint256"],[]),Object(J.b)("startAbrogationProposal",["uint256","string"],[]),Object(J.b)("abrogationProposal_castVote",["uint256","bool"],[]),Object(J.b)("abrogationProposal_cancelVote",["uint256"],[])],oe=function(e){Object(H.a)(a,e);var t=Object(K.a)(a);function a(e){var n;return Object(Q.a)(this,a),(n=t.call(this,ne,e,"DAO Governance")).isActive=void 0,n.on(J.c.UPDATE_ACCOUNT,(function(){})),n}return Object(Z.a)(a,[{key:"loadCommonData",value:function(){var e=Object(z.a)($.a.mark((function e(){var t,a,o;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.batch([{method:"isActive"}]);case 2:t=e.sent,a=Object(n.a)(t,1),o=a[0],this.isActive=Boolean(o),this.emit(J.c.UPDATE_DATA);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadUserData",value:function(){var e=Object(z.a)($.a.mark((function e(){return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertAccount(),this.emit(J.c.UPDATE_DATA);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getState",value:function(e){return this.call("state",[e]).then((function(e){return Number(e)}))}},{key:"getLatestProposalIds",value:function(e){return this.call("latestProposalIds",[e]).then((function(e){return Number(e)}))}},{key:"getReceipt",value:function(e,t){return this.call("getReceipt",[e,t]).then((function(e){return{hasVoted:Boolean(e[0]),votes:Number(e[1]),support:Boolean(e[2])}}))}},{key:"getAbrogationProposals",value:function(e){return this.call("abrogationProposals",[e]).then((function(e){return{creator:e[0],createTime:Number(e[1]),description:e[2],forVotes:Number(e[3]),againstVotes:Number(e[4])}}))}},{key:"getAbrogationProposalReceipt",value:function(e,t){return this.call("getAbrogationProposalReceipt",[e,t]).then((function(e){return{hasVoted:Boolean(e[0]),votes:Number(e[1]),support:Boolean(e[2])}}))}},{key:"activate",value:function(e){return this.send("activate",[],{},e)}},{key:"propose",value:function(e,t,a,n,o,r,c){return this.send("propose",[a,n,o,r,t,e],{},c)}},{key:"cancelProposal",value:function(e,t){return this.send("cancelProposal",[e],{},t)}},{key:"queue",value:function(e,t){return this.send("queue",[e],{},t)}},{key:"execute",value:function(e,t){return this.send("execute",[e],{},t)}},{key:"castVote",value:function(e,t,a){return this.send("castVote",[e,t],{},a)}},{key:"cancelVote",value:function(e,t){return this.send("cancelVote",[e],{},t)}},{key:"startAbrogationProposal",value:function(e,t,a){return this.send("startAbrogationProposal",[e,t],{},a)}},{key:"abrogationProposalCastVote",value:function(e,t,a){return this.send("abrogationProposal_castVote",[e,t],{},a)}},{key:"abrogationProposalCancelVote",value:function(e,t){return this.send("abrogationProposal_cancelVote",[e],{},t)}}]),a}(J.c),re=oe,ce=[Object(J.b)("pullFeature",[],["address","uint256","uint256","uint256","uint256"]),Object(J.b)("claim",[],["uint256"])],ie=function(e){Object(H.a)(a,e);var t=Object(K.a)(a);function a(e){var n;return Object(Q.a)(this,a),(n=t.call(this,ce,e,"DAO Reward")).pullFeature=void 0,n.toClaim=void 0,n.on(J.c.UPDATE_ACCOUNT,(function(){n.toClaim=void 0})),n}return Object(Z.a)(a,[{key:"bondRewards",get:function(){if(this.pullFeature){var e=this.pullFeature,t=e.startTs,a=e.endTs,n=e.totalDuration,o=e.totalAmount,r=Date.now()/1e3;return t>r?C.a.ZERO:a<=r?o:o.multipliedBy(r-t).div(n)}}},{key:"loadCommonData",value:function(){var e=Object(z.a)($.a.mark((function e(){var t,a,o;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.batch([{method:"pullFeature"}]);case 2:t=e.sent,a=Object(n.a)(t,1),o=a[0],this.pullFeature={source:o[0],startTs:Number(o[1]),endTs:Number(o[2]),totalDuration:Number(o[3]),totalAmount:new C.a(o[4]).unscaleBy(18)},this.emit(J.c.UPDATE_DATA);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadUserData",value:function(){var e=Object(z.a)($.a.mark((function e(){var t,a,o,r,c;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.account,this.assertAccount(),e.next=4,this.batch([{method:"claim",callArgs:{from:a}}]);case 4:o=e.sent,r=Object(n.a)(o,1),c=r[0],this.toClaim=null===(t=C.a.from(c))||void 0===t?void 0:t.unscaleBy(18),this.emit(J.c.UPDATE_DATA);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"claim",value:function(){var e=Object(z.a)($.a.mark((function e(t){return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.send("claim",[],{},t);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),a}(J.c),se=ie,le={minThreshold:1,isActive:void 0,bondStaked:void 0,activationRate:void 0,thresholdRate:void 0},de=r.a.createContext(Object(D.a)("DAOProvider"));function ue(){return r.a.useContext(de)}var be=function(e){var t,a,o,c=e.children,s=Object(P.b)(),l=Object(q.c)(),d=Object(G.b)(null===(t=s.contracts.dao)||void 0===t?void 0:t.barn,(function(){var e;return new ae(null===(e=s.contracts.dao)||void 0===e?void 0:e.barn)})),u=Object(G.b)(null===(a=s.contracts.dao)||void 0===a?void 0:a.governance,(function(){var e;return new re(null===(e=s.contracts.dao)||void 0===e?void 0:e.governance)})),b=Object(G.b)(null===(o=s.contracts.dao)||void 0===o?void 0:o.reward,(function(){var e;return new se(null===(e=s.contracts.dao)||void 0===e?void 0:e.reward)})),j=Object(Y.b)().projectToken,p=Object(W.a)(le),m=Object(n.a)(p,2),O=m[0],f=m[1];return r.a.useEffect((function(){u.loadCommonData(),b.loadCommonData(),d.loadCommonData()}),[]),r.a.useEffect((function(){var e,t=j.contract;(t.setAccount(l.account),l.account)&&(u.loadUserData(),b.loadUserData(),d.loadUserData(),t.loadAllowance(null===(e=s.contracts.dao)||void 0===e?void 0:e.barn).catch(Error))}),[l.account]),r.a.useEffect((function(){var e,t,a,n=u.isActive,o=d.bondStaked,r=d.votingPower,c=null===(e=s.dao)||void 0===e?void 0:e.activationThreshold;o&&c&&c>0&&(t=o.multipliedBy(100).div(c).toNumber(),t=Math.min(t,100)),r&&null!==o&&void 0!==o&&o.gt(C.a.ZERO)&&(a=r.multipliedBy(100).div(o).toNumber(),a=Math.min(a,100)),f({isActive:n,bondStaked:o,activationRate:t,thresholdRate:a})}),[u.isActive,d.bondStaked,d.votingPower]),Object(h.jsx)(de.Provider,{value:Object(i.a)(Object(i.a)({},O),{},{daoBarn:d,daoReward:b,daoGovernance:u,actions:{activate:function(){return u.activate().then((function(){}))},hasThreshold:function(){if(void 0!==O.thresholdRate)return O.thresholdRate>=O.minThreshold},hasActiveProposal:function(){return l.account?u.getLatestProposalIds(l.account).then((function(e){return e?u.getState(e).then((function(e){return![v.CANCELED,v.EXECUTED,v.FAILED,v.EXPIRED,v.ABROGATED].includes(e)})):Promise.resolve(!1)})):Promise.resolve(!1)}}}),children:c})},je=a(1928),pe=a(72),he=a(1716),me=a.n(he),Oe=a(1715),fe=a.n(Oe),ge=["className"],ve=function(e){var t=e.className,a=Object(s.a)(e,ge);return Object(h.jsx)(me.a,Object(i.a)({className:b()(fe.a.divider,t)},a))},xe=a(1718),we=a.n(xe),ye=a(1717),ke=a.n(ye),Ne=["className","width","height","loading","children"],Ae=function(e){var t=e.className,a=e.width,n=e.height,o=e.loading,r=e.children,c=Object(s.a)(e,Ne);return Object(h.jsx)(we.a,Object(i.a)(Object(i.a)({className:b()(ke.a.skeleton,t),title:{width:a,style:{height:n}},active:!0,loading:!1!==o,paragraph:{rows:0}},c),{},{children:r}))},Ce=a(107),_e=a(410),Se=a(1726),Ve=a(91),Pe=a(119);function De(e){var t,a=Object(o.useRef)(e);a.current=e;var r=Object(o.useState)(!1),c=Object(n.a)(r,2),i=c[0],s=c[1],l=Object(o.useState)(!1),d=Object(n.a)(l,2),u=d[0],b=d[1],j=Object(o.useCallback)((function(){if(a.current.end)return Math.max(a.current.end.valueOf()-Date.now(),0)}),[]),p=Object(Se.a)((function(){var e,t,n,o,r=j();(null===(e=(t=a.current).onTick)||void 0===e||e.call(t,null!==r&&void 0!==r?r:0),0===r)&&(s(!1),O(),null===(n=(o=a.current).onEnd)||void 0===n||n.call(o))}),null!==(t=e.delay)&&void 0!==t?t:1e3,!1),h=Object(n.a)(p,2),m=h[0],O=h[1];return Object(o.useEffect)((function(){var t,n,o;(!e.end||Date.now()<e.end)&&(s(!0),m(),null===(t=(n=a.current).onStart)||void 0===t||t.call(n,null!==(o=j())&&void 0!==o?o:0));return function(){s(!1),O()}}),[e.end]),Object(o.useMemo)((function(){return{isStarted:i,isRunning:u,start:function(){var e,t,n;s(!0),b(!0),m(),null===(e=(t=a.current).onStart)||void 0===e||e.call(t,null!==(n=j())&&void 0!==n?n:0)},stop:function(){var e,t,n;b(!1),s(!1),O(),null===(e=(t=a.current).onStop)||void 0===e||e.call(t,null!==(n=j())&&void 0!==n?n:0)},pause:function(){b(!1),O()},resume:function(){b(!0),m()}}}),[u,O,m])}var Ee,Te=function(e){var t,a=Object(Ve.b)().windowState,r=Object(Pe.a)(),c=Object(n.a)(r,1)[0],s=Object(o.useRef)(),l=De(Object(i.a)(Object(i.a)({},e),{},{onStart:function(t){var a;s.current=t,c(),null===(a=e.onStart)||void 0===a||a.call(e,t)},onStop:function(t){var a;s.current=t,c(),null===(a=e.onStop)||void 0===a||a.call(e,t)},onTick:function(t){var a;s.current=t,c(),null===(a=e.onTick)||void 0===a||a.call(e,t)}})),d=l.isStarted,u=l.isRunning,b=l.pause,j=l.resume;return Object(o.useEffect)((function(){d&&(!u&&a.isVisible&&j(),u&&!a.isVisible&&b())}),[a.isVisible,d,u]),Object(h.jsx)(h.Fragment,{children:e.children(null!==(t=s.current)&&void 0!==t?t:0)})},Fe=a(97),Re=a(65),Ie=a(1727),Be=a.n(Ie),Ue={leftBonus:void 0,leftTotalVotingPower:void 0},Me=function(e){var t,a=ue().daoBarn,o=a.votingPower,c=a.userDelegatedTo,s=a.delegatedPower,l=a.userLockedUntil,d=a.balance,u=Object(W.a)(Ue),b=Object(n.a)(u,2),j=b[0],p=b[1],m=Object(Re.g)(c),O=r.a.useMemo((function(){return(null!==l&&void 0!==l?l:Date.now())-Date.now()}),[l]);return De({end:m?0:null!==l&&void 0!==l?l:0,delay:1e3,onTick:function(e){var t,a,n,r=null===o||void 0===o?void 0:o.minus(null!==s&&void 0!==s?s:C.a.ZERO);m||(r=null===(n=r)||void 0===n?void 0:n.minus(null!==d&&void 0!==d?d:C.a.ZERO));var c=null===(t=r)||void 0===t?void 0:t.multipliedBy(e).div(O),i=null===o||void 0===o?void 0:o.minus(null!==(a=r)&&void 0!==a?a:C.a.ZERO).plus(null!==c&&void 0!==c?c:C.a.ZERO);p({leftBonus:c,leftTotalVotingPower:i})}}),r.a.useEffect((function(){p({leftBonus:m?C.a.ZERO:null===o||void 0===o?void 0:o.minus(null!==d&&void 0!==d?d:C.a.ZERO).minus(null!==s&&void 0!==s?s:C.a.ZERO),leftTotalVotingPower:o})}),[m]),Object(h.jsx)(Fe.a,Object(i.a)(Object(i.a)({className:Be.a.component,title:"Voting power detailed view"},e),{},{children:Object(h.jsxs)("dl",{className:Be.a.list,children:[Object(h.jsxs)("div",{className:Be.a.row,children:[Object(h.jsxs)("dt",{className:Be.a.term,children:[Object(h.jsx)(k.a,{name:"wallet-outlined",width:20,height:20,className:Be.a.termIcon}),"My staked balance"]}),Object(h.jsxs)("dd",{className:Be.a.data,children:[Object(V.b)(d),Object(h.jsx)(k.a,{name:"circle-plus-outlined",width:18,height:18,color:"green",className:Be.a.dataIcon})]})]}),Object(h.jsxs)("div",{className:Be.a.row,children:[Object(h.jsxs)("dt",{className:Be.a.term,children:[Object(h.jsx)(k.a,{name:"wallet-outlined",width:20,height:20,className:Be.a.termIcon}),"Delegated by me"]}),Object(h.jsxs)("dd",{className:Be.a.data,children:[m?Object(V.b)(d):0,Object(h.jsx)(k.a,{name:"circle-minus-outlined",width:18,height:18,color:"red",className:Be.a.dataIcon})]})]}),Object(h.jsxs)("div",{className:Be.a.row,children:[Object(h.jsxs)("dt",{className:Be.a.term,children:[Object(h.jsx)(k.a,{name:"rate-outlined",width:20,height:20,className:Be.a.termIcon}),"Locked balance bonus"]}),Object(h.jsxs)("dd",{className:Be.a.data,children:[null!==(t=j.leftBonus)&&void 0!==t&&t.gt(C.a.ZERO)?"> ":"",Object(V.b)(j.leftBonus),Object(h.jsx)(k.a,{name:"circle-plus-outlined",width:18,height:18,color:"green",className:Be.a.dataIcon})]})]}),Object(h.jsxs)("div",{className:Be.a.row,children:[Object(h.jsxs)("dt",{className:Be.a.term,children:[Object(h.jsx)(k.a,{name:"handshake-outlined",width:20,height:20,className:Be.a.termIcon}),"Delegated to me"]}),Object(h.jsxs)("dd",{className:Be.a.data,children:[Object(V.b)(s),Object(h.jsx)(k.a,{name:"circle-plus-outlined",width:18,height:18,color:"green",className:Be.a.dataIcon})]})]}),Object(h.jsx)("div",{className:Be.a.separator}),Object(h.jsxs)("div",{className:Be.a.row,children:[Object(h.jsxs)("dt",{className:Be.a.term,children:[Object(h.jsx)(k.a,{name:"stamp-outlined",width:20,height:20,className:Be.a.termIcon}),"My total voting power"]}),Object(h.jsx)(N.b,{type:"h3",weight:"bold",tag:"dd",className:Be.a.data,children:Object(V.b)(j.leftTotalVotingPower)})]})]})}))},Le=a(1728),qe=a.n(Le),Ge={claiming:!1,showDetailedView:!1},Ye=function(){var e,t=ue(),a=Object(q.c)(),r=Object(Y.b)().projectToken,c=Object(W.a)(Ge),i=Object(n.a)(c,2),s=i[0],l=i[1],d=t.daoReward.toClaim,u=(null===(e=r.contract.balance)||void 0===e||e.unscaleBy(r.decimals),t.daoBarn),j=u.votingPower,p=u.userLockedUntil,m=u.balance,O=Object(o.useState)(1),f=Object(n.a)(O,2),g=f[0],v=f[1];Object(o.useEffect)((function(){a.account&&t.daoBarn.getMultiplierAtTs(a.account,Object(Re.b)()).then((function(e){return v(e.toNumber())}))}),[a.account]);var x=(null!==p&&void 0!==p?p:Date.now())-Date.now();return Object(h.jsxs)("div",{className:b()(qe.a.component,"pv-24 ph-64 sm-ph-16"),children:[Object(h.jsx)(N.b,{type:"lb2",weight:"semibold",color:"blue",className:"mb-16",children:"My Account status"}),Object(h.jsxs)(y.a,{flow:"col",gap:24,className:qe.a.items,children:[Object(h.jsxs)(y.a,{flow:"row",gap:4,children:[Object(h.jsx)(N.b,{type:"p2",color:"secondary",children:"Current staked"}),Object(h.jsxs)(y.a,{flow:"col",gap:16,align:"center",children:[Object(h.jsx)(Ae,{loading:void 0===m,children:Object(h.jsx)(N.b,{type:"h3",weight:"bold",color:"primary",children:Object(V.b)(m)})}),Object(h.jsx)(_e.a,{name:r.icon})]})]}),Object(h.jsx)(ve,{type:"vertical"}),Object(h.jsxs)(y.a,{flow:"row",gap:4,children:[Object(h.jsx)(N.b,{type:"p2",color:"secondary",children:"Current reward"}),Object(h.jsxs)(y.a,{flow:"col",gap:16,align:"center",children:[Object(h.jsx)(Ce.a,{title:Object(V.b)(null!==d&&void 0!==d?d:0,{decimals:r.decimals}),children:Object(h.jsx)(N.b,{type:"h3",weight:"bold",color:"primary",children:Object(V.b)(null!==d&&void 0!==d?d:0,{hasLess:!0})})}),Object(h.jsx)(_e.a,{name:r.icon}),Object(h.jsx)(pe.a,{type:"light",disabled:null===d||void 0===d?void 0:d.isZero(),onClick:function(){l({claiming:!0}),t.daoReward.claim().catch(Error).then((function(){r.contract.loadBalance().catch(Error),l({claiming:!1})}))},children:s.claiming?Object(h.jsx)(je.a,{spinning:!0}):"Claim"})]})]}),Object(h.jsx)(ve,{type:"vertical"}),Object(h.jsxs)(y.a,{flow:"row",gap:4,children:[Object(h.jsx)(N.b,{type:"p2",color:"secondary",children:"Total voting power"}),Object(h.jsxs)(y.a,{flow:"col",gap:16,align:"center",children:[Object(h.jsx)(Ae,{loading:void 0===j,children:Object(h.jsx)(N.b,{type:"h3",weight:"bold",color:"primary",children:Object(V.b)(j)})}),Object(h.jsx)(pe.a,{type:"light",onClick:function(){return l({showDetailedView:!0})},children:"Detailed view"}),s.showDetailedView&&Object(h.jsx)(Me,{onCancel:function(){return l({showDetailedView:!1})}})]})]}),Object(h.jsx)(Te,{end:null!==p&&void 0!==p?p:0,delay:1e3,onEnd:function(){},children:function(e){var t=e/x*(g-1)+1;return t>1?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(ve,{type:"vertical"}),Object(h.jsxs)(y.a,{flow:"row",gap:4,children:[Object(h.jsx)(N.a,{text:Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(N.b,{type:"p2",children:"The multiplier mechanic allows users to lock $BOND for a period up to 1 year and get a bonus of up to 2x vBOND. The bonus is linear, as per the following example:"}),Object(h.jsxs)("ul",{children:[Object(h.jsx)("li",{children:Object(h.jsx)(N.b,{type:"p2",children:"lock 1000 $BOND for 1 year \u2192 get back 2000 vBOND"})}),Object(h.jsx)("li",{children:Object(h.jsx)(N.b,{type:"p2",children:"lock 1000 $BOND for 6 months \u2192 get back 1500 vBOND"})})]}),Object(h.jsx)(w.d,{href:"https://docs.barnbridge.com/governance/barnbridge-dao/multiplier-and-voting-power",variation:"link",children:"Learn more"})]}),children:Object(h.jsx)(N.b,{type:"p2",color:"secondary",children:"Multiplier & Lock timer"})}),Object(h.jsxs)(y.a,{flow:"col",gap:8,align:"center",children:[Object(h.jsx)(Ce.a,{title:"x".concat(t),children:Object(h.jsxs)(N.b,{type:"lb1",weight:"bold",color:"blue",className:qe.a.ratio,children:[Object(Re.d)(g,1,1.01)?">":""," ",Object(V.a)(t,2,"-",2),"x"]})}),Object(h.jsx)(N.b,{type:"p2",color:"secondary",children:"for"}),Object(h.jsx)(N.b,{type:"h3",weight:"bold",color:"primary",children:Object(Re.a)(0,p)})]})]})]}):void 0}})]})]})},We=a(1730),ze=a.n(We),Qe=a(1729),Ze=a.n(Qe),He=["className","acceptance"],Ke=function(e){var t=e.className,a=e.acceptance,n=Object(s.a)(e,He),o=void 0!==a,r=Number(a)<=Number(e.percent);return Object(h.jsx)(ze.a,Object(i.a)({className:b()(Ze.a.component,o&&Ze.a.acceptance,r&&Ze.a.fulfilled,t),showInfo:!1,success:o?{percent:a,strokeColor:r?String(e.strokeColor):e.trailColor}:void 0},n))},Xe=function(e){var t,a,o=Object(Y.b)().projectToken,c=Object(P.b)(),i=ue(),s=r.a.useState(!1),l=Object(n.a)(s,2),d=l[0],u=l[1];return Object(h.jsx)("div",{className:b()("card p-24",e.className),children:Object(h.jsxs)(y.a,{flow:"row",gap:24,align:"start",children:[Object(h.jsx)(N.a,{text:Object(h.jsxs)(N.b,{type:"p2",children:["For the DAO to be activated, a threshold of ",Object(V.b)(null===(t=c.dao)||void 0===t?void 0:t.activationThreshold)," $",o.symbol," tokens staked has to be met."]}),children:Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:"Activation threshold"})}),Object(h.jsxs)(y.a,{gap:12,colsTemplate:"auto 24px",width:"100%",children:[Object(h.jsx)(Ke,{percent:i.activationRate,trailColor:"var(--theme-border-color)",strokeWidth:24,strokeColor:{"0%":"var(--theme-blue-color)","100%":"var(--theme-green-color)"}}),Object(h.jsx)(k.a,{name:"ribbon-outlined"})]}),Object(h.jsxs)(y.a,{flow:"col",gap:8,children:[Object(h.jsx)(_e.a,{name:o.icon}),Object(h.jsx)(N.b,{type:"p1",weight:"bold",color:"primary",children:Object(V.b)(i.bondStaked)}),Object(h.jsxs)(N.b,{type:"p1",weight:"semibold",color:"secondary",children:["/ ",Object(V.b)(null===(a=c.dao)||void 0===a?void 0:a.activationThreshold)," already staked."]})]}),100===i.activationRate&&!i.isActive&&Object(h.jsx)(pe.a,{type:"primary",loading:d,onClick:function(){u(!0),i.actions.activate().catch(Error).then((function(){u(!1)}))},children:"Activate"})]})})},$e=a(1736),Je=a.n($e),et=a(1735),tt=a.n(et),at=["className","pagination"],nt=function(e){var t=e.className,a=e.pagination,n=Object(s.a)(e,at);return Object(h.jsx)(Je.a,Object(i.a)({className:b()(tt.a.component,t),bordered:!1,showSorterTooltip:!1,pagination:!!a&&Object(i.a)({showSizeChanger:!1},a)},n))},ot=a(245),rt=[{title:"Address",dataIndex:"address",render:function(e){return Object(h.jsxs)("div",{className:"flex col-gap-16 align-center",children:[Object(h.jsx)(ot.a,{address:e,width:32,height:32}),Object(h.jsxs)(w.b,{address:e,variation:"link",children:[Object(h.jsx)(N.b,{type:"p1",weight:"semibold",ellipsis:!0,className:"hidden-mobile hidden-tablet",children:e}),Object(h.jsx)(N.b,{type:"p1",weight:"semibold",wrap:!1,className:"hidden-desktop",children:Object(V.f)(e)})]})]})}},{title:"Staked Balance",dataIndex:"bondStaked",width:200,align:"right",render:function(e){return Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",className:"ml-auto",children:Object(V.a)(e,2,"-",2)})}},{title:"Voting Power",dataIndex:"votingPower",width:200,align:"right",render:function(e){return Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",className:"ml-auto",children:Object(V.a)(e,2,"-",2)})}},{title:"Votes",dataIndex:"votes",width:150,align:"right",render:function(e){return Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",className:"ml-auto",children:e})}},{title:"Proposals",dataIndex:"proposals",width:150,align:"right",render:function(e){return Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",className:"ml-auto",children:e})}}],ct=function(e){var t=e.className,a=M(),o=r.a.useState(!1),c=Object(n.a)(o,2),i=c[0],s=c[1],l=r.a.useState([]),d=Object(n.a)(l,2),u=d[0],j=d[1],p=r.a.useState(0),m=Object(n.a)(p,2),O=m[0],f=m[1],g=r.a.useState(1),v=Object(n.a)(g,2),x=v[0],w=v[1];return r.a.useEffect((function(){s(!0),a.fetchVoters(x,10).then((function(e){j(e.data),f(e.meta.count),s(!1)})).catch((function(){s(!1)}))}),[x,10]),Object(h.jsxs)("div",{className:b()("card",t),children:[Object(h.jsx)("div",{className:"card-header",children:Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:"Voter weights"})}),Object(h.jsx)(nt,{columns:rt,dataSource:u,rowKey:"address",loading:i,pagination:{total:O,pageSize:10,current:x,position:["bottomRight"],showTotal:function(e,t){var a=Object(n.a)(t,2),o=a[0],r=a[1];return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)(N.b,{type:"p2",weight:"semibold",color:"secondary",className:"hidden-mobile",children:["Showing ",o," to ",r," out of ",e," stakers"]}),Object(h.jsxs)(N.b,{type:"p2",weight:"semibold",color:"secondary",className:"hidden-tablet hidden-desktop",children:[o,"..",r," of ",e]})]})},onChange:w},scroll:{x:!0}})]})},it=a(32),st=a(1812),lt=a.n(st),dt=function(e){var t,a,o,c,i,s=e.className,l=M(),d=ue(),u=Object(Y.b)(),j=u.projectToken,p=u.convertTokenInUSD,m=r.a.useState(),O=Object(n.a)(m,2),f=O[0],g=O[1];return r.a.useEffect((function(){l.fetchOverviewData().then(g)}),[]),Object(h.jsxs)("div",{className:b()(lt.a.cards,s),children:[Object(h.jsx)("div",{className:"card p-24",children:Object(h.jsxs)(y.a,{flow:"row",gap:48,children:[Object(h.jsx)(N.a,{text:Object(h.jsx)(N.b,{type:"p2",children:"This number shows the amount of $BOND (and their USD value) currently staked in the DAO."}),children:Object(h.jsx)(N.b,{type:"lb2",weight:"semibold",color:"blue",children:"Total Staked"})}),Object(h.jsxs)(y.a,{flow:"row",gap:4,children:[Object(h.jsxs)(y.a,{flow:"col",gap:4,align:"end",children:[Object(h.jsx)(N.b,{type:"h2",weight:"bold",color:"primary",children:Object(V.b)(d.daoBarn.bondStaked)}),Object(h.jsx)(N.b,{type:"p1",color:"secondary",children:j.symbol}),Object(h.jsx)(Ce.a,{title:Object(h.jsxs)(h.Fragment,{children:["The BarnBridge Governance contracts are covered by: ",Object(h.jsx)("br",{}),"- Bridge Mutual,"," ",Object(h.jsx)("a",{href:"https://app.bridgemutual.io/user/cover/0xdb9A242cfD588507106919051818e771778202e9",rel:"noopener noreferrer",target:"_blank",children:"click here"})," ","to purchase coverage"]}),children:Object(h.jsx)(it.a,{name:"insured",color:"green",size:32})})]}),Object(h.jsx)(N.b,{type:"p1",color:"secondary",children:Object(V.c)(p(d.daoBarn.bondStaked,j.symbol))})]})]})}),Object(h.jsx)("div",{className:"card p-24",children:Object(h.jsxs)(y.a,{flow:"row",gap:48,children:[Object(h.jsx)(N.a,{text:Object(h.jsxs)(y.a,{flow:"row",gap:8,align:"start",children:[Object(h.jsx)(N.b,{type:"p2",children:"This number shows the amount of vBOND currently minted. This number may differ from the amount of $BOND staked because of the multiplier mechanic"}),Object(h.jsx)(w.d,{href:"https://integrations.barnbridge.com/specs/dao-specifications#multiplier-and-voting-power",className:"link-blue",style:{fontWeight:600},children:"Learn more"})]}),children:Object(h.jsx)(N.b,{type:"lb2",weight:"semibold",color:"blue",children:"VSWINGBY"})}),Object(h.jsx)(y.a,{flow:"row",gap:4,children:Object(h.jsx)(N.b,{type:"h2",weight:"bold",color:"primary",children:Object(V.b)(null===f||void 0===f?void 0:f.totalVbond)})})]})}),Object(h.jsx)("div",{className:"card p-24",children:Object(h.jsxs)(y.a,{flow:"row",gap:48,children:[Object(h.jsx)(N.a,{text:Object(h.jsxs)(y.a,{flow:"row",gap:8,align:"start",children:[Object(h.jsx)(N.b,{type:"p2",children:"This counter shows the average amount of time $BOND stakers locked their deposits in order to take advantage of the voting power bonus."}),Object(h.jsx)(w.d,{href:"https://integrations.barnbridge.com/specs/dao-specifications#users-can-lock-bond-for-vbond",className:"link-blue",style:{fontWeight:600},children:"Learn more"})]}),children:Object(h.jsx)(N.b,{type:"lb2",weight:"semibold",color:"blue",children:"Avg. Lock Time"})}),Object(h.jsxs)(y.a,{flow:"row",gap:4,children:[Object(h.jsx)(N.b,{type:"h2",weight:"bold",color:"primary",children:null!==f&&void 0!==f&&f.avgLockTimeSeconds?Object(Re.a)(null===f||void 0===f?void 0:f.avgLockTimeSeconds):"-"}),Object(h.jsx)(N.b,{type:"p1",color:"secondary",children:"average time"})]})]})}),Object(h.jsx)("div",{className:"card p-24",children:Object(h.jsxs)(y.a,{flow:"row",gap:48,children:[Object(h.jsx)(N.a,{text:Object(h.jsxs)(N.b,{type:"p2",children:["This number shows the $BOND token rewards distributed so far out of the total of"," ",Object(V.b)(null===(t=d.daoReward.pullFeature)||void 0===t?void 0:t.totalAmount)," that are going to be available for the DAO Staking."]}),children:Object(h.jsx)(N.b,{type:"lb2",weight:"semibold",color:"blue",children:"Staking rewards"})}),Object(h.jsxs)(y.a,{flow:"row",gap:4,children:[Object(h.jsx)(Te,{end:1e3*(null!==(a=null===(o=d.daoReward.pullFeature)||void 0===o?void 0:o.endTs)&&void 0!==a?a:0),delay:5e3,children:function(){return Object(h.jsx)(N.b,{type:"h2",weight:"bold",color:"primary",children:Object(V.b)(d.daoReward.bondRewards)})}}),Object(h.jsxs)(N.b,{type:"p1",color:"secondary",children:["out of ",Object(V.b)(null===(c=d.daoReward.pullFeature)||void 0===c?void 0:c.totalAmount)]})]})]})}),Object(h.jsx)("div",{className:"card p-24",children:Object(h.jsxs)(y.a,{flow:"row",gap:48,children:[Object(h.jsx)(N.a,{text:Object(h.jsxs)(y.a,{flow:"row",gap:8,align:"start",children:[Object(h.jsx)(N.b,{type:"p2",children:"This number shows the amount of vBOND that is delegated to other addresses."}),Object(h.jsx)(w.d,{href:"https://integrations.barnbridge.com/specs/dao-specifications#users-can-delegate-vbond-to-other-users",className:"link-blue",style:{fontWeight:600},children:"Learn more"})]}),children:Object(h.jsx)(N.b,{type:"lb2",weight:"semibold",color:"blue",children:"Delegated"})}),Object(h.jsxs)(y.a,{flow:"row",gap:4,children:[Object(h.jsx)(N.b,{type:"h2",weight:"bold",color:"primary",children:Object(V.b)(null===f||void 0===f?void 0:f.totalDelegatedPower)}),Object(h.jsxs)(N.b,{type:"p1",color:"secondary",children:["out of"," ",Object(V.b)(null===(i=j.contract.totalSupply)||void 0===i?void 0:i.unscaleBy(j.decimals))]})]})]})}),Object(h.jsx)("div",{className:"card p-24",children:Object(h.jsxs)(y.a,{flow:"row",gap:48,children:[Object(h.jsx)(N.a,{text:Object(h.jsx)(N.b,{type:"p2",children:"This card shows the number of holders of $BOND and compares it to the number of stakers and voters in the DAO."}),children:Object(h.jsx)(N.b,{type:"lb2",weight:"semibold",color:"blue",children:"Addresses"})}),Object(h.jsxs)(y.a,{flow:"row",gap:4,children:[Object(h.jsxs)(y.a,{flow:"col",gap:4,align:"end",children:[Object(h.jsx)(N.b,{type:"h2",weight:"bold",color:"primary",children:null===f||void 0===f?void 0:f.holdersStakingExcluded}),Object(h.jsx)(N.b,{type:"p1",color:"secondary",children:"holders"})]}),Object(h.jsxs)(N.b,{type:"p1",color:"secondary",children:[null===f||void 0===f?void 0:f.barnUsers," stakers & ",null===f||void 0===f?void 0:f.voters," voters"]})]})]})})]})},ut=function(){var e=ue();return Object(h.jsxs)(h.Fragment,{children:[!1===e.isActive&&Object(h.jsx)(Xe,{className:"full-width mb-32"}),Object(h.jsx)(dt,{className:"mb-32"}),Object(h.jsx)(ct,{})]})},bt=a(13),jt=a(59),pt=a(1813),ht=a.n(pt),mt=["className","children"],Ot=["id","className","onClick"],ft=function(e){var t=e.className,a=e.tabs,n=e.shadows,o=void 0!==n&&n;return Object(h.jsx)("div",{className:b()(ht.a.tabs,t,Object(bt.a)({},ht.a.shadows,o)),style:{"--tabs-bg":"var(".concat("string"===typeof o?o:"--theme-body-color",")")},children:a.map((function(e,t){var a=e.className,n=e.children,o=Object(s.a)(e,mt);return o.to?Object(h.jsx)(jt.c,Object(i.a)(Object(i.a)({className:b()(ht.a.tab,a),activeClassName:ht.a.active},o),{},{children:n}),t):Object(h.jsx)("a",Object(i.a)(Object(i.a)({className:b()(ht.a.tab,a),rel:"noopener noreferrer",target:"_blank"},o),{},{children:n}),t)}))})},gt=function(e){var t,a=e.variation,n=void 0===a?"normal":a,o=e.tabs,r=e.activeKey,c=e.size,l=e.className,d=e.style;return Object(h.jsx)("div",{className:b()(l,(t={},Object(bt.a)(t,ht.a.tabs,"normal"===n),Object(bt.a)(t,ht.a.elasticTabs,"elastic"===n),t)),style:d,children:o.map((function(t){var a,n=t.id,o=t.className,l=t.onClick,d=Object(s.a)(t,Ot);return Object(h.jsx)("button",Object(i.a)({className:b()(ht.a.tab,o,(a={},Object(bt.a)(a,ht.a.active,n===r),Object(bt.a)(a,ht.a.small,"small"===c),a)),type:"button",onClick:function(){var t;null===(t=e.onClick)||void 0===t||t.call(e,n),null===l||void 0===l||l(n)}},d),n)}))})};!function(e){e.day="24h",e.week="1w",e.month="30d"}(Ee||(Ee={}));var vt;Ee.day,Ee.week,Ee.month;!function(e){e.week="1w",e.month="30d"}(vt||(vt={}));vt.week,vt.month;var xt=a(1932),wt=a(1375),yt=a.n(wt),kt=a(1814),Nt=a.n(kt),At=["children"],Ct=["className","label","hint","extra","children"],_t=["className","children"],St=function(e){var t=e.className,a=e.children,n=Object(s.a)(e,_t);return Object(h.jsx)(yt.a,Object(i.a)(Object(i.a)({className:b()(Nt.a.form,t),layout:"vertical",requiredMark:!1},n),{},{children:a}))};St.Item=function(e){var t=e.className,a=e.label,n=e.hint,o=e.extra,r=e.children,c=Object(s.a)(e,Ct);return Object(h.jsx)(yt.a.Item,Object(i.a)(Object(i.a)({className:b()(Nt.a.item,t)},c),{},{label:Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)(y.a,{flow:"col",gap:4,align:"center",children:[a,n&&Object(h.jsx)(Ce.a,{title:n,children:Object(h.jsx)("span",{children:Object(h.jsx)(it.a,{name:"info",size:15})})})]}),o]}),children:r}))},St.List=function(e){var t=e.children,a=Object(s.a)(e,At);return Object(h.jsx)(yt.a.List,Object(i.a)(Object(i.a)({},a),{},{children:t}))};var Vt=St,Pt=a(1366),Dt=a.n(Pt),Et=a(247),Tt=a.n(Et),Ft=a(1828),Rt=a.n(Ft),It=["label","hint","className"],Bt=function(e){var t=e.label,a=e.hint,n=e.className,o=Object(s.a)(e,It);return Object(h.jsx)(Dt.a,Object(i.a)(Object(i.a)({className:b()(Rt.a.component,n)},o),{},{children:Object(h.jsxs)(y.a,{flow:"row",gap:4,children:[t,a]})}))},Ut=a(50),Mt=a(1829),Lt=a.n(Mt),qt=["className","value","onChange"],Gt=function(e){var t=e.className,a=e.value,o=(e.onChange,Object(s.a)(e,qt)),c=Object(Ut.b)().activeNetwork,l=Object(W.a)({options:[],loading:!1,selected:void 0}),d=Object(n.a)(l,2),u=d[0],b=d[1];return r.a.useEffect((function(){b({loading:!0});var e="".concat(c.explorer.apiUrl,"/api?module=gastracker&action=gasoracle&apikey=").concat(c.explorer.key);fetch(e).then((function(e){return e.json()})).then((function(e){return e.result})).then((function(e){return{veryFast:Number(e.FastGasPrice),fast:Number(e.ProposeGasPrice),average:Math.round((Number(e.ProposeGasPrice)+Number(e.SafeGasPrice))/2),safeLow:Number(e.SafeGasPrice)}})).then((function(e){var t=[{key:"fastest",name:"Very fast",value:e.veryFast},{key:"fast",name:"Fast",value:e.fast},{key:"average",name:"Standard",value:e.average},{key:"safeLow",name:"Slow",value:e.safeLow}];b({loading:!1,options:t})})).catch((function(){b({loading:!1})}))}),[]),r.a.useEffect((function(){var t;void 0===a&&u.options.length>2&&(null===(t=e.onChange)||void 0===t||t.call(e,u.options[2]))}),[a,u.options]),r.a.useEffect((function(){b({selected:a})}),[a]),Object(h.jsx)(Dt.a.Group,Object(i.a)(Object(i.a)({className:t,style:{width:"100%"}},o),{},{value:u.selected,onChange:function(t){var a;null===(a=e.onChange)||void 0===a||a.call(e,t.target.value)},children:u.loading?Object(h.jsx)(Tt.a,{}):Object(h.jsx)("div",{className:Lt.a.list,children:u.options.map((function(e){return Object(h.jsx)(Bt,{label:Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:e.name}),hint:Object(h.jsxs)(y.a,{flow:"col",gap:4,children:[Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:e.value}),Object(h.jsx)(N.b,{type:"p2",weight:"semibold",color:"secondary",children:"Gwei"})]}),value:e},e.key)}))})}))};var Yt=a(1830),Wt=a.n(Yt),zt=["header","submitText","children","onConfirm"],Qt=function(e){var t=e.header,a=e.submitText,c=e.children,l=e.onConfirm,d=Object(s.a)(e,zt),u=Object(Ut.b)().activeNetwork,b=xt.a.useForm(),j=Object(n.a)(b,1)[0],p=r.a.useState(!1),m=Object(n.a)(p,2),O=m[0],f=m[1],g=function(){var e=Object(o.useRef)(!1);return Object(o.useEffect)((function(){return function(){e.current=!0}}),[]),e}();function v(){return(v=Object(z.a)($.a.mark((function t(a){var n,o;return $.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=a.gasPrice,f(!0),t.prev=2,t.next=5,l(Object(i.a)(Object(i.a)({},a),{},{gasPrice:null===n||void 0===n?void 0:n.value}));case 5:null===(o=e.onCancel)||void 0===o||o.call(e),t.next=10;break;case 8:t.prev=8,t.t0=t.catch(2);case 10:g.current||f(!1);case 11:case"end":return t.stop()}}),t,null,[[2,8]])})))).apply(this,arguments)}return Object(h.jsx)(Fe.a,Object(i.a)(Object(i.a)({width:560},d),{},{children:Object(h.jsxs)(Vt,{form:j,validateTrigger:["onSubmit"],onFinish:function(e){return v.apply(this,arguments)},children:[t&&Object(h.jsxs)(h.Fragment,{children:[t,Object(h.jsx)(ve,{className:Wt.a.divider})]}),Object(h.jsxs)(y.a,{flow:"row",gap:32,children:[null===c||void 0===c?void 0:c({form:j,submitting:O}),u.config.features.gasFees&&Object(h.jsx)(Vt.Item,{name:"gasPrice",label:"Gas Fee (Gwei)",rules:[{required:!0,message:"Required"}],children:Object(h.jsx)(Gt,{disabled:O})}),Object(h.jsx)(pe.a,{htmlType:"submit",type:"primary",loading:O,children:a})]})]})}))},Zt=a(1558),Ht=a.n(Zt),Kt=a(1831),Xt=a.n(Kt),$t=["className","type"],Jt=function(e){var t=e.className,a=e.type,n=void 0===a?"info":a,o=Object(s.a)(e,$t),c=r.a.useMemo((function(){if("info"===n)return Object(h.jsx)(it.a,{name:"info"})}),[n]);return Object(h.jsx)(Ht.a,Object(i.a)({className:b()(Xt.a.component,t),type:n,showIcon:!0,icon:c},o))},ea=a(1834),ta=a(1835),aa=a(1836),na=a.n(aa),oa=function(e){var t=e.condition,a=e.wrapper,n=e.children;return t?a(n):n},ra=Object(o.createContext)(Object(D.a)("Form"));function ca(e){return{values:e,errors:{}}}function ia(e,t){return sa.apply(this,arguments)}function sa(){return(sa=Object(z.a)($.a.mark((function e(t,a){var n,o;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ta.validate)(null===a||void 0===a?void 0:a.scheme,t);case 2:return n=e.sent,o=n.getErrors(),e.abrupt("return",{values:t,errors:Object.keys(o).reduce((function(e,t){var a=Object.keys(o[t])[0];return a&&(e[t]={type:a,message:o[t][a]}),e}),{})});case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function la(e){var t=e.validationScheme,a=e.defaultValues,n=e.onSubmit,o=t?ia:ca,r=Object(ea.b)({mode:"all",resolver:o,context:{scheme:t},defaultValues:a,shouldUnregister:!0}),c=r.handleSubmit(n);return Object.assign(r,{updateValue:function(e,t){r.setValue(e,t,{shouldDirty:!0,shouldValidate:!0})},submit:c})}function da(e){var t=e.children,a=e.className,n=e.form,r=e.disabled,c=void 0!==r&&r,i=Object(o.useCallback)((function(e){e.preventDefault(),n.submit()}),[n.submit]),s={form:n};return Object(h.jsx)(ra.Provider,{value:s,children:Object(h.jsx)("form",{className:b()(na.a.form,a,c&&na.a.disabled),onSubmit:i,children:t})})}function ua(e){var t=e.children,a=e.className,n=e.label,o=e.hint,r=e.extra;return Object(h.jsxs)("div",{className:b()("flex flow-row row-gap-8",a),children:[Object(h.jsxs)("div",{className:"flex flow-col col-gap-4 justify-space-between",children:[Object(h.jsx)("div",{className:"flex flow-col col-gap-4 align-center",children:Object(h.jsx)(N.a,{text:o,children:"string"===typeof n?Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"secondary",children:n}):n})}),r]}),t]})}function ba(e){var t,a=e.children,n=e.name,r=Object(o.useContext)(ra).form.formState.errors[n];return r?Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"red",children:null!==(t=r.message)&&void 0!==t?t:a}):null}function ja(e){var t=e.children,a=e.name,n=e.label,r=e.labelProps,c=void 0===r?{}:r,s=e.showError,l=void 0===s||s,d=e.className,u=Object(o.useContext)(ra).form;return Object(h.jsxs)(oa,{condition:!!n,wrapper:function(e){return Object(h.jsx)(ua,Object(i.a)(Object(i.a)({label:n,className:d},c),{},{children:e}))},children:[Object(h.jsx)(ea.a,{name:a,control:u.control,render:t,shouldUnregister:!0}),l&&Object(h.jsx)(ba,{name:a})]})}var pa=a(1837),ha=a.n(pa),ma=["className","children","spinning"],Oa=function(e){var t=e.className,a=e.children,n=e.spinning,o=Object(s.a)(e,ma);return a?n?Object(h.jsxs)("div",{className:ha.a.container,children:[Object(h.jsx)("div",{className:ha.a.children,children:a}),Object(h.jsx)(it.a,Object(i.a)({name:"loader",className:b()(ha.a.spinner,t)},o))]}):Object(h.jsx)(h.Fragment,{children:a}):Object(h.jsx)(it.a,Object(i.a)({name:"loader",className:b()(ha.a.spinner,t)},o))},fa=a(1838),ga=a.n(fa),va=function(e){var t=e.text,a=e.color,n=e.className,o=e.style;return Object(h.jsx)("div",{className:b()(ga.a.statusTag,n,ga.a[a]),style:o,children:Object(h.jsx)(N.b,{type:"lb2",tag:"label",weight:"bold",children:t})})},xa=a(60),wa=a(1559),ya=a.n(wa),ka=a(1839),Na=a.n(ka),Aa=["className","disabled"],Ca=function(e){var t=e.className,a=e.disabled,n=Object(s.a)(e,Aa);return Object(h.jsx)(ya.a,Object(i.a)({className:b()(Na.a.component,t,a&&Na.a.disabled),disabled:a,autoComplete:"off"},n))},_a=a(1849),Sa=a.n(_a),Va=["className","value"],Pa=Object(o.forwardRef)((function(e){var t=e.className,a=e.value,n=Object(s.a)(e,Va),o=r.a.useMemo((function(){return Object(xa.isAddress)(String(a))?Object(h.jsx)(ot.a,{address:String(a),width:24,height:24}):Object(h.jsx)("div",{})}),[a]);return Object(h.jsx)(Ca,Object(i.a)({className:b()(Sa.a.component,t),size:"large",addonBefore:o,value:a},n))})),Da=a(1850),Ea=a.n(Da),Ta=["children","selected"],Fa=function(e){var t=e.children,a=e.selected,n=void 0!==a&&a,o=Object(s.a)(e,Ta);return Object(h.jsx)("button",Object(i.a)(Object(i.a)({type:"button",className:b()(Ea.a.card,Object(bt.a)({},Ea.a.selected,n))},o),{},{children:t}))},Ra="manual",Ia="delegated",Ba=function(){var e,t,a=Object(Y.b)().projectToken,r=Object(q.c)(),c=ue(),s=Object(o.useState)(!1),l=Object(n.a)(s,2),d=l[0],u=l[1],b=Object(o.useState)(!1),j=Object(n.a)(b,2),p=j[0],m=j[1],O=Object(o.useState)(!1),f=Object(n.a)(O,2),g=f[0],v=f[1],x=c.daoBarn,y=x.balance,k=void 0===y?C.a.ZERO:y,A=x.userLockedUntil,_=void 0===A?0:A,S=x.userDelegatedTo,P=null===(e=a.contract.balance)||void 0===e?void 0:e.unscaleBy(a.decimals),D=_>Date.now(),E=Object(Re.g)(S),T=la({validationScheme:{delegateAddress:{rules:{required:function(e,t,a){return a.votingType!==Ia||Boolean(e)},isAddress:function(e,t,a){return a.votingType!==Ia||Object(Re.g)(e)},isSelf:function(e,t,a){var n;return a.votingType!==Ia||(null===(n=r.account)||void 0===n?void 0:n.toLowerCase())!==(null===e||void 0===e?void 0:e.toLowerCase())},isSame:function(e,t,a){return a.votingType!==Ia||(null===S||void 0===S?void 0:S.toLowerCase())!==(null===e||void 0===e?void 0:e.toLowerCase())}},messages:{required:"Required",isAddress:"Invalid address",isSelf:"Can't delegate to self",isSame:"Your voting power is already delegated to this address"}}},onSubmit:function(){v(!0)}});function F(){return R.apply(this,arguments)}function R(){return(R=Object(z.a)($.a.mark((function e(){var t,a,n;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),e.prev=1,e.next=4,c.daoBarn.loadUserData();case 4:t=c.daoBarn.userDelegatedTo,a=void 0===t?"":t,n=Object(Re.g)(a),T.reset({votingType:n?Ia:Ra,delegateAddress:n?a:""}),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(1);case 11:u(!1);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})))).apply(this,arguments)}Object(o.useEffect)((function(){F().catch(Error)}),[]);var I=T.formState,B=(0,T.watch)(["votingType","delegateAddress"]),U=Object(n.a)(B,2),M=U[0],L=U[1],G=I.isDirty&&!p&&k.gt(C.a.ZERO);function W(e,t,a){return Q.apply(this,arguments)}function Q(){return(Q=Object(z.a)($.a.mark((function e(t,a,n){return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(m(!0),e.prev=1,t!==Ra){e.next=7;break}return e.next=5,c.daoBarn.stopDelegate(n);case 5:e.next=10;break;case 7:if(t!==Ia){e.next=10;break}return e.next=10,c.daoBarn.delegate(a,n);case 10:return e.next=12,F();case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),console.error(e.t0);case 17:m(!1);case 18:case"end":return e.stop()}}),e,null,[[1,14]])})))).apply(this,arguments)}function Z(){return(Z=Object(z.a)($.a.mark((function e(t){return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v(!1),e.next=3,W(M,L,t);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return d?Object(h.jsx)("div",{className:"flex justify-center p-24",style:{minHeight:"732px"},children:Object(h.jsx)(Oa,{})}):Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)(da,{form:T,className:"flex flow-row row-gap-32 p-24",disabled:p,children:[Object(h.jsxs)("div",{className:"container-box flex flow-col col-gap-44",children:[Object(h.jsxs)("div",{className:"flex flow-row row-gap-4",children:[Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"secondary",children:"Current voting type"}),Object(h.jsx)("div",{className:"flex flow-col col-gap-8 align-center",children:Object(h.jsx)(N.b,{type:"p1",weight:"bold",color:"primary",children:E?"Delegate voting":"Manual voting"})})]}),E&&Object(h.jsxs)("div",{className:"flex flow-row row-gap-4",children:[Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"secondary",children:"Delegated address"}),Object(h.jsx)("div",{className:"flex flow-col col-gap-8 align-center",children:Object(h.jsx)(w.b,{address:S,children:Object(h.jsx)(N.b,{type:"p1",weight:"bold",color:"primary",children:Object(V.f)(S)})})})]})]}),Object(h.jsx)(ja,{name:"votingType",label:"Voting type",children:function(e){var t=e.field;return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(Fa,{selected:t.value===Ra,onClick:function(){return T.updateValue("votingType",Ra)},children:Object(h.jsxs)("div",{className:"flex flow-col col-gap-40 align-center",children:[Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:"Manual voting"}),t.value===Ra&&Object(h.jsx)(va,{text:"ACTIVE",color:"green"})]})}),Object(h.jsx)(Fa,{selected:t.value===Ia,onClick:function(){return T.updateValue("votingType",Ia)},children:Object(h.jsxs)("div",{className:"flex flow-col col-gap-40 align-center",children:[Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:"Delegate voting"}),t.value===Ia&&Object(h.jsx)(va,{text:"ACTIVE",color:"green"})]})})]})}}),M===Ia&&Object(h.jsx)(ja,{name:"delegateAddress",label:"Address",children:function(e){var t=e.field;return Object(h.jsx)(Pa,Object(i.a)({},t))}}),Object(h.jsx)(Jt,{message:"Delegating your voting power to this address means that they will be able to vote in your place. You can\u2019t delegate the voting bonus, only the staked balance."}),D&&Object(h.jsx)(Jt,{message:"Switching back to manual voting while a lock is active will put the amount back under lock. Delegation does not stop the lock timer."}),Object(h.jsx)("div",{className:"flex flow-col col-gap-12 align-center justify-end",children:Object(h.jsxs)("button",{type:"submit",className:"button-primary",disabled:!G,children:[p&&Object(h.jsx)(Oa,{className:"mr-4"}),M===Ia?"Delegate":"Stop Delegate"]})})]}),g&&Object(h.jsx)(Qt,{title:M===Ia?"Delegate your voting power":"Stop delegating voting power",header:M===Ia?Object(h.jsxs)("div",{className:"container-box flex flow-col col-gap-40",children:[Object(h.jsxs)("div",{className:"flow flow-row row-gap-4",children:[Object(h.jsxs)(N.b,{type:"small",weight:"semibold",color:"secondary",children:["Delegate ",a.symbol," amount"]}),Object(h.jsxs)("div",{className:"flex flow-col col-gap-8 align-center",children:[Object(h.jsx)(N.b,{type:"p1",weight:"bold",color:"primary",children:null!==(t=Object(V.b)(P))&&void 0!==t?t:"-"}),Object(h.jsx)(_e.a,{name:a.icon})]})]}),Object(h.jsxs)("div",{className:"flow flow-row row-gap-4",children:[Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"secondary",children:"Delegate address"}),Object(h.jsxs)("div",{className:"flex flow-col col-gap-8 align-center",children:[Object(h.jsx)(ot.a,{address:L}),Object(h.jsx)(N.b,{type:"p1",weight:"bold",color:"primary",children:Object(V.f)(L)})]})]})]}):null,submitText:M===Ia?"Delegate voting power":"Stop delegate",onCancel:function(){v(!1)},onConfirm:function(e){return function(e){return Z.apply(this,arguments)}(e.gasPrice)}})]})},Ua=a(15),Ma=(a(49),a(1931),a(1851),a(1852),a(1854)),La=a.n(Ma),qa=["className","value"],Ga=function(e){var t=e.className,a=e.value,n=Object(s.a)(e,qa),o=Number(n.max)||0,r=Math.floor(1e6*o)/1e6,c=Math.floor(1e6*Number(a))/1e6/r*100||0,l=0===r;return Object(h.jsx)("input",Object(i.a)(Object(i.a)({},n),{},{type:"range",className:b()(La.a.input,t),style:{"--track-fill":"".concat(l?0:c,"%")},max:l?1:r,disabled:l,value:l?"0":a||"0"}))},Ya=a(1855),Wa=a.n(Ya),za=["onChange","before","secondary","className","classNameBefore","slider","errors","decimals","max"],Qa=Object(o.forwardRef)((function(e,t){var a,n,o=e.onChange,r=e.before,c=e.secondary,l=e.className,d=e.classNameBefore,u=e.slider,j=e.errors,p=void 0===j?[]:j,m=e.decimals,O=void 0===m?6:m,f=e.max,g=Object(s.a)(e,za),v=null!==(a=C.a.from(f))&&void 0!==a?a:C.a.ZERO;return Object(h.jsxs)("div",{className:l,children:[Object(h.jsxs)("div",{className:b()(Wa.a.tokenAmount,Object(bt.a)({},Wa.a.error,p.length)),children:[r&&Object(h.jsx)("div",{className:b()(Wa.a.tokenAmountBefore,d),children:r}),Object(h.jsxs)("div",{className:Wa.a.tokenAmountValues,children:[Object(h.jsx)("input",Object(i.a)({ref:t,className:Wa.a.tokenAmountValue,type:"text",inputMode:"decimal",pattern:"[0-9]+([\\.,][0-9]+)?",onWheel:function(e){e.currentTarget.blur()},onChange:function(e){o(e.target.value)}},g)),Object(h.jsx)("div",{className:Wa.a.tokenAmountHint,children:c})]}),!v.isZero()&&Object(h.jsx)("button",{type:"button",className:"button-ghost",style:{alignSelf:"center"},disabled:g.disabled||v.isZero(),onClick:function(){return o(v.toString())},children:"MAX"})]}),!!p.length&&p.map((function(e,t){return Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"red",style:{marginTop:"8px"},children:e},t)})),u&&!v.isZero()?Object(h.jsx)(Ga,{type:"range",className:Wa.a.tokenAmountSlider,min:"0",max:v.toString(),step:1/Math.pow(10,Math.min(O,6)),value:null!==(n=g.value)&&void 0!==n?n:0,disabled:g.disabled||v.isZero(),onChange:function(e){o(e.target.value)}}):null]})})),Za=["deposit","lockDuration"],Ha=function(e){var t=e.deposit,a=e.lockDuration,n=Object(s.a)(e,Za),o=Object(Y.b)().projectToken;return Object(h.jsx)(Fe.a,Object(i.a)(Object(i.a)({width:560},n),{},{children:Object(h.jsxs)(y.a,{flow:"row",gap:32,children:[Object(h.jsxs)(y.a,{flow:"row",gap:16,children:[Object(h.jsx)(k.a,{name:"warning-outlined",width:40,height:40,color:"red"}),Object(h.jsxs)(y.a,{flow:"row",gap:8,children:[Object(h.jsx)(N.b,{type:"h3",weight:"semibold",color:"primary",children:"Are you sure you want to deposit?"}),Object(h.jsxs)(N.b,{type:"p2",weight:"semibold",color:"secondary",children:["You are about to deposit ",Object(V.b)(t)," $",o.symbol,".",Object(h.jsx)("br",{}),"You have an active lock for ",Object(Re.a)(0,a),"."]}),Object(h.jsx)(N.b,{type:"p2",weight:"bold",color:"primary",children:"All deposits you make until the lock timer ends will be locked for the same duration."})]})]}),Object(h.jsxs)(y.a,{flow:"col",justify:"space-between",children:[Object(h.jsx)(pe.a,{type:"default",onClick:n.onCancel,children:"Cancel"}),Object(h.jsx)(pe.a,{type:"primary",onClick:n.onOk,children:"Deposit"})]})]})}))},Ka=function(){var e,t,a,r,c=Object(P.b)(),s=Object(Y.b)().projectToken,l=ue(),d=Object(o.useState)(!1),u=Object(n.a)(d,2),b=u[0],j=u[1],p=Object(o.useState)(!1),m=Object(n.a)(p,2),O=m[0],f=m[1],g=Object(o.useState)(!1),v=Object(n.a)(g,2),x=v[0],w=v[1],y=Object(o.useState)(!1),A=Object(n.a)(y,2),_=A[0],S=A[1],D=Object(o.useState)(!1),E=Object(n.a)(D,2),T=E[0],F=E[1],R=l.daoBarn,I=R.balance,B=R.userLockedUntil,U=s.contract,M=null===(e=U.balance)||void 0===e?void 0:e.unscaleBy(s.decimals),L=U.getAllowanceOf(null===(t=c.contracts.dao)||void 0===t?void 0:t.barn),q=(null!==B&&void 0!==B?B:0)>Date.now(),G=la({validationScheme:{amount:{rules:{required:!0,min:0},messages:{required:"Value is required.",min:"Should be a positive value."}}},onSubmit:function(){q?F(!0):S(!0)}});function W(){return Q.apply(this,arguments)}function Q(){return(Q=Object(z.a)($.a.mark((function e(){return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j(!0),e.prev=1,e.next=4,U.loadBalance();case 4:return e.next=6,l.daoBarn.loadUserData();case 6:e.next=10;break;case 8:e.prev=8,e.t0=e.catch(1);case 10:j(!1);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})))).apply(this,arguments)}Object(o.useEffect)((function(){W().catch(Error)}),[]);var Z=G.formState,H=(0,G.watch)("amount"),K=C.a.from(H),X=Object(o.useMemo)((function(){var e;return null!==(e=null===L||void 0===L?void 0:L.gt(C.a.ZERO))&&void 0!==e&&e}),[L]),J=X&&Z.isDirty&&Z.isValid&&!x;function ee(){return(ee=Object(z.a)($.a.mark((function e(){var t,a;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null===(t=c.contracts.dao)||void 0===t?void 0:t.barn){e.next=3;break}return e.abrupt("return");case 3:return f(!0),e.prev=4,e.next=7,U.approve(a,!0);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(4),console.error(e.t0);case 12:f(!1);case 13:case"end":return e.stop()}}),e,null,[[4,9]])})))).apply(this,arguments)}function te(e,t){return ae.apply(this,arguments)}function ae(){return ae=Object(z.a)($.a.mark((function e(t,a){var n;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(w(!0),e.prev=1,!(n=t.scaleBy(s.decimals))){e.next=8;break}return e.next=6,l.daoBarn.deposit(n,a);case 6:return e.next=8,W();case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.error(e.t0);case 13:w(!1);case 14:case"end":return e.stop()}}),e,null,[[1,10]])}))),ae.apply(this,arguments)}function ne(){return(ne=Object(z.a)($.a.mark((function e(t){return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(K){e.next=2;break}return e.abrupt("return");case 2:return S(!1),e.next=5,te(K,t);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return b?Object(h.jsx)("div",{className:"flex justify-center p-24",style:{minHeight:"518px"},children:Object(h.jsx)(Oa,{})}):Object(h.jsxs)(h.Fragment,{children:[c.features.faucets&&Object(h.jsx)(jt.b,{to:"/faucets",className:"button-ghost ml-auto",children:"Faucets"}),Object(h.jsxs)(da,{form:G,className:"flex flow-row row-gap-32 p-24",disabled:x,children:[Object(h.jsxs)("div",{className:"container-box flex flow-col col-gap-44",children:[Object(h.jsxs)("div",{className:"flex flow-row row-gap-4",children:[Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"secondary",children:"Portfolio balance"}),Object(h.jsxs)("div",{className:"flex flow-col col-gap-8 align-center",children:[Object(h.jsx)(N.b,{type:"p1",weight:"bold",color:"primary",children:null!==(a=Object(V.b)(I))&&void 0!==a?a:"-"}),Object(h.jsx)(_e.a,{name:s.icon})]})]}),Object(h.jsxs)("div",{className:"flex flow-row row-gap-4",children:[Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"secondary",children:"Wallet balance"}),Object(h.jsxs)("div",{className:"flex flow-col col-gap-8 align-center",children:[Object(h.jsx)(N.b,{type:"p1",weight:"bold",color:"primary",children:null!==(r=Object(V.b)(M))&&void 0!==r?r:"-"}),Object(h.jsx)(_e.a,{name:s.icon})]})]})]}),Object(h.jsx)(ja,{name:"amount",label:"Amount",children:function(e){var t=e.field;return Object(h.jsx)(Qa,Object(i.a)({before:Object(h.jsx)(_e.a,{name:s.icon}),max:M,disabled:x,decimals:s.decimals,slider:!0},t))}}),Object(h.jsx)(Jt,{message:"Deposits made after you have an ongoing lock will be added to the locked balance and will be subjected to the same lock timer."}),Object(h.jsxs)("div",{className:"flex flow-col col-gap-12 align-center justify-end",children:[!X&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("button",{type:"button",className:"button-primary align-self-start",onClick:function(){return ee.apply(this,arguments)},children:[O&&Object(h.jsx)(Oa,{className:"mr-4"}),"Enable ",s.symbol]}),Object(h.jsx)(k.a,{name:"arrow-forward"})]}),Object(h.jsxs)("button",{type:"submit",className:"button-primary align-self-start",disabled:!J,children:[x&&Object(h.jsx)(Oa,{className:"mr-4"}),"Deposit"]})]})]}),T&&Object(h.jsx)(Ha,{deposit:K,lockDuration:B,onCancel:function(){return F(!1)},onOk:function(){F(!1)}}),_&&Object(h.jsx)(Qt,{title:"Confirm deposit",header:Object(h.jsxs)("div",{className:"container-box flex flow-row row-gap-4",children:[Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"secondary",children:"Deposit amount"}),Object(h.jsxs)("div",{className:"flex flow-col col-gap-8 align-center",children:[Object(h.jsx)(N.b,{type:"p1",weight:"bold",color:"primary",children:Object(V.b)(K,{decimals:s.decimals})}),Object(h.jsx)(_e.a,{name:s.icon})]})]}),submitText:"Confirm your deposit",onCancel:function(){S(!1)},onConfirm:function(e){return function(e){return ne.apply(this,arguments)}(e.gasPrice)}})]})},Xa=a(61),$a=a(197),Ja=a(120),en=a(251),tn=a(424),an=a(1478),nn=a.n(an),on=a(1856),rn=a.n(on),cn=a(1857),sn=a.n(cn),ln=["className"],dn=nn()(rn.a),un=function(e){var t=e.className,a=Object(s.a)(e,ln);return Object(h.jsx)(dn,Object(i.a)({className:b()(sn.a.component,t),dropdownClassName:sn.a.dropdown},a))},bn=["ref"],jn="1 mo",pn="3 mo",hn="6 mo",mn=["1 w",jn,pn,hn,"1 y"];function On(e,t){switch(t){case"1 w":return Object(Xa.a)(e,7);case jn:return Object(Ja.a)(e,1);case pn:return Object(Ja.a)(e,3);case hn:return Object(Ja.a)(e,6);case"1 y":return Object(Xa.a)(e,365);default:return}}var fn=function(){var e,t,a=Object(Y.b)().projectToken,r=ue(),c=Object(o.useState)(!1),l=Object(n.a)(c,2),d=l[0],u=l[1],j=Object(o.useState)(!1),p=Object(n.a)(j,2),m=p[0],O=p[1],f=Object(o.useState)(!1),g=Object(n.a)(f,2),v=g[0],x=g[1],w=r.daoBarn,y=w.balance,k=w.userLockedUntil,A=la({validationScheme:{lockEndDate:{rules:{required:!0,min:function(e){var t;return Object($a.a)(Date.now(),1).valueOf()<(null!==(t=null===e||void 0===e?void 0:e.valueOf())&&void 0!==t?t:0)},max:function(e){var t;return Object(en.a)(Date.now(),1).valueOf()>(null!==(t=null===e||void 0===e?void 0:e.valueOf())&&void 0!==t?t:0)}},messages:{required:"Required",min:"Should be more than 1 minute",max:"Should be less than 1 year"}}},onSubmit:function(){x(!0)}});function C(){return _.apply(this,arguments)}function _(){return(_=Object(z.a)($.a.mark((function e(){var t,a;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),e.prev=1,e.next=4,r.daoBarn.loadUserData();case 4:t=r.daoBarn.userLockedUntil,(a=t?new Date(1e3*t):void 0)&&a.valueOf()<=Date.now()&&(a=void 0),A.reset({lockEndDate:a}),e.next=12;break;case 10:e.prev=10,e.t0=e.catch(1);case 12:u(!1);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})))).apply(this,arguments)}Object(o.useEffect)((function(){C().catch(Error)}),[]);var S=A.formState,P=(0,A.watch)("lockEndDate"),D=S.isDirty&&!m;function E(e,t){return T.apply(this,arguments)}function T(){return(T=Object(z.a)($.a.mark((function e(t,a){var n;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(O(!0),e.prev=1,!t){e.next=9;break}if(!((n=Object(tn.a)(t))&&n>0)){e.next=9;break}return e.next=7,r.daoBarn.lock(n,a);case 7:return e.next=9,C();case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.error(e.t0);case 14:O(!1);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})))).apply(this,arguments)}function F(){return(F=Object(z.a)($.a.mark((function e(t){return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(!1),e.next=3,E(P,t);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return d?Object(h.jsx)("div",{className:"flex justify-center p-24",style:{minHeight:"518px"},children:Object(h.jsx)(Oa,{})}):Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)(da,{form:A,className:"flex flow-row row-gap-32 p-24",disabled:m,children:[Object(h.jsxs)("div",{className:"container-box flex flow-col col-gap-44",children:[Object(h.jsxs)("div",{className:"flex flow-row row-gap-4",children:[Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"secondary",children:"Portfolio balance"}),Object(h.jsxs)("div",{className:"flex flow-col col-gap-8 align-center",children:[Object(h.jsx)(N.b,{type:"p1",weight:"bold",color:"primary",children:null!==(e=Object(V.b)(y))&&void 0!==e?e:"-"}),Object(h.jsx)(_e.a,{name:a.icon})]})]}),Object(h.jsxs)("div",{className:"flex flow-row row-gap-4",children:[Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"secondary",children:"Lock duration"}),Object(h.jsx)("div",{className:"flex flow-col col-gap-8 align-center",children:Object(h.jsx)(Te,{end:1e3*(null!==k&&void 0!==k?k:Object(tn.a)(new Date)),delay:1e3,children:function(e){var t;return Object(h.jsx)(N.b,{type:"p1",weight:"bold",color:"primary",children:(null===(t=Object(Re.a)(e/1e3))||void 0===t?void 0:t.trim())||"0s"})}})})]})]}),Object(h.jsx)(ja,{name:"lockEndDate",label:"Lock end date",children:function(e){var t=e.field,a=(t.ref,Object(s.a)(t,bn));return Object(h.jsxs)("div",{className:"flex flow-row row-gap-16",children:[Object(h.jsx)(un,Object(i.a)({showTime:!0,showNow:!1,format:"DD/MM/YYYY HH:mm",size:"large"},a)),Object(h.jsx)("div",{className:"flexbox-grid",style:{"--gap":"8px"},children:mn.map((function(e){var t,n;return Object(h.jsx)("button",{type:"button",className:b()("flex justify-center ph-24 pv-16",(null===(t=a.value)||void 0===t?void 0:t.valueOf())===(null===(n=On(new Date,e))||void 0===n?void 0:n.valueOf())?"button-primary":"button-ghost-monochrome"),onClick:function(){A.updateValue("lockEndDate",On(new Date,e))},children:e},e)}))})]})}}),Object(h.jsx)(Jt,{message:"All locked balances will be unavailable for withdrawal until the lock timer ends. All future deposits will be locked for the same time."}),Object(h.jsx)("div",{className:"flex flow-col col-gap-12 align-center justify-end",children:Object(h.jsxs)("button",{type:"submit",className:"button-primary",disabled:!D,children:[m&&Object(h.jsx)(Oa,{className:"mr-4"}),"Lock"]})})]}),v&&Object(h.jsx)(Qt,{title:"Are you sure you want to lock your balance?",header:Object(h.jsxs)("div",{className:"flex flow-row row-gap-16",children:[Object(h.jsxs)(N.b,{type:"p2",weight:"bold",color:"secondary",children:["You are about to lock"," ",Object(h.jsxs)("span",{className:"primary-color",children:[Object(V.b)(y)," ",a.symbol]})," ","for"," ",Object(h.jsx)("span",{className:"primary-color",children:Object(Re.a)(Date.now(),null!==(t=null===P||void 0===P?void 0:P.valueOf())&&void 0!==t?t:0)}),". You cannot undo this or partially lock your balance. Locked tokens will be unavailable for withdrawal until the lock timer ends. All future deposits you make will be locked for the same time."]}),Object(h.jsx)(N.b,{type:"p2",weight:"bold",color:"primary",children:"The multiplier you get for locking tokens only applies to your voting power, it does not earn more rewards."})]}),submitText:"Lock balance",onCancel:function(){x(!1)},onConfirm:function(e){return function(e){return F.apply(this,arguments)}(e.gasPrice)}})]})},gn=["ref"],vn="1 mo",xn="3 mo",wn="6 mo",yn=["1 w",vn,xn,wn,"1 y"];function kn(e,t){switch(t){case"1 w":return Object(Xa.a)(e,7);case vn:return Object(Ja.a)(e,1);case xn:return Object(Ja.a)(e,3);case wn:return Object(Ja.a)(e,6);case"1 y":return Object(Xa.a)(e,365);default:return}}var Nn=function(){var e,t,a,r,c=Object(P.b)(),l=Object(Y.b)().projectToken,d=ue(),u=Object(o.useState)(!1),j=Object(n.a)(u,2),p=j[0],m=j[1],O=Object(o.useState)(!1),f=Object(n.a)(O,2),g=f[0],v=f[1],x=Object(o.useState)(!1),w=Object(n.a)(x,2),y=w[0],A=w[1],_=Object(o.useState)(!1),S=Object(n.a)(_,2),D=S[0],E=S[1],T=Object(o.useState)(!1),F=Object(n.a)(T,2),R=F[0],I=F[1],B=d.daoBarn,U=B.balance,M=B.userLockedUntil,L=l.contract,q=null===(e=L.balance)||void 0===e?void 0:e.unscaleBy(l.decimals),G=L.getAllowanceOf(null===(t=c.contracts.dao)||void 0===t?void 0:t.barn),W=(null!==M&&void 0!==M?M:0)>Date.now(),Q=la({validationScheme:{lockEndDate:{rules:{required:!0,min:function(e){var t;return Object($a.a)(Date.now(),1).valueOf()<(null!==(t=null===e||void 0===e?void 0:e.valueOf())&&void 0!==t?t:0)},max:function(e){var t;return Object(en.a)(Date.now(),1).valueOf()>(null!==(t=null===e||void 0===e?void 0:e.valueOf())&&void 0!==t?t:0)}},messages:{required:"Required",min:"Should be more than 1 minute",max:"Should be less than 1 year"}},amount:{rules:{required:!0,min:0},messages:{required:"Value is required.",min:"Should be a positive value."}}},onSubmit:function(){W?I(!0):E(!0)}});function Z(){return H.apply(this,arguments)}function H(){return(H=Object(z.a)($.a.mark((function e(){var t,a;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(!0),e.prev=1,e.next=4,L.loadBalance();case 4:return e.next=6,d.daoBarn.loadUserData();case 6:t=d.daoBarn.userLockedUntil,(a=t?new Date(1e3*t):void 0)&&a.valueOf()<=Date.now()&&(a=void 0),Q.reset({lockEndDate:a}),e.next=14;break;case 12:e.prev=12,e.t0=e.catch(1);case 14:m(!1);case 15:case"end":return e.stop()}}),e,null,[[1,12]])})))).apply(this,arguments)}Object(o.useEffect)((function(){Z().catch(Error)}),[]);var K=Q.formState,X=Q.watch,J=X("amount"),ee=X("lockEndDate"),te=C.a.from(J),ae=Object(o.useMemo)((function(){var e;return null!==(e=null===G||void 0===G?void 0:G.gt(C.a.ZERO))&&void 0!==e&&e}),[G]),ne=ae&&K.isDirty&&K.isValid&&!y;function oe(){return(oe=Object(z.a)($.a.mark((function e(){var t,a;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null===(t=c.contracts.dao)||void 0===t?void 0:t.barn){e.next=3;break}return e.abrupt("return");case 3:return v(!0),e.prev=4,e.next=7,L.approve(a,!0);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(4),console.error(e.t0);case 12:v(!1);case 13:case"end":return e.stop()}}),e,null,[[4,9]])})))).apply(this,arguments)}function re(e,t,a,n,o){return ce.apply(this,arguments)}function ce(){return ce=Object(z.a)($.a.mark((function e(t,a,n,o,r){var c,i;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(A(!0),e.prev=1,!(c=t.scaleBy(l.decimals))||!a){e.next=10;break}return e.next=6,d.daoBarn.deposit(c,r);case 6:if(!((i=Object(tn.a)(a))&&i>0)){e.next=10;break}return e.next=10,Z();case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.error(e.t0);case 15:A(!1);case 16:case"end":return e.stop()}}),e,null,[[1,12]])}))),ce.apply(this,arguments)}function ie(){return(ie=Object(z.a)($.a.mark((function e(t){return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(te){e.next=2;break}return e.abrupt("return");case 2:return E(!1),e.next=5,re(te,ee,2,"0x831f112",t);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return p?Object(h.jsx)("div",{className:"flex justify-center p-24",style:{minHeight:"518px"},children:Object(h.jsx)(Oa,{})}):Object(h.jsxs)(h.Fragment,{children:[c.features.faucets&&Object(h.jsx)(jt.b,{to:"/faucets",className:"button-ghost ml-auto",children:"Faucets"}),Object(h.jsxs)(da,{form:Q,className:"flex flow-row row-gap-32 p-24",disabled:y,children:[Object(h.jsxs)("div",{className:"container-box flex flow-col col-gap-44",children:[Object(h.jsxs)("div",{className:"flex flow-row row-gap-4",children:[Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"secondary",children:"Portfolio balance"}),Object(h.jsxs)("div",{className:"flex flow-col col-gap-8 align-center",children:[Object(h.jsx)(N.b,{type:"p1",weight:"bold",color:"primary",children:null!==(a=Object(V.b)(U))&&void 0!==a?a:"-"}),Object(h.jsx)(_e.a,{name:l.icon})]})]}),Object(h.jsxs)("div",{className:"flex flow-row row-gap-4",children:[Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"secondary",children:"Wallet balance"}),Object(h.jsxs)("div",{className:"flex flow-col col-gap-8 align-center",children:[Object(h.jsx)(N.b,{type:"p1",weight:"bold",color:"primary",children:null!==(r=Object(V.b)(q))&&void 0!==r?r:"-"}),Object(h.jsx)(_e.a,{name:l.icon})]})]}),Object(h.jsxs)("div",{className:"flex flow-row row-gap-4",children:[Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"secondary",children:"Lock duration"}),Object(h.jsx)("div",{className:"flex flow-col col-gap-8 align-center",children:Object(h.jsx)(Te,{end:1e3*(null!==M&&void 0!==M?M:Object(tn.a)(new Date)),delay:1e3,children:function(e){var t;return Object(h.jsx)(N.b,{type:"p1",weight:"bold",color:"primary",children:(null===(t=Object(Re.a)(e/1e3))||void 0===t?void 0:t.trim())||"0s"})}})})]})]}),Object(h.jsx)(ja,{name:"amount",label:"Amount",children:function(e){var t=e.field;return Object(h.jsx)(Qa,Object(i.a)({before:Object(h.jsx)(_e.a,{name:l.icon}),max:q,disabled:y,decimals:l.decimals,slider:!0},t))}}),Object(h.jsx)(ja,{name:"lockEndDate",label:"Lock end date",children:function(e){var t=e.field,a=(t.ref,Object(s.a)(t,gn));return Object(h.jsxs)("div",{className:"flex flow-row row-gap-16",children:[Object(h.jsx)(un,Object(i.a)({showTime:!0,showNow:!1,format:"DD/MM/YYYY HH:mm",size:"large"},a)),Object(h.jsx)("div",{className:"flexbox-grid",style:{"--gap":"8px"},children:yn.map((function(e){var t,n;return Object(h.jsx)("button",{type:"button",className:b()("flex justify-center ph-24 pv-16",(null===(t=a.value)||void 0===t?void 0:t.valueOf())===(null===(n=kn(new Date,e))||void 0===n?void 0:n.valueOf())?"button-primary":"button-ghost-monochrome"),onClick:function(){Q.updateValue("lockEndDate",kn(new Date,e))},children:e},e)}))})]})}}),Object(h.jsx)(Jt,{message:"Deposits made after you have an ongoing lock will be added to the locked balance and will be subjected to the same lock timer."}),Object(h.jsxs)("div",{className:"flex flow-col col-gap-12 align-center justify-end",children:[!ae&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("button",{type:"button",className:"button-primary align-self-start",onClick:function(){return oe.apply(this,arguments)},children:[g&&Object(h.jsx)(Oa,{className:"mr-4"}),"Enable ",l.symbol]}),Object(h.jsx)(k.a,{name:"arrow-forward"})]}),Object(h.jsxs)("button",{type:"submit",className:"button-primary align-self-start",disabled:!ne,children:[y&&Object(h.jsx)(Oa,{className:"mr-4"}),"Deposit"]})]})]}),R&&Object(h.jsx)(Ha,{deposit:te,lockDuration:M,onCancel:function(){return I(!1)},onOk:function(){I(!1)}}),D&&Object(h.jsx)(Qt,{title:"Confirm deposit",header:Object(h.jsxs)("div",{className:"container-box flex flow-row row-gap-4",children:[Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"secondary",children:"Deposit amount"}),Object(h.jsxs)("div",{className:"flex flow-col col-gap-8 align-center",children:[Object(h.jsx)(N.b,{type:"p1",weight:"bold",color:"primary",children:Object(V.b)(te,{decimals:l.decimals})}),Object(h.jsx)(_e.a,{name:l.icon})]})]}),submitText:"Confirm your deposit",onCancel:function(){E(!1)},onConfirm:function(e){return function(e){return ie.apply(this,arguments)}(e.gasPrice)}})]})},An=function(){var e,t,a,r=Object(Y.b)().projectToken,c=ue(),s=Object(o.useState)(!1),l=Object(n.a)(s,2),d=l[0],u=l[1],b=Object(o.useState)(!1),j=Object(n.a)(b,2),p=j[0],m=j[1],O=Object(o.useState)(!1),f=Object(n.a)(O,2),g=f[0],v=f[1],x=c.daoBarn,w=x.balance,y=x.userLockedUntil,k=r.contract,A=null===(e=k.balance)||void 0===e?void 0:e.unscaleBy(r.decimals),_=1e3*(null!==y&&void 0!==y?y:0)>Date.now(),S=la({validationScheme:{amount:{rules:{required:!0,min:0},messages:{required:"Value is required.",min:"Should be a positive value."}}},onSubmit:function(){F&&v(!0)}});function P(){return D.apply(this,arguments)}function D(){return(D=Object(z.a)($.a.mark((function e(){return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),e.prev=1,e.next=4,k.loadBalance();case 4:return e.next=6,c.daoBarn.loadUserData();case 6:e.next=10;break;case 8:e.prev=8,e.t0=e.catch(1);case 10:u(!1);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})))).apply(this,arguments)}Object(o.useEffect)((function(){P().catch(Error)}),[]);var E=S.formState,T=(0,S.watch)("amount"),F=C.a.from(T),R=E.isDirty&&!p&&!_;function I(e,t){return B.apply(this,arguments)}function B(){return B=Object(z.a)($.a.mark((function e(t,a){var n;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(m(!0),e.prev=1,!(n=t.scaleBy(r.decimals))){e.next=8;break}return e.next=6,c.daoBarn.withdraw(n,a);case 6:return e.next=8,P();case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.error(e.t0);case 13:m(!1);case 14:case"end":return e.stop()}}),e,null,[[1,10]])}))),B.apply(this,arguments)}function U(){return(U=Object(z.a)($.a.mark((function e(t){return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(F){e.next=2;break}return e.abrupt("return");case 2:return v(!1),e.next=5,I(F,t);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return d?Object(h.jsx)("div",{className:"flex justify-center p-24",style:{minHeight:"518px"},children:Object(h.jsx)(Oa,{})}):Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)(da,{form:S,className:"flex flow-row row-gap-32 p-24",disabled:p,children:[Object(h.jsxs)("div",{className:"container-box flex flow-col col-gap-44",children:[Object(h.jsxs)("div",{className:"flex flow-row row-gap-4",children:[Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"secondary",children:"Portfolio balance"}),Object(h.jsxs)("div",{className:"flex flow-col col-gap-8 align-center",children:[Object(h.jsx)(N.b,{type:"p1",weight:"bold",color:"primary",children:null!==(t=Object(V.b)(w))&&void 0!==t?t:"-"}),Object(h.jsx)(_e.a,{name:r.icon})]})]}),Object(h.jsxs)("div",{className:"flex flow-row row-gap-4",children:[Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"secondary",children:"Wallet balance"}),Object(h.jsxs)("div",{className:"flex flow-col col-gap-8 align-center",children:[Object(h.jsx)(N.b,{type:"p1",weight:"bold",color:"primary",children:null!==(a=Object(V.b)(A))&&void 0!==a?a:"-"}),Object(h.jsx)(_e.a,{name:r.icon})]})]})]}),Object(h.jsx)(ja,{name:"amount",label:"Amount",children:function(e){var t=e.field;return Object(h.jsx)(Qa,Object(i.a)({before:Object(h.jsx)(_e.a,{name:r.icon}),max:w,disabled:p,decimals:r.decimals,slider:!0},t))}}),Object(h.jsx)(Jt,{message:"Locked balances are not available for withdrawal until the timer ends. Withdrawal means you will stop earning staking rewards for the amount withdrawn."}),Object(h.jsx)("div",{className:"flex flow-col col-gap-12 align-center justify-end",children:Object(h.jsxs)("button",{type:"submit",className:"button-primary",disabled:!R,children:[p&&Object(h.jsx)(Oa,{className:"mr-4"}),"Withdraw"]})})]}),g&&Object(h.jsx)(Qt,{title:"Confirm withdraw",header:Object(h.jsxs)("div",{className:"container-box flex flow-row row-gap-4",children:[Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"secondary",children:"Withdraw amount"}),Object(h.jsxs)("div",{className:"flex flow-col col-gap-8 align-center",children:[Object(h.jsx)(N.b,{type:"p1",weight:"bold",color:"primary",children:Object(V.b)(F,{decimals:r.decimals})}),Object(h.jsx)(_e.a,{name:r.icon})]})]}),submitText:"Confirm your withdraw",onCancel:function(){v(!1)},onConfirm:function(e){return function(e){return U.apply(this,arguments)}(e.gasPrice)}})]})},Cn=function(){var e=Object(q.c)();return e.initialized?e.isActive?Object(h.jsxs)("div",{className:"container-fit",children:[Object(h.jsx)(N.b,{type:"h1",weight:"bold",color:"primary",className:"mb-32",children:"Portfolio"}),Object(h.jsxs)("div",{className:"card",children:[Object(h.jsx)("div",{className:"card-header pv-0",children:Object(h.jsx)(ft,{tabs:[{id:"deposit",children:"Deposit",to:"/governance/portfolio/deposit"},{id:"lock",children:"Lock",to:"/governance/portfolio/lock"},{id:"stake",children:"Node Stake",to:"/governance/portfolio/stake"},{id:"delegate",children:"Delegate",to:"/governance/portfolio/delegate"},{id:"withdraw",children:"Withdraw",to:"/governance/portfolio/withdraw"}]})}),Object(h.jsxs)(c.d,{children:[Object(h.jsx)(c.b,{path:"/governance/portfolio/deposit",component:Ka}),Object(h.jsx)(c.b,{path:"/governance/portfolio/lock",component:fn}),Object(h.jsx)(c.b,{path:"/governance/portfolio/stake",component:Nn}),Object(h.jsx)(c.b,{path:"/governance/portfolio/delegate",component:Ba}),Object(h.jsx)(c.b,{path:"/governance/portfolio/withdraw",component:An})]})]})]}):Object(h.jsx)(c.a,{to:"/governance/overview"}):null},_n=a(1919),Sn=a(1871),Vn=a.n(Sn),Pn=["className"],Dn=function(e){var t=e.className,a=Object(s.a)(e,Pn);return Object(h.jsx)(ya.a.TextArea,Object(i.a)({className:b()(Vn.a.component,t)},a))},En=a(338),Tn=a.n(En),Fn=a(1899),Rn=a.n(Fn),In=a(1929),Bn=a(1565),Un=a(1915);function Mn(e){return e.map((function(e){if("string"===typeof e)try{var t=JSON.parse(e);if("object"===typeof t)return t}catch(a){}return e}))}var Ln=function(){function e(t){Object(Q.a)(this,e),this.abi=void 0,this.abi=new In.a(t)}return Object(Z.a)(e,[{key:"writableFunctions",get:function(){return Object.values(this.abi.functions).filter((function(e){return!["view","pure"].includes(e.stateMutability)}))}},{key:"encodeFunctionData",value:function(e,t){return this.abi.encodeFunctionData(e,Mn(null!==t&&void 0!==t?t:[]))}}],[{key:"encodeFunctionData",value:function(e,t){try{var a="string"===typeof e?Bn.e.fromString(e):e;return Un.a.encode(a.inputs,Mn(null!==t&&void 0!==t?t:[]))}catch(n){console.error("AbiInterface::encodeFunctionData",n.message)}}},{key:"decodeFunctionData",value:function(e,t){try{var a="string"===typeof e?Bn.e.fromString(e):e,n=0!==t.indexOf("0x")?"0x".concat(t):t;return Un.a.decode(a.inputs,n)}catch(o){console.error("AbiInterface::decodeFunctionData",o.message)}}},{key:"getFunctionFragmentFrom",value:function(e){try{return Bn.e.fromString(e)}catch(t){console.error("AbiInterface::getFunctionFragmentFrom",t.message)}}},{key:"stringifyParamValue",value:function(e){try{return Array.isArray(e)?JSON.stringify(e,null,2):"function"===typeof(null===e||void 0===e?void 0:e.toString)?e.toString():JSON.stringify(e,null,2)}catch(t){console.error("AbiInterface::stringifyParamValue",t.message)}}}]),e}(),qn=a(433),Gn=a(1872),Yn=a.n(Gn),Wn=["className"],zn=[{label:"Yes",value:!0},{label:"No",value:!1}],Qn=function(e){var t=e.className,a=Object(s.a)(e,Wn);return Object(h.jsx)(Dt.a.Group,Object(i.a)({className:b()(Yn.a.component,t),options:zn,optionType:"button",buttonStyle:"outline"},a))},Zn=a(34),Hn=a(230),Kn=["max","onAdd"],Xn=function(e){var t=e.max,a=e.onAdd,o=Object(s.a)(e,Kn),c=r.a.useState(!1),l=Object(n.a)(c,2),d=l[0],u=l[1],b=r.a.useState(""),j=Object(n.a)(b,2),p=j[0],m=j[1];var O=Object(h.jsxs)(y.a,{flow:"row",gap:24,children:[Object(h.jsxs)(y.a,{flow:"row",gap:8,children:[Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"secondary",children:"Number of zeros"}),Object(h.jsxs)(y.a,{flow:"col",gap:16,children:[Object(h.jsx)(pe.a,{type:"ghost",onClick:function(){return m("6")},children:"6"}),Object(h.jsx)(pe.a,{type:"ghost",onClick:function(){return m("8")},children:"8"}),Object(h.jsx)(pe.a,{type:"ghost",onClick:function(){return m("18")},children:"18"}),Object(h.jsx)(Ca,{type:"number",value:p,max:t,placeholder:"Max ".concat(t),onChange:function(e){m(e.target.value)}})]})]}),Object(h.jsx)(N.b,{type:"p2",weight:"semibold",color:"secondary",children:"Use the options above to add trailing zeros to the input amount."}),Object(h.jsxs)(y.a,{flow:"col",gap:16,justify:"space-between",children:[Object(h.jsx)(pe.a,{type:"ghost",onClick:function(){u(!1),m("")},children:"Cancel"}),Object(h.jsx)(pe.a,{type:"primary",onClick:function(){u(!1);var e=Number(p);Number.isNaN(e)||null===a||void 0===a||a(e),m("")},children:"Add zeros"})]})]});return Object(h.jsx)(Hn.a,Object(i.a)(Object(i.a)({title:"Add zeros",placement:"bottomLeft",overlayStyle:{width:376},content:O,visible:d,onVisibleChange:u},o),{},{children:Object(h.jsx)(pe.a,{type:"link",icon:Object(h.jsx)(k.a,{name:"plus-square-outlined",width:16,height:16})})}))},$n=a(1881),Jn=a.n($n),eo=a(1471),to=a.n(eo),ao=a(601),no=a.n(ao),oo=a(1873),ro=a.n(oo),co=["children","items","onClick"],io=function(e){var t=e.children,a=e.items,n=(e.onClick,Object(s.a)(e,co)),o=r.a.useRef();return Object(h.jsx)(no.a,Object(i.a)(Object(i.a)({ref:o,overlayClassName:ro.a.component,placement:"bottom",trigger:"click",content:Object(h.jsx)(to.a,{onClick:function(t){var a,n;null===(a=e.onClick)||void 0===a||a.call(e,t.key),null===(n=o.current)||void 0===n||n.close()},children:null===a||void 0===a?void 0:a.map((function(e){return Object(h.jsxs)(to.a.Item,{children:[e.icon,e.title]},e.key)}))})},n),{},{children:t}))},so=a(1875),lo=a.n(so),uo=a(1874),bo=a.n(uo),jo=["className","children","footer"],po=function(e){var t=e.className,a=e.children,n=e.footer,o=Object(s.a)(e,jo);return Object(h.jsxs)(lo.a,Object(i.a)(Object(i.a)({className:b()(bo.a.component,t)},o),{},{children:[Object(h.jsx)("div",{className:bo.a.content,children:a}),n&&Object(h.jsx)("div",{className:bo.a.footer,children:n})]}))},ho=a(1880),mo=a.n(ho),Oo=["className","title","target","signature","callData","showSettings","onDeleteAction","onEditAction","children"],fo=function(e){var t=e.className,a=e.title,o=e.target,c=e.signature,l=e.callData,d=e.showSettings,u=e.onDeleteAction,j=e.onEditAction,p=(e.children,Object(s.a)(e,Oo)),m=r.a.useState(!1),O=Object(n.a)(m,2),f=O[0],g=O[1],v=r.a.useState(!1),x=Object(n.a)(v,2),A=x[0],C=x[1],_=r.a.useState(!1),S=Object(n.a)(_,2),P=S[0],D=S[1],E=r.a.useMemo((function(){return Ln.getFunctionFragmentFrom(c)}),[c]),T=r.a.useMemo((function(){var e;return E&&null!==(e=Ln.decodeFunctionData(E,l))&&void 0!==e?e:[]}),[E,l]),F=r.a.useMemo((function(){var e,t=null===T||void 0===T?void 0:T.map((function(e){return Ln.stringifyParamValue(e)}));return null!==(e=null===t||void 0===t?void 0:t.join(",\n"))&&void 0!==e?e:""}),[T]),R=[{key:"sig",icon:Object(h.jsx)(k.a,{name:"chevron-right"}),title:Object(h.jsx)(N.b,{type:"p1",weight:"semibold",children:P?"Show transaction":"Show function signature"})},{key:"edit",icon:Object(h.jsx)(k.a,{name:"pencil-outlined"}),title:"Edit action"},{key:"delete",icon:Object(h.jsx)(k.a,{name:"bin-outlined",color:"red"}),title:Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"red",children:"Delete action"})}];function I(){D((function(e){return!e}))}return Object(h.jsx)(po,Object(i.a)(Object(i.a)({className:t,title:Object(h.jsx)(N.b,{type:"p2",weight:"semibold",color:"primary",children:a}),extra:d?Object(h.jsx)(io,{items:R,placement:"bottomLeft",onClick:function(e){return function(e){"sig"===e?I():"edit"===e?null===j||void 0===j||j():"delete"===e&&(null===u||void 0===u||u())}(String(e))},children:Object(h.jsx)(pe.a,{type:"link",icon:Object(h.jsx)(k.a,{name:"gear"})})}):Object(h.jsx)(pe.a,{type:"link",onClick:I,children:Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"secondary",children:P?"Show transaction":"Show function signature"})}),footer:f||A?Object(h.jsx)(y.a,{flow:"col",align:"center",justify:"center",children:Object(h.jsx)(pe.a,{type:"link",onClick:function(){C((function(e){return!e}))},children:Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"secondary",children:A?"Hide details":"Show more"})})}):null},p),{},{children:Object(h.jsxs)("div",{className:mo.a.content,children:[Object(h.jsx)(w.b,{address:o,query:"#writeContract",children:Object(h.jsx)(N.b,{type:"p1",weight:"semibold",className:mo.a.address,color:"blue",children:Object(V.f)(o)})}),c&&Object(h.jsxs)(Jn.a.Paragraph,{className:b()(mo.a.paragraph,A&&mo.a.expanded),style:{maxWidth:"514px",overflowWrap:"anywhere"},ellipsis:{rows:A?9999:2,expandable:!1,onEllipsis:function(e){g(e),e&&C(!e)}},children:[".",P?c:"".concat(null===E||void 0===E?void 0:E.name,"(").concat(F,")")]})]})}))},go=["targetAddress","functionSignature","functionEncodedParams"],vo=function(e){var t=e.targetAddress,a=e.functionSignature,n=e.functionEncodedParams,o=Object(s.a)(e,go);return Object(h.jsx)(Fe.a,Object(i.a)(Object(i.a)({width:560},o),{},{children:Object(h.jsxs)(y.a,{flow:"row",gap:32,children:[Object(h.jsxs)(y.a,{flow:"row",gap:24,children:[Object(h.jsx)(k.a,{name:"warning-outlined",width:40,height:40,color:"red"}),Object(h.jsxs)(y.a,{flow:"row",gap:8,children:[Object(h.jsx)(N.b,{type:"h3",weight:"semibold",color:"primary",children:"Action could not be simulated"}),Object(h.jsx)(N.b,{type:"p2",weight:"semibold",color:"secondary",children:"We run a simulation for every action before adding it to the proposal. The following action failed to simulate:"})]}),Object(h.jsx)(fo,{title:"",style:{width:"496px"},target:t,signature:a,callData:n}),Object(h.jsx)(N.b,{type:"p2",weight:"semibold",color:"secondary",children:"If you think this is a mistake, you can still add this action to the proposal."})]}),Object(h.jsxs)(y.a,{flow:"col",justify:"space-between",children:[Object(h.jsx)(pe.a,{type:"default",onClick:o.onOk,children:"Continue anyway"}),Object(h.jsx)(pe.a,{type:"primary",onClick:o.onCancel,children:"Go back"})]})]})}))},xo=a(1898),wo=a.n(xo),yo={targetAddress:"",isProxyAddress:!1,implementationAddress:"",addValueAttribute:!1,actionValue:"",addFunctionCall:!1,abiLoading:!1,abiInterface:void 0,functionSignature:"",functionMeta:void 0,functionParams:{},functionStrParams:"",functionEncodedParams:""},ko={showSimulatedActionModal:!1,simulatedAction:void 0,simulationResolve:void 0,simulationReject:void 0,formDirty:!1,submitting:!1},No=function(e){var t=e.edit,a=void 0!==t&&t,o=e.initialValues,c=void 0===o?yo:o,s=Object(Ut.b)().activeNetwork,l=Object(P.b)(),d=Object(Zn.d)(),u=yt.a.useForm(),b=Object(n.a)(u,1)[0],j=Object(W.a)(ko),p=Object(n.a)(j,2),m=p[0],O=p[1];function f(e){b.setFieldsValue({abiLoading:!0});var t="".concat(s.explorer.apiUrl,"/api?module=contract&action=getabi&address=").concat(e,"&apikey=").concat(s.explorer.key);fetch(t).then((function(e){return e.json()})).then((function(e){var t=e.status,a=e.result;return"1"===t?JSON.parse(a):Promise.reject(a)})).then((function(e){b.setFieldsValue({abiInterface:new Ln(e)})})).catch(Error).then((function(){b.setFieldsValue({abiLoading:!1})}))}function g(){return(g=Object(z.a)($.a.mark((function t(a){var n,o,r,c,i,s;return $.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.actions.some((function(e){return e!==a&&e.addFunctionCall&&e.targetAddress===a.targetAddress&&e.functionSignature===a.functionSignature&&e.functionEncodedParams===a.functionEncodedParams}))){t.next=4;break}return Tn.a.error({message:"Duplicate actions are disallowed!"}),t.abrupt("return");case 4:return O({submitting:!0}),n=!1,t.prev=6,t.next=9,b.validateFields();case 9:if(!a.addFunctionCall){t.next=20;break}return c=null===(o=a.abiInterface)||void 0===o?void 0:o.encodeFunctionData(a.functionMeta,Object.values(null!==(r=a.functionParams)&&void 0!==r?r:{})),t.prev=11,t.next=14,d.tryCall(a.targetAddress,null===(i=l.contracts.dao)||void 0===i?void 0:i.governance,c,a.actionValue);case 14:t.next=20;break;case 16:return t.prev=16,t.t0=t.catch(11),t.next=20,new Promise((function(e,t){O({showSimulatedActionModal:!0,simulatedAction:a,simulationResolve:e,simulationReject:t})}));case 20:return t.next=22,e.onSubmit(a);case 22:b.resetFields(),n=!0,t.next=29;break;case 26:t.prev=26,t.t1=t.catch(6),null!==t.t1&&void 0!==t.t1&&t.t1.message&&Tn.a.error({message:null===t.t1||void 0===t.t1?void 0:t.t1.message});case 29:O({submitting:!1}),n&&(null===(s=e.onCancel)||void 0===s||s.call(e));case 31:case"end":return t.stop()}}),t,null,[[6,26],[11,16]])})))).apply(this,arguments)}function v(e){var t,a;e?null===(t=m.simulationResolve)||void 0===t||t.call(m):null===(a=m.simulationReject)||void 0===a||a.call(m);O({showSimulatedActionModal:!1,simulationResolve:void 0,simulationReject:void 0})}return r.a.useEffect((function(){c!==yo&&(b.resetFields(),b.setFieldsValue(c))}),[c]),Object(h.jsx)(Fe.a,Object(i.a)(Object(i.a)({className:wo.a.component,confirmClose:m.formDirty,confirmText:"Are you sure you want to close this form?"},e),{},{children:Object(h.jsxs)("div",{className:wo.a.wrap,children:[Object(h.jsx)(N.b,{type:"h2",weight:"semibold",className:wo.a.headerLabel,color:"primary",children:a?"Edit action":"Add new action"}),Object(h.jsxs)(Vt,{className:wo.a.form,form:b,initialValues:{},validateTrigger:["onSubmit","onChange"],onValuesChange:function(e,t){var a=t.targetAddress,n=t.isProxyAddress,o=t.implementationAddress,r=t.addFunctionCall,c=t.abiInterface,i=t.functionSignature,s=t.functionMeta,l=t.functionParams;Object.keys(e).forEach((function(e){if("targetAddress"===e||"implementationAddress"===e){b.setFieldsValue({abiLoading:!1,abiInterface:void 0,functionSignature:"",functionMeta:void 0,functionParams:{},functionStrParams:"",functionEncodedParams:""});var t=o||a;!0===r&&t&&f(t)}else if("isProxyAddress"===e)!n&&o&&(b.setFieldsValue({abiLoading:!1,abiInterface:void 0,functionSignature:"",functionMeta:void 0,functionParams:{},functionStrParams:"",functionEncodedParams:""}),!0===r&&a&&f(a));else if("addValueAttribute"===e)b.setFieldsValue({actionValue:""});else if("addFunctionCall"===e){b.setFieldsValue({abiLoading:!1,abiInterface:void 0,functionSignature:"",functionMeta:void 0,functionParams:{},functionStrParams:"",functionEncodedParams:""});var d=o||a;!0===r&&d&&f(d)}else if("functionSignature"===e){var u,j=(null!==(u=null===c||void 0===c?void 0:c.writableFunctions)&&void 0!==u?u:[]).find((function(e){return e.format()===i})),p="";if(j){var h=j.inputs.map((function(e){return{name:e.name,type:e.type}})),m=JSON.stringify(h,null,2);p="Parameters:\n".concat(m)}b.setFieldsValue({functionMeta:j,functionParams:{},functionStrParams:p,functionEncodedParams:""})}else if("functionParams"===e&&s){var O=Object.values(l),g=Ln.encodeFunctionData(s,O);b.setFieldsValue({functionEncodedParams:g})}})),O({formDirty:b.isFieldsTouched()})},onFinish:function(e){return g.apply(this,arguments)},children:[Object(h.jsx)(Vt.Item,{name:"targetAddress",label:"Target address",hint:"This is the address to which the transaction will be sent.",rules:[{required:!0,message:"Required"}],children:Object(h.jsx)(Ca,{disabled:m.submitting})}),Object(h.jsxs)(y.a,{flow:"col",align:"center",justify:"space-between",children:[Object(h.jsx)(N.a,{text:"In case you are using a proxy address as the target, please specify the address where the function implementation is found.",children:Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"secondary",children:"Is this a proxy address?"})}),Object(h.jsx)(Vt.Item,{name:"isProxyAddress",noStyle:!0,children:Object(h.jsx)(Rn.a,{disabled:m.submitting})})]}),Object(h.jsx)(Vt.Item,{dependencies:["isProxyAddress"],noStyle:!0,children:function(e){var t=(0,e.getFieldsValue)().isProxyAddress;return!0===t&&Object(h.jsx)(Vt.Item,{name:"implementationAddress",hidden:!t,preserve:!1,rules:[{required:!0,message:"Required"}],children:Object(h.jsx)(Ca,{placeholder:"Implementation address",disabled:m.submitting})})}}),Object(h.jsx)(Vt.Item,{name:"addValueAttribute",label:"Add a value attribute to your action?",hint:"This field allows you to send some ETH along with your transaction.",rules:[{required:!0,message:"Required"}],children:Object(h.jsx)(Qn,{disabled:m.submitting})}),Object(h.jsx)(Vt.Item,{shouldUpdate:function(e){return!0===e.addValueAttribute},noStyle:!0,children:function(e){var t,a=e.getFieldsValue,n=a(),o=n.addValueAttribute,r=n.actionValue,c=78-(null!==(t=null===r||void 0===r?void 0:r.length)&&void 0!==t?t:0);return!0===o&&Object(h.jsx)(Vt.Item,{name:"actionValue",label:Object(h.jsxs)(y.a,{flow:"col",gap:8,children:[Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"secondary",children:"Action Value"}),Object(h.jsx)(Xn,{max:c,onAdd:function(e){var t=a().actionValue;if(t){var n="0".repeat(e);b.setFieldsValue({actionValue:"".concat(t).concat(n)})}}})]}),preserve:!1,rules:[{required:!0,message:"Required"}],children:Object(h.jsx)(Ca,{disabled:m.submitting})})}}),Object(h.jsx)(Vt.Item,{name:"addFunctionCall",label:"Add a function call to your action?",hint:"This field allows you to call a function on a smart contract.",rules:[{required:!0,message:"Required"}],children:Object(h.jsx)(Qn,{disabled:m.submitting})}),Object(h.jsx)(Vt.Item,{name:"abiLoading",preserve:!1,hidden:!0,noStyle:!0}),Object(h.jsx)(Vt.Item,{name:"abiInterface",preserve:!1,hidden:!0,noStyle:!0}),Object(h.jsx)(Vt.Item,{name:"functionMeta",preserve:!1,hidden:!0,noStyle:!0}),Object(h.jsx)(Vt.Item,{name:"functionStrParams",preserve:!1,hidden:!0,noStyle:!0}),Object(h.jsx)(Vt.Item,{name:"functionEncodedParams",preserve:!1,hidden:!0,noStyle:!0}),Object(h.jsx)(Vt.Item,{shouldUpdate:function(e){return!0===e.addFunctionCall},noStyle:!0,children:function(e){var t,a=(0,e.getFieldsValue)(),n=a.targetAddress,o=a.addFunctionCall,r=a.abiLoading,c=a.abiInterface,i=a.functionMeta,s=a.functionParams,l=a.functionStrParams,d=a.functionEncodedParams;if(!0!==o)return null;var u=null!==(t=null===c||void 0===c?void 0:c.writableFunctions.map((function(e){return{label:e.format(),value:e.format()}})))&&void 0!==t?t:[];return Object(h.jsxs)(y.a,{flow:"row",gap:32,children:[Object(h.jsx)(Vt.Item,{name:"functionSignature",label:"Select function",preserve:!1,rules:[{required:!0,message:"Required"}],children:Object(h.jsx)(qn.a,{loading:r,disabled:m.submitting,options:u,fixScroll:!0})}),i&&Object(h.jsxs)(y.a,{flow:"row",gap:32,children:[i.inputs.map((function(e){return Object(h.jsx)(Vt.Item,{name:["functionParams",e.name],label:Object(h.jsxs)(y.a,{flow:"col",gap:8,children:[Object(h.jsxs)(N.b,{type:"small",weight:"semibold",color:"secondary",children:[e.name," (",e.type,")"]}),/(u?int\d+)/g.test(e.type)&&Object(h.jsx)(Xn,{onAdd:function(t){var a=s[e.name];if(a){var n="0".repeat(t);s[e.name]="".concat(a).concat(n);var o=Object.values(s),r=Ln.encodeFunctionData(i,o);b.setFieldsValue({functionParams:s,functionEncodedParams:r})}}})]}),preserve:!1,rules:[{required:!0,message:"Required"}],children:Object(h.jsx)(Ca,{disabled:m.submitting,placeholder:"".concat(e.name," (").concat(e.type,")")})},"".concat(null===i||void 0===i?void 0:i.format(),":").concat(e.name))})),Object(h.jsx)(Vt.Item,{label:"Function type: ".concat(i.name),children:Object(h.jsx)(Dn,{className:wo.a.textarea,rows:5,value:l,disabled:!0})}),Object(h.jsx)(Vt.Item,{label:"Hex data",children:Object(h.jsx)(Dn,{className:wo.a.textarea,rows:5,placeholder:"Fill in the arguments above",value:d,disabled:!0})})]}),n&&o&&!r&&!c&&Object(h.jsx)(Jt,{type:"error",message:"The target address you entered is not a validated contract address. Please check the information you entered and try again"})]})}}),Object(h.jsx)(Vt.Item,{dependencies:["addValueAttribute","addFunctionCall"],noStyle:!0,children:function(e){var t=(0,e.getFieldsValue)(),a=t.addValueAttribute,n=t.addFunctionCall;return!1===a&&!1===n&&Object(h.jsx)(Jt,{type:"error",message:"You need to provide at least one: a value attribute or a function call to your action"})}}),Object(h.jsxs)("div",{className:wo.a.actions,children:[Object(h.jsx)("button",{type:"button",disabled:m.submitting,onClick:e.onCancel,className:"button-ghost-monochrome",children:a?"Cancel Changes":"Cancel"}),Object(h.jsxs)("button",{className:"button-primary",type:"submit",children:[m.submitting&&Object(h.jsx)(Tt.a,{spinning:!0}),a?"Save Changes":"Add Action"]})]})]}),m.showSimulatedActionModal&&m.simulatedAction&&Object(h.jsx)(vo,{targetAddress:m.simulatedAction.targetAddress,functionSignature:m.simulatedAction.functionSignature,functionEncodedParams:m.simulatedAction.functionEncodedParams,onOk:function(){return v(!0)},onCancel:function(){return v(!1)}})]})}))},Ao=function(e){var t=Object.assign({},e);return Object(h.jsx)(Fe.a,Object(i.a)(Object(i.a)({width:560},t),{},{children:Object(h.jsxs)("div",{className:"flex flow-row row-gap-32",children:[Object(h.jsxs)("div",{className:"flex col-gap-16 align-center",children:[Object(h.jsx)(k.a,{name:"warning-outlined",width:40,height:40,color:"red"}),Object(h.jsx)(N.b,{type:"h3",weight:"semibold",color:"primary",children:"Are you sure you want to delete the action?"})]}),Object(h.jsxs)("div",{className:"flex justify-space-between",children:[Object(h.jsx)(pe.a,{type:"default",onClick:t.onCancel,children:"Cancel"}),Object(h.jsx)(pe.a,{type:"primary",onClick:t.onOk,children:"Delete Action"})]})]})}))},Co=a(1901),_o=a.n(Co),So={hasActiveProposal:void 0,showCreateActionModal:!1,showDeleteActionModal:!1,selectedAction:void 0,submitting:!1},Vo=function(){var e=Object(c.g)(),t=M(),a=ue(),o=Object(q.c)(),s=yt.a.useForm(),l=Object(n.a)(s,1)[0],d=Object(W.a)(So),u=Object(n.a)(d,2),j=u[0],p=u[1];function m(){return(m=Object(z.a)($.a.mark((function n(o){var r,c;return $.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return p({submitting:!0}),n.prev=1,n.next=4,l.validateFields();case 4:return r=Object(i.a)({title:o.title,description:o.description},o.actions.reduce((function(e,t){return t.targetAddress?(e.targets.push(t.targetAddress),t.addFunctionCall?(e.signatures.push(t.functionSignature),e.calldatas.push(t.functionEncodedParams||"0x")):(e.signatures.push(""),e.calldatas.push("0x")),t.addValueAttribute?e.values.push(t.actionValue):e.values.push("0"),e):e}),{targets:[],signatures:[],calldatas:[],values:[]})),n.next=7,a.daoGovernance.propose(r.title,r.description,r.targets,r.values,r.signatures,r.calldatas,1);case 7:return c=n.sent,n.next=10,Object(_n.a)((function(){return t.fetchProposal(c)}),{intervalBetweenAttempts:3e3,timeout:1/0});case 10:l.resetFields(),e.push("/governance/proposals/".concat(c)),n.next=17;break;case 14:n.prev=14,n.t0=n.catch(1),console.error(n.t0);case 17:p({submitting:!1});case 18:case"end":return n.stop()}}),n,null,[[1,14]])})))).apply(this,arguments)}if(r.a.useEffect((function(){a.actions.hasActiveProposal().then((function(e){p({hasActiveProposal:e})}))}),[o.account]),!o.initialized)return null;if(!o.isActive)return Object(h.jsx)(c.a,{to:"/governance/proposals"});var O=void 0!==j.hasActiveProposal&&void 0!==a.actions.hasThreshold();if(void 0===a.isActive||!O)return null;var f=!1===j.hasActiveProposal&&!0===a.actions.hasThreshold();return a.isActive&&f?Object(h.jsxs)("div",{className:"container-limit",children:[Object(h.jsx)("div",{className:"mb-16",children:Object(h.jsxs)("button",{type:"button",onClick:function(){e.push("/governance/proposals")},className:"button-text",children:[Object(h.jsx)(k.a,{name:"arrow-back",width:16,height:16,className:"mr-8",color:"inherit"}),"Proposals"]})}),Object(h.jsx)(N.b,{type:"h1",weight:"bold",color:"primary",className:"mb-16",children:"Create Proposal"}),Object(h.jsxs)(Vt,{form:l,initialValues:{title:"",description:"",actions:[]},validateTrigger:["onSubmit","onChange"],onFinish:function(e){return m.apply(this,arguments)},children:[Object(h.jsxs)("div",{className:b()(_o.a.cardsContainer,"mb-40"),children:[Object(h.jsxs)("div",{className:"card",children:[Object(h.jsx)("div",{className:"card-header",children:Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:"Proposal description"})}),Object(h.jsxs)("div",{className:"flex flow-row row-gap-24 p-24",children:[Object(h.jsx)(Vt.Item,{name:"title",label:"Title",rules:[{required:!0,message:"Required"}],children:Object(h.jsx)(Ca,{placeholder:"Proposal title",disabled:j.submitting})}),Object(h.jsx)(Vt.Item,{name:"description",label:"Description",hint:"Be careful with the length of the description, this will eventually have to be stored on chain and the gas needed might make the proposal creation transaction more expensive.",rules:[{required:!0,message:"Required"}],children:Object(h.jsx)(Dn,{placeholder:"Please enter the goal of this proposal here",rows:6,disabled:j.submitting})})]})]}),Object(h.jsxs)("div",{className:"card",children:[Object(h.jsx)("div",{className:"card-header",children:Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:"Actions"})}),Object(h.jsx)("div",{className:"p-24",children:Object(h.jsx)(Vt.List,{name:"actions",rules:[{validator:function(e,t){return 0===t.length?Promise.reject():Promise.resolve()},message:"At least one action is required!"},{validator:function(e,t){return t.length>10?Promise.reject():Promise.resolve()},message:"Maximum 10 actions are allowed!"}],children:function(e,t,a){var n=a.errors;return Object(h.jsxs)(h.Fragment,{children:[e.map((function(e,t){var a=l.getFieldValue(["actions",t]),n=a.targetAddress,o=a.functionSignature,r=a.functionEncodedParams;return Object(h.jsx)(Vt.Item,{noStyle:!0,children:Object(h.jsx)(fo,{className:"mb-24",title:"Action ".concat(t+1),target:n,signature:o,callData:r,showSettings:!0,onDeleteAction:function(){p({showDeleteActionModal:!0,selectedAction:a})},onEditAction:function(){p({showCreateActionModal:!0,selectedAction:a})}})},e.key)})),e.length<10&&Object(h.jsx)(pe.a,{type:"ghost",icon:Object(h.jsx)(k.a,{name:"plus-circle-outlined",color:"inherit"}),disabled:j.submitting,className:_o.a.addActionBtn,onClick:function(){return p({showCreateActionModal:!0})},children:"Add new action"}),e.length>=10&&Object(h.jsx)(Jt,{type:"info",message:"Maximum 10 actions are allowed."}),Object(h.jsx)(yt.a.ErrorList,{errors:n})]})}})})]})]}),Object(h.jsx)("div",{children:Object(h.jsx)(pe.a,{type:"primary",htmlType:"submit",size:"large",loading:j.submitting,children:"Create proposal"})})]}),j.showCreateActionModal&&Object(h.jsx)(No,{edit:void 0!==j.selectedAction,actions:l.getFieldValue("actions"),initialValues:j.selectedAction,onCancel:function(){return p({showCreateActionModal:!1,selectedAction:void 0})},onSubmit:function(e){var t=l.getFieldValue("actions");j.selectedAction?t=t.map((function(t){return t===j.selectedAction?e:t})):t.push(e),l.setFieldsValue({actions:t})}}),j.showDeleteActionModal&&Object(h.jsx)(Ao,{onCancel:function(){return p({showDeleteActionModal:!1,selectedAction:void 0})},onOk:function(){var e=j.selectedAction;e&&l.setFieldsValue({actions:l.getFieldValue("actions").filter((function(t){return t!==e}))}),p({showDeleteActionModal:!1,selectedAction:void 0})}})]}):Object(h.jsx)(c.a,{to:"/governance/proposals"})},Po=a(1340),Do={minThreshold:1},Eo=r.a.createContext(Object(D.a)("ProposalProvider"));function To(){return r.a.useContext(Eo)}var Fo=function(e){var t=e.proposalId,a=e.children,o=Object(c.g)(),s=Object(q.c)(),l=M(),d=ue(),u=Object(Pe.a)(),b=Object(n.a)(u,2),j=b[0],p=b[1],m=Object(W.a)(Do),O=Object(n.a)(m,2),f=O[0],g=O[1];return r.a.useEffect((function(){t?l.fetchProposal(t).then((function(e){g({proposal:e})})).catch((function(e){404===e?Po.a.error({message:"Proposal with id=".concat(t," doesn't exist.")}):Po.a.error({message:"Failed to fetch proposal with id=".concat(t,". (Status: ").concat(e,")")}),o.push("/governance/proposals")})):g({proposal:void 0})}),[t,p]),r.a.useEffect((function(){if(g({forRate:void 0,againstRate:void 0,quorum:void 0,isCanceled:void 0}),f.proposal){var e=f.proposal,t=e.forVotes,a=e.againstVotes,n=e.createTime,o=e.warmUpDuration,r=t.plus(a),c=0,i=0;r.gt(C.a.ZERO)&&(c=t.multipliedBy(100).div(r).toNumber(),i=a.multipliedBy(100).div(r).toNumber()),g({forRate:c,againstRate:i}),d.daoBarn.getBondStakedAtTs(n+o).then((function(e){var t;null!==e&&void 0!==e&&e.gt(C.a.ZERO)&&(t=r.multipliedBy(100).div(e).toNumber()),g({quorum:t})})),d.daoGovernance.getAbrogationProposals(f.proposal.proposalId).then((function(e){e&&g({isCanceled:e.createTime>0})}))}}),[f.proposal]),r.a.useEffect((function(){g({thresholdRate:void 0});var e=d.daoBarn.bondStaked;if(f.proposal&&e&&!e.isEqualTo(C.a.ZERO)){var t=f.proposal.proposer;d.daoBarn.getVotingPower(t).then((function(t){t&&g({thresholdRate:t.div(e).multipliedBy(100).toNumber()})}))}}),[f.proposal,d.daoBarn.bondStaked]),r.a.useEffect((function(){if(g({receipt:void 0,votingPower:void 0}),f.proposal&&s.isActive){var e=f.proposal,t=e.createTime,a=e.warmUpDuration;d.daoGovernance.getReceipt(f.proposal.proposalId,s.account).then((function(e){g({receipt:e})})),d.daoBarn.getVotingPowerAtTs(s.account,t+a).then((function(e){g({votingPower:e})}))}}),[f.proposal,s.account]),Object(h.jsx)(Eo.Provider,{value:Object(i.a)(Object(i.a)({},f),{},{reload:j,cancelProposal:function(){return t?d.daoGovernance.cancelProposal(t).then((function(){return j()})):Promise.reject()},queueProposalForExecution:function(e){return t?d.daoGovernance.queue(t,e).then((function(){return j()})):Promise.reject()},executeProposal:function(){return t?d.daoGovernance.execute(t).then((function(){return j()})):Promise.reject()},proposalCastVote:function(e,a){return t?d.daoGovernance.castVote(t,e,a).then((function(){return j()})):Promise.reject()},proposalCancelVote:function(e){return t?d.daoGovernance.cancelVote(t,e).then((function(){return j()})):Promise.reject()},startAbrogationProposal:function(e,a){return t?d.daoGovernance.startAbrogationProposal(t,e,a).then((function(){return j()})):Promise.reject()}}),children:a})},Ro={acceptanceThreshold:50},Io=r.a.createContext(Object(D.a)("AbrogationProvider"));function Bo(){return r.a.useContext(Io)}var Uo=function(e){var t=e.children,a=Object(c.g)(),o=Object(Pe.a)(),s=Object(n.a)(o,2),l=s[0],d=s[1],u=Object(q.c)(),b=M(),j=ue(),p=To().proposal,m=Object(W.a)(Ro),O=Object(n.a)(m,2),f=O[0],g=O[1];return r.a.useEffect((function(){p?b.fetchAbrogation(p.proposalId).then((function(e){g({abrogation:e})})).catch((function(e){404===e?Po.a.error({message:"Proposal with id=".concat(p.proposalId," doesn't exist.")}):Po.a.error({message:"Failed to fetch proposal with id=".concat(p.proposalId,". (Status: ").concat(e,")")}),a.push("/governance/proposals/".concat(p.proposalId))})):g({abrogation:void 0})}),[p,d]),r.a.useEffect((function(){if(g({forRate:void 0,againstRate:void 0}),f.abrogation){var e=f.abrogation,t=e.forVotes,a=e.againstVotes,n=e.createTime,o=t.plus(a),r=0,c=0;o.gt(C.a.ZERO)&&(r=t.multipliedBy(100).div(o).toNumber(),c=a.multipliedBy(100).div(o).toNumber()),g({forRate:r,againstRate:c}),j.daoBarn.getBondStakedAtTs(n-1).then((function(e){var a;null!==e&&void 0!==e&&e.gt(C.a.ZERO)&&(a=t.multipliedBy(100).div(e).toNumber(),a=Math.min(a,100)),g({approvalRate:a})}))}}),[f.abrogation]),r.a.useEffect((function(){if(g({approvalRate:void 0}),f.abrogation&&u.account){var e=f.abrogation,t=e.proposalId,a=e.createTime;j.daoBarn.getVotingPowerAtTs(u.account,a-1).then((function(e){g({votingPower:e})})),j.daoGovernance.getAbrogationProposalReceipt(t,u.account).then((function(e){g({receipt:e})}))}}),[f.abrogation,u.account]),Object(h.jsx)(Io.Provider,{value:Object(i.a)(Object(i.a)({},f),{},{reload:l,abrogationProposalCastVote:function(e,t){return null!==p&&void 0!==p&&p.proposalId?j.daoGovernance.abrogationProposalCastVote(null===p||void 0===p?void 0:p.proposalId,e,t).then((function(){return l()})):Promise.reject()},abrogationProposalCancelVote:function(e){return null!==p&&void 0!==p&&p.proposalId?j.daoGovernance.abrogationProposalCancelVote(null===p||void 0===p?void 0:p.proposalId,e).then((function(){return l()})):Promise.reject()}}),children:t})},Mo=function(){var e,t,a,n=Bo(),o=(null!==(e=n.approvalRate)&&void 0!==e?e:0)>=(null!==(t=n.acceptanceThreshold)&&void 0!==t?t:0);return Object(h.jsxs)("div",{className:"card",children:[Object(h.jsx)("div",{className:"card-header",children:Object(h.jsx)(N.a,{text:"Approval is the percentage of votes on a proposal that the total support must be greater than for the proposal to be approved. For example, if \u201cApproval\u201d is set to 51%, then more than 51% of the votes on a proposal must vote \u201cYes\u201d for the proposal to pass.",children:Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:"Abrogation proposal approval"})})}),Object(h.jsxs)(y.a,{className:"p-24",flow:"row",gap:16,children:[Object(h.jsxs)(y.a,{flow:"col",gap:8,children:[Object(h.jsxs)(N.b,{type:"p1",weight:"semibold",color:"primary",children:[null===(a=n.approvalRate)||void 0===a?void 0:a.toFixed(2),"%"]}),Object(h.jsxs)(N.b,{type:"p1",color:"secondary",children:["(> ",n.acceptanceThreshold,"% required)"]})]}),Object(h.jsx)(Ke,{percent:n.approvalRate,acceptance:n.acceptanceThreshold,strokeColor:o?"var(--theme-green-color)":"var(--theme-red-color)",trailColor:o?"rgba(var(--theme-green-color-rgb), .16)":"rgba(var(--theme-red-color-rgb), .16)"})]})]})},Lo=function(){var e,t,a,n,o=Bo();return Object(h.jsxs)("div",{className:"card",children:[Object(h.jsx)("div",{className:"card-header",children:Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:"Details"})}),Object(h.jsx)(y.a,{flow:"col",gap:32,justify:"space-between",padding:24,children:Object(h.jsx)(y.a,{flow:"col",gap:32,children:Object(h.jsxs)(y.a,{flow:"row",gap:4,children:[Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"secondary",children:"Created by"}),Object(h.jsxs)(y.a,{flow:"col",gap:8,children:[Object(h.jsx)(ot.a,{address:null===(e=o.abrogation)||void 0===e?void 0:e.caller,width:24,height:24}),Object(h.jsx)(w.b,{address:null===(t=o.abrogation)||void 0===t?void 0:t.caller,children:Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"blue",children:Object(V.f)(null===(a=o.abrogation)||void 0===a?void 0:a.caller)})})]})]})})}),Object(h.jsx)(ve,{}),Object(h.jsxs)(y.a,{flow:"row",gap:16,padding:24,children:[Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"secondary",children:"Description"}),Object(h.jsx)(N.b,{type:"p1",color:"primary",wrap:!0,children:null===(n=o.abrogation)||void 0===n?void 0:n.description})]})]})},qo={votes:[],total:0,page:1,pageSize:10,loading:!1,supportFilter:void 0},Go=r.a.createContext(Object(D.a)("AbrogationVotersProvider"));var Yo,Wo=function(e){var t=e.children,a=M(),o=Bo().abrogation,c=Object(W.a)(qo),s=Object(n.a)(c,2),l=s[0],d=s[1];return r.a.useEffect((function(){o?(d({loading:!0}),a.fetchAbrogationVoters(o.proposalId,l.page,l.pageSize,l.supportFilter).then((function(e){d({loading:!1,votes:e.data,total:e.meta.count})})).catch((function(){d({loading:!1,votes:[]})}))):d({votes:[],total:0})}),[o,l.page,l.supportFilter]),Object(h.jsx)(Go.Provider,{value:Object(i.a)(Object(i.a)({},l),{},{changeSupportFilter:function(e){d({supportFilter:e,page:1})},changePage:function(e){d({page:e})}}),children:t})},zo=a(1902),Qo=a.n(zo),Zo=[{title:"Address",dataIndex:"address",width:"35%",render:function(e){return Object(h.jsxs)(y.a,{flow:"col",gap:8,align:"center",children:[Object(h.jsx)(ot.a,{address:e,width:32,height:32}),Object(h.jsx)(w.b,{address:e,children:Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"blue",children:Object(V.f)(e)})})]})}},{title:"Votes",dataIndex:"power",width:"38%",align:"right",render:function(e){return Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",className:Qo.a.powerCell,children:Object(V.a)(e,0)})}},{title:"Vote type",dataIndex:"support",width:"27%",render:function(e){return e?Object(h.jsx)(N.b,{type:"lb2",weight:"semibold",className:Qo.a.forTag,children:"For"}):Object(h.jsx)(N.b,{type:"lb2",weight:"semibold",className:Qo.a.againstTag,children:"Against"})}}],Ho=function(e){var t=Object.assign({},e),a=r.a.useContext(Go);return Object(h.jsxs)(Fe.a,Object(i.a)(Object(i.a)({className:Qo.a.component,width:620},t),{},{children:[Object(h.jsxs)(x,{className:Qo.a.tabs,defaultActiveKey:"all",onChange:function(e){"for"===e?a.changeSupportFilter(!0):"against"===e?a.changeSupportFilter(!1):a.changeSupportFilter(void 0)},children:[Object(h.jsx)(x.Tab,{tab:"All Votes"},"all"),Object(h.jsx)(x.Tab,{tab:"For"},"for"),Object(h.jsx)(x.Tab,{tab:"Against"},"against")]}),Object(h.jsx)(nt,{className:Qo.a.table,columns:Zo,dataSource:a.votes,rowKey:"address",loading:a.loading,locale:{emptyText:"No votes"},pagination:{total:a.total,current:a.page,pageSize:a.pageSize,position:["bottomRight"],showTotal:function(e,t){var a=Object(n.a)(t,2),o=a[0],r=a[1];return Object(h.jsxs)(N.b,{type:"p2",weight:"semibold",color:"secondary",children:["Showing ",o," to ",r," out of ",e," votes"]})},onChange:function(e){a.changePage(e)}}})]}))},Ko=function(e){return Object(h.jsx)(Wo,{children:Object(h.jsx)(Ho,Object(i.a)({},e))})},Xo=function(){var e,t,a,o,c,i=Bo(),s=r.a.useState(!1),l=Object(n.a)(s,2),d=l[0],u=l[1];return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("div",{className:"card",children:[Object(h.jsxs)("div",{className:"card-header flex justify-space-between",children:[Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:"Vote results"}),Object(h.jsx)(pe.a,{type:"link",onClick:function(){return u(!0)},children:"View voters"})]}),Object(h.jsxs)(y.a,{className:"card-row p-24",flow:"row",children:[Object(h.jsxs)(y.a,{flow:"col",justify:"space-between",children:[Object(h.jsxs)(y.a,{flow:"row",gap:4,children:[Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"secondary",children:"For"}),Object(h.jsxs)(y.a,{flow:"col",gap:8,children:[Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:null===(e=i.abrogation)||void 0===e?void 0:e.forVotes.toFormat(2)}),Object(h.jsxs)(N.b,{type:"p1",color:"secondary",children:["(",null===(t=i.forRate)||void 0===t?void 0:t.toFixed(2),"%)"]})]})]}),Object(h.jsxs)(y.a,{flow:"row",gap:4,align:"end",children:[Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"secondary",align:"right",children:"Against"}),Object(h.jsxs)(y.a,{flow:"col",gap:8,children:[Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:null===(a=i.abrogation)||void 0===a?void 0:a.againstVotes.toFormat(2)}),Object(h.jsxs)(N.b,{type:"p1",color:"secondary",children:["(",null===(o=i.againstRate)||void 0===o?void 0:o.toFixed(2),"%)"]})]})]})]}),Object(h.jsx)(Ke,{percent:i.forRate,strokeColor:"var(--theme-green-color)",trailColor:"var(--theme-red-color)"})]}),Object(h.jsx)(y.a,{className:"card-row p-24",flow:"row",children:Object(h.jsxs)(y.a,{flow:"col",justify:"space-between",children:[Object(h.jsx)("div",{}),Object(h.jsxs)(y.a,{flow:"row",gap:4,align:"end",children:[Object(h.jsx)(N.a,{text:"Approval is the percentage of votes on a proposal that the total support must be greater than for the proposal to be approved. For example, if \u201cApproval\u201d is set to 51%, then more than 51% of the votes on a proposal must vote \u201cYes\u201d for the proposal to pass.",children:Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"secondary",align:"right",children:"Approval"})}),Object(h.jsxs)(y.a,{flow:"col",gap:8,children:[Object(h.jsxs)(N.b,{type:"p1",weight:"semibold",color:"primary",children:[null===(c=i.forRate)||void 0===c?void 0:c.toFixed(2),"%"]}),Object(h.jsxs)(N.b,{type:"p1",color:"secondary",children:["(> ",i.acceptanceThreshold,"% required)"]})]})]})]})})]}),d&&Object(h.jsx)(Ko,{onCancel:function(){return u(!1)}})]})},$o=a(1903),Jo=a.n($o),er=["voteState"];!function(e){e[e.None=0]="None",e[e.VoteInitiate=1]="VoteInitiate",e[e.VoteFor=2]="VoteFor",e[e.VoteAgainst=3]="VoteAgainst",e[e.VoteChange=4]="VoteChange",e[e.VoteCancel=5]="VoteCancel"}(Yo||(Yo={}));var tr={changeOption:void 0,description:void 0,gasPrice:void 0},ar={submitting:!1},nr=function(e){var t,a,o,c,l=e.voteState,d=Object(s.a)(e,er),u=To(),b=Bo(),j=Object(W.a)(ar),p=Object(n.a)(j,2),m=p[0],O=p[1],f=yt.a.useForm(),g=Object(n.a)(f,1)[0];function v(){return(v=Object(z.a)($.a.mark((function t(a){var n,o,r;return $.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(l===Yo.VoteInitiate||b.abrogation){t.next=2;break}return t.abrupt("return");case 2:if(n=a.gasPrice){t.next=5;break}return t.abrupt("return");case 5:return O({submitting:!0}),t.prev=6,t.next=9,g.validateFields();case 9:if(l!==Yo.VoteInitiate){t.next=14;break}return t.next=12,u.startAbrogationProposal(null!==(r=a.description)&&void 0!==r?r:"",n.value);case 12:t.next=32;break;case 14:if(l!==Yo.VoteFor){t.next=19;break}return t.next=17,b.abrogationProposalCastVote(!0,n.value);case 17:t.next=32;break;case 19:if(l!==Yo.VoteAgainst){t.next=24;break}return t.next=22,b.abrogationProposalCastVote(!1,n.value);case 22:t.next=32;break;case 24:if(l!==Yo.VoteChange){t.next=29;break}return t.next=27,b.abrogationProposalCastVote(!0===a.changeOption,n.value);case 27:t.next=32;break;case 29:if(l!==Yo.VoteCancel){t.next=32;break}return t.next=32,b.abrogationProposalCancelVote(n.value);case 32:null===(o=e.onCancel)||void 0===o||o.call(e),t.next=37;break;case 35:t.prev=35,t.t0=t.catch(6);case 37:O({submitting:!1});case 38:case"end":return t.stop()}}),t,null,[[6,35]])})))).apply(this,arguments)}return r.a.useEffect((function(){var e;l===Yo.VoteChange&&g.setFieldsValue({changeOption:null===(e=b.receipt)||void 0===e?void 0:e.support})}),[l,b.receipt]),Object(h.jsx)(Fe.a,Object(i.a)(Object(i.a)({className:Jo.a.component,width:560,title:Object(h.jsxs)(h.Fragment,{children:[l===Yo.VoteInitiate&&"Initiate abrogation proposal",l===Yo.VoteFor&&"Confirm your vote",l===Yo.VoteAgainst&&"Confirm your vote",l===Yo.VoteChange&&"Change your vote",l===Yo.VoteCancel&&"Cancel your vote"]})},d),{},{children:Object(h.jsxs)(Vt,{form:g,initialValues:tr,validateTrigger:["onSubmit","onChange"],onFinish:function(e){return v.apply(this,arguments)},children:[l===Yo.VoteInitiate&&Object(h.jsx)(y.a,{flow:"row",gap:16,padding:32,children:Object(h.jsx)(N.b,{type:"p2",weight:"semibold",color:"secondary",children:null===(t=u.proposal)||void 0===t?void 0:t.title})}),l!==Yo.VoteInitiate&&Object(h.jsxs)(y.a,{flow:"row",gap:16,className:Jo.a.row,children:[Object(h.jsxs)(y.a,{flow:"col",gap:8,align:"center",children:[Object(h.jsx)(N.b,{type:"h2",weight:"bold",color:"primary",children:Object(V.a)(u.votingPower,2)}),Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"secondary",children:"Votes"})]}),(l===Yo.VoteFor||l===Yo.VoteAgainst)&&Object(h.jsxs)(y.a,{flow:"row",gap:8,children:[Object(h.jsxs)(N.b,{type:"p2",color:"secondary",children:["You are about to vote ",l===Yo.VoteFor?"FOR":"AGAINST"," the abrogation proposal for"]}),Object(h.jsxs)(N.b,{type:"p2",weight:"semibold",color:"secondary",children:["\u201c",null===(a=u.proposal)||void 0===a?void 0:a.title,"\u201d"]}),Object(h.jsx)(N.b,{type:"p2",color:"secondary",children:"You can change your vote later."})]}),l===Yo.VoteChange&&Object(h.jsxs)(y.a,{flow:"row",gap:8,children:[Object(h.jsx)(N.b,{type:"p2",color:"secondary",children:"You are about to change your vote on the abrogation proposal for"}),Object(h.jsxs)(N.b,{type:"p2",weight:"semibold",color:"secondary",children:["\u201c",null===(o=u.proposal)||void 0===o?void 0:o.title,"\u201d"]}),Object(h.jsx)(N.b,{type:"p2",color:"secondary",children:"Are you sure you want to continue? You can change your vote again later."})]}),l===Yo.VoteCancel&&Object(h.jsxs)(y.a,{flow:"row",gap:8,children:[Object(h.jsx)(N.b,{type:"p2",color:"secondary",children:"You are about to cancel your vote on the abrogation proposal for"}),Object(h.jsxs)(N.b,{type:"p2",weight:"semibold",color:"secondary",children:["\u201c",null===(c=u.proposal)||void 0===c?void 0:c.title,"&dquo;"]}),Object(h.jsx)(N.b,{type:"p2",color:"secondary",children:"Are you sure you want to continue? You can change your vote again later."})]})]}),Object(h.jsx)(ve,{}),Object(h.jsxs)(y.a,{flow:"row",gap:32,className:Jo.a.row,children:[l===Yo.VoteInitiate&&Object(h.jsx)(Vt.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Required"}],children:Object(h.jsx)(Dn,{placeholder:"Placeholder",rows:4,disabled:m.submitting})}),l===Yo.VoteChange&&Object(h.jsx)(Vt.Item,{name:"changeOption",label:"Vote",rules:[{required:!0,message:"Required"}],children:Object(h.jsx)(Dt.a.Group,{className:Jo.a.changeGroup,disabled:m.submitting,children:Object(h.jsxs)(y.a,{gap:16,colsTemplate:"1fr 1fr",children:[Object(h.jsx)(Bt,{label:Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:"For"}),value:!0}),Object(h.jsx)(Bt,{label:Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:"Against"}),value:!1})]})})}),Object(h.jsx)(Vt.Item,{name:"gasPrice",label:"Gas Fee (Gwei)",rules:[{required:!0,message:"Required"}],children:Object(h.jsx)(Gt,{disabled:m.submitting})}),Object(h.jsx)(Vt.Item,{shouldUpdate:!0,children:function(e){var t,a=(0,e.getFieldsValue)().changeOption,n=!1;l===Yo.VoteChange&&((null===(t=b.receipt)||void 0===t?void 0:t.support)===a&&(n=!0));return Object(h.jsxs)(pe.a,{htmlType:"submit",type:"primary",loading:m.submitting,disabled:n,className:Jo.a.actionBtn,children:[l===Yo.VoteInitiate&&"Initiate abrogation proposal",l===Yo.VoteFor&&"Vote for abrogation proposal",l===Yo.VoteAgainst&&"Vote against abrogation proposal",l===Yo.VoteChange&&!0===a&&"Vote for abrogation proposal",l===Yo.VoteChange&&!1===a&&"Vote against abrogation proposal",l===Yo.VoteCancel&&"Cancel abrogation vote"]})}})]})]})}))},or={showVotersModal:!1,showVoteModal:!1,voteState:Yo.None},rr=function(){var e,t,a,o,r,c,i=Bo(),s=Object(W.a)(or),l=Object(n.a)(s,2),d=l[0],u=l[1];return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("div",{className:"card",children:[Object(h.jsxs)("div",{className:"card-header flex justify-space-between",children:[Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:"Abrogation proposal votes"}),Object(h.jsx)(pe.a,{type:"link",onClick:function(){u({showVotersModal:!0})},children:"View voters"})]}),Object(h.jsxs)(y.a,{className:"card-row p-24",flow:"row",gap:32,children:[Object(h.jsxs)(y.a,{flow:"row",gap:16,children:[Object(h.jsxs)(y.a,{flow:"col",justify:"space-between",children:[Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:"For"}),Object(h.jsxs)(y.a,{flow:"col",gap:8,children:[Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:null===(e=i.abrogation)||void 0===e?void 0:e.forVotes.toFormat(2)}),Object(h.jsxs)(N.b,{type:"p1",color:"secondary",children:["(",null===(t=i.forRate)||void 0===t?void 0:t.toFixed(2),"%)"]})]})]}),Object(h.jsx)(Ke,{percent:i.forRate,strokeColor:"var(--theme-green-color)",trailColor:"rgba(var(--theme-green-color-rgb), .16)"})]}),Object(h.jsxs)(y.a,{flow:"row",gap:16,children:[Object(h.jsxs)(y.a,{flow:"col",justify:"space-between",children:[Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:"Against"}),Object(h.jsxs)(y.a,{flow:"col",gap:8,children:[Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:null===(a=i.abrogation)||void 0===a?void 0:a.againstVotes.toFormat(2)}),Object(h.jsxs)(N.b,{type:"p1",color:"secondary",children:["(",null===(o=i.againstRate)||void 0===o?void 0:o.toFixed(2),"%)"]})]})]}),Object(h.jsx)(Ke,{percent:i.againstRate,strokeColor:"var(--theme-red-color)",trailColor:"rgba(var(--theme-red-color-rgb), .16)"})]})]}),Object(h.jsxs)(y.a,{className:"card-row p-24",flow:"row",gap:24,children:[Object(h.jsxs)(y.a,{flow:"row",gap:8,children:[Object(h.jsx)(N.b,{type:"p1",color:"secondary",children:"Your voting power for this proposal"}),Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:Object(V.a)(i.votingPower,2)})]}),Object(h.jsx)(y.a,{flow:"row",gap:24,children:null!==(r=i.receipt)&&void 0!==r&&r.hasVoted?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(Jt,{message:"You already voted ".concat(null!==(c=i.receipt)&&void 0!==c&&c.support?"FOR":"AGAINST"," the proposal abrogation")}),Object(h.jsxs)(y.a,{flow:"col",gap:24,colsTemplate:"1fr 1fr",children:[Object(h.jsx)(pe.a,{type:"primary",onClick:function(){u({showVoteModal:!0,voteState:Yo.VoteChange})},children:"Change vote"}),Object(h.jsx)(pe.a,{type:"default",onClick:function(){u({showVoteModal:!0,voteState:Yo.VoteCancel})},children:"Cancel vote"})]})]}):Object(h.jsxs)(y.a,{gap:24,colsTemplate:"1fr 1fr",children:[Object(h.jsx)(pe.a,{type:"primary",onClick:function(){u({showVoteModal:!0,voteState:Yo.VoteFor})},children:"Vote for"}),Object(h.jsx)(pe.a,{type:"default",onClick:function(){u({showVoteModal:!0,voteState:Yo.VoteAgainst})},children:"Vote against"})]})})]})]}),d.showVotersModal&&Object(h.jsx)(Ko,{onCancel:function(){u({showVotersModal:!1})}}),d.showVoteModal&&Object(h.jsx)(nr,{voteState:d.voteState,onCancel:function(){u({showVoteModal:!1,voteState:Yo.None})}})]})},cr=a(1904),ir=a.n(cr),sr=function(e){var t,a,n,o,r=To();return Object(h.jsx)(Fe.a,Object(i.a)(Object(i.a)({className:ir.a.component},e),{},{children:Object(h.jsxs)(y.a,{flow:"row",gap:16,align:"center",children:[Object(h.jsxs)(y.a,{flow:"col",gap:8,align:"start",width:1070,children:[Object(h.jsx)(k.a,{name:"warning-outlined"}),Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"red",children:"Abrogation proposal"})]}),Object(h.jsxs)(y.a,{flow:"row",gap:64,align:"center",children:[Object(h.jsx)(y.a,{flow:"col",gap:32,colsTemplate:"1fr 1fr",width:1070,children:Object(h.jsxs)(N.b,{type:"h2",weight:"semibold",color:"primary",children:["PID-",null===(t=r.proposal)||void 0===t?void 0:t.proposalId,": ",null===(a=r.proposal)||void 0===a?void 0:a.title]})}),Object(h.jsxs)(y.a,{flow:"col",gap:32,colsTemplate:"minmax(0, 610px) minmax(0, 428px)",width:1070,children:[Object(h.jsxs)(y.a,{flow:"row",gap:32,children:[(null===(n=r.proposal)||void 0===n?void 0:n.state)!==g.QUEUED&&Object(h.jsx)(Xo,{}),Object(h.jsx)(Lo,{})]}),Object(h.jsx)(y.a,{flow:"row",gap:32,children:(null===(o=r.proposal)||void 0===o?void 0:o.state)===g.QUEUED&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(rr,{}),Object(h.jsx)(Mo,{})]})})]})]})]})}))},lr=function(e){return Object(h.jsx)(Uo,{children:Object(h.jsx)(sr,Object(i.a)({},e))})},dr={abrogationVoteModal:!1,abrogationViewModal:!1,showWhyReason:!1,cancelling:!1},ur=function(){var e,t=ue(),a=To(),o=Object(W.a)(dr),r=Object(n.a)(o,2),c=r[0],i=r[1],s=!!t.thresholdRate&&t.thresholdRate>=t.minThreshold;return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("div",{className:"card",children:[Object(h.jsx)("div",{className:"card-header",children:Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:"Abrogation proposal"})}),Object(h.jsxs)("div",{className:"p-24",children:[void 0===a.isCanceled&&Object(h.jsx)(y.a,{flow:"col",justify:"center",children:Object(h.jsx)(Tt.a,{spinning:!0})}),!1===a.isCanceled&&Object(h.jsxs)(y.a,{flow:"row",gap:24,children:[Object(h.jsx)(N.b,{type:"p1",color:"primary",children:"This is a special type of proposal, with the following thresholds:"}),Object(h.jsxs)("ul",{children:[Object(h.jsx)("li",{children:Object(h.jsx)(N.b,{type:"p1",color:"primary",children:"Acceptance criteria: 50% of staked BOND"})}),Object(h.jsx)("li",{children:Object(h.jsx)(N.b,{type:"p1",color:"primary",children:"A proposal can only have one associated abrogation proposal at any given time"})}),Object(h.jsx)("li",{children:Object(h.jsx)(N.b,{type:"p1",color:"primary",children:"Anyone can vote on these proposals"})}),Object(h.jsx)("li",{children:Object(h.jsx)(N.b,{type:"p1",color:"primary",children:"There is a new snapshot for voter balances - taken at Abrogation Proposal\u2019s start time"})}),Object(h.jsx)("li",{children:Object(h.jsx)(N.b,{type:"p1",color:"primary",children:"Abrogation Proposal\u2019s duration is never greater than the Initial Proposal\u2019s queue period"})}),Object(h.jsx)("li",{children:Object(h.jsx)(N.b,{type:"p1",color:"primary",children:"When someone goes to execute the Initial Proposal - there is a check if an Abrogation Proposal that met its acceptance criteria exists"})})]}),Object(h.jsxs)(y.a,{flow:"row",gap:8,align:"center",justify:"end",children:[Object(h.jsx)(pe.a,{type:"default",loading:c.cancelling,disabled:!s,onClick:function(){return i({abrogationVoteModal:!0})},children:"Initiate abrogation proposal"}),!s&&Object(h.jsxs)(y.a,{flow:"col",gap:8,align:"center",children:[Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"secondary",children:"You are not able to abrogate proposal."}),Object(h.jsx)(Hn.a,{title:"Why you can\u2019t abrogate proposal",placement:"bottomLeft",overlayStyle:{width:520},content:Object(h.jsxs)(N.b,{type:"p2",weight:"semibold",children:["You don\u2019t have enough voting power to create an abrogation proposal. The creator of an abrogation proposal needs to have a voting power of at least ",t.minThreshold,"% of the amount of $BOND staked in the DAO."]}),visible:c.showWhyReason,onVisibleChange:function(e){return i({showWhyReason:e})},children:Object(h.jsx)(pe.a,{type:"link",children:"See why"})})]})]})]}),!0===a.isCanceled&&Object(h.jsxs)(y.a,{flow:"row",gap:24,children:[(null===(e=a.proposal)||void 0===e?void 0:e.state)===g.QUEUED&&Object(h.jsx)(N.b,{type:"p1",color:"primary",children:"Abrogation proposal currently in progress."}),Object(h.jsx)(pe.a,{type:"primary",onClick:function(){return i({abrogationViewModal:!0})},children:"View abrogation proposal"})]})]})]}),c.abrogationVoteModal&&Object(h.jsx)(nr,{voteState:Yo.VoteInitiate,onCancel:function(){return i({abrogationVoteModal:!1})}}),c.abrogationViewModal&&Object(h.jsx)(lr,{onCancel:function(){return i({abrogationViewModal:!1})}})]})},br=function(){var e,t,a,n,o,r,c=To(),i=(null!==(e=c.forRate)&&void 0!==e?e:0)>=(null!==(t=null===(a=c.proposal)||void 0===a?void 0:a.acceptanceThreshold)&&void 0!==t?t:0);return Object(h.jsxs)("div",{className:"card",children:[Object(h.jsx)("div",{className:"card-header",children:Object(h.jsx)(N.a,{text:"Approval is the percentage of votes on a proposal that the total support must be greater than for the proposal to be approved. For example, if \u201cApproval\u201d is set to 51%, then more than 51% of the votes on a proposal must vote \u201cYes\u201d for the proposal to pass.",children:Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:"Approval"})})}),Object(h.jsxs)(y.a,{className:"p-24",flow:"row",gap:16,children:[Object(h.jsxs)(y.a,{flow:"col",gap:8,children:[Object(h.jsxs)(N.b,{type:"p1",weight:"semibold",color:"primary",children:[null===(n=c.forRate)||void 0===n?void 0:n.toFixed(2),"%"]}),Object(h.jsxs)(N.b,{type:"p1",color:"secondary",children:["(> ",null===(o=c.proposal)||void 0===o?void 0:o.acceptanceThreshold,"% required)"]})]}),Object(h.jsx)(Ke,{percent:c.forRate,acceptance:null===(r=c.proposal)||void 0===r?void 0:r.acceptanceThreshold,strokeColor:i?"var(--theme-green-color)":"var(--theme-red-color)",trailColor:i?"rgba(var(--theme-green-color-rgb), .16)":"rgba(var(--theme-red-color-rgb), .16)"})]})]})},jr={cancelling:!1},pr=function(){var e,t,a,o=Object(q.c)(),c=To(),s=c.proposal,l=c.thresholdRate,d=c.minThreshold,u=r.a.useState(jr),b=Object(n.a)(u,2),j=b[0],p=b[1],m=(null===s||void 0===s?void 0:s.proposer)===o.account,O=void 0!==l&&l<d,f=[g.WARMUP,g.ACTIVE].includes(null===s||void 0===s?void 0:s.state)&&(m||O);return Object(h.jsxs)("div",{className:"card",children:[Object(h.jsx)("div",{className:"card-header",children:Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:"Details"})}),Object(h.jsxs)("div",{className:"card-row flexbox-list p-24",style:{"--gap":"32px"},children:[Object(h.jsxs)("div",{children:[Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"secondary",className:"mb-4",children:"Created by"}),Object(h.jsxs)(y.a,{flow:"col",gap:8,children:[Object(h.jsx)(ot.a,{address:null===(e=c.proposal)||void 0===e?void 0:e.proposer,width:24,height:24}),Object(h.jsx)(w.b,{address:null===(t=c.proposal)||void 0===t?void 0:t.proposer,children:Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"blue",children:Object(V.f)(null===(a=c.proposal)||void 0===a?void 0:a.proposer)})})]})]}),Object(h.jsxs)("div",{children:[Object(h.jsx)(N.a,{text:"If the creator\u2019s vBOND balance falls below ".concat(d,"% of the total amount of $BOND staked in the DAO the proposal can be cancelled by anyone."),children:Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"secondary",className:"mb-4",children:"Creator threshold"})}),Object(h.jsx)(y.a,{flow:"col",gap:8,children:void 0!==l&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(k.a,{name:O?"close-circle-outlined":"check-circle-outlined"}),Object(h.jsx)(Ae,{loading:void 0===s,children:Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:O?"Below 1%":"Above 1%"})})]})})]}),Object(h.jsx)("div",{children:f&&Object(h.jsx)(pe.a,{type:"default",loading:j.cancelling,onClick:function(){p((function(e){return Object(i.a)(Object(i.a)({},e),{},{cancelling:!0})})),c.cancelProposal().then((function(){p((function(e){return Object(i.a)(Object(i.a)({},e),{},{cancelling:!1})}))})).catch((function(){p((function(e){return Object(i.a)(Object(i.a)({},e),{},{cancelling:!1})}))}))},children:"Cancel proposal"})})]}),Object(h.jsxs)(y.a,{className:"card-row p-24",flow:"row",gap:16,children:[Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"secondary",children:"Description"}),Object(h.jsx)(N.b,{type:"p1",color:"primary",wrap:!0,children:null===s||void 0===s?void 0:s.description})]}),Object(h.jsxs)(y.a,{className:"card-row p-24",flow:"row",gap:16,children:[Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"secondary",children:"Actions"}),null===s||void 0===s?void 0:s.targets.map((function(e,t){return Object(h.jsx)(fo,{title:"Action ".concat(t+1),target:null===s||void 0===s?void 0:s.targets[t],signature:null===s||void 0===s?void 0:s.signatures[t],callData:null===s||void 0===s?void 0:s.calldatas[t]},t)}))]})]})},hr=function(){var e,t,a,n,o,r,c=To(),i=(null!==(e=c.quorum)&&void 0!==e?e:0)>=(null!==(t=null===(a=c.proposal)||void 0===a?void 0:a.minQuorum)&&void 0!==t?t:0);return Object(h.jsxs)("div",{className:"card",children:[Object(h.jsx)("div",{className:"card-header",children:Object(h.jsx)(N.a,{text:"Quorum is the percentage of the amount of tokens staked in the DAO that support for a proposal must be greater than for the proposal to be considered valid. For example, if the Quorum % is set to 20%, then more than 20% of the amount of tokens staked in the DAO must vote to approve a proposal for the vote to be considered valid.",children:Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:"Quorum"})})}),Object(h.jsxs)(y.a,{className:"p-24",flow:"row",gap:16,children:[Object(h.jsxs)(y.a,{flow:"col",gap:8,children:[Object(h.jsxs)(N.b,{type:"p1",weight:"semibold",color:"primary",children:[null===(n=c.quorum)||void 0===n?void 0:n.toFixed(2),"%"]}),Object(h.jsxs)(N.b,{type:"p1",color:"secondary",children:["(> ",null===(o=c.proposal)||void 0===o?void 0:o.minQuorum,"% required)"]})]}),Object(h.jsx)(Ke,{percent:c.quorum,acceptance:null===(r=c.proposal)||void 0===r?void 0:r.minQuorum,strokeColor:i?"var(--theme-green-color)":"var(--theme-red-color)",trailColor:i?"rgba(var(--theme-green-color-rgb), .16)":"rgba(var(--theme-red-color-rgb), .16)"})]})]})},mr=a(147),Or=a(278);function fr(e,t){return[g.EXPIRED,g.FAILED,g.CANCELED,g.ABROGATED].includes(t)?Object(h.jsx)(k.a,{name:"close-circle-outlined",width:40,height:40,color:"red"}):[g.CREATED,g.ACCEPTED,g.EXECUTED].includes(t)?Object(h.jsx)(k.a,{name:"check-circle-outlined",width:40,height:40,color:"green"}):0===e?Object(h.jsx)(k.a,{name:"history-circle-outlined",width:40,height:40,color:"blue"}):Object(h.jsx)(k.a,{name:"check-circle-outlined",width:40,height:40,color:"green"})}function gr(e,t,a){var n=new Date(1e3*t),o=new Date;if([g.CREATED,g.EXPIRED,g.FAILED,g.CANCELED,g.EXECUTED,g.QUEUED,g.ACCEPTED,g.ABROGATED].includes(e))return Object(mr.a)(n,"dd MMM yyyy - HH:mm");if(a>0){var r=new Date(1e3*a);if(r<=o)return"Ended at ".concat(Object(mr.a)(r,"dd MMM yyyy - HH:mm"));var c=Object(Or.a)(r,o,{addSuffix:!0,includeSeconds:!0});return"Ends ".concat(c)}var i=Object(Or.a)(n,o,{addSuffix:!0,includeSeconds:!0});return"Started ".concat(i)}var vr=function(){var e=To(),t=e.proposal,a=e.reload;return t?Object(h.jsx)("div",{className:"card p-24",children:Object(h.jsx)(y.a,{flow:"row",gap:24,children:t.history.map((function(e,t){return Object(h.jsxs)("div",{className:"flex col-gap-12 align-center",children:[fr(t,e.name),Object(h.jsxs)("div",{className:"flex flow-row",children:[Object(h.jsxs)("div",{className:"flex align-center",children:[Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",className:"mr-8",children:B.get(e.name)}),e.txHash&&Object(h.jsx)(w.c,{address:e.txHash,style:{height:"16px"},children:Object(h.jsx)(k.a,{name:"link-outlined",width:16,height:16})})]}),Object(h.jsx)(Te,{end:1e3*e.endTimestamp,delay:5e3,onEnd:function(){return a()},children:function(){return Object(h.jsx)(N.b,{type:"p2",weight:"semibold",color:"secondary",children:gr(e.name,e.startTimestamp,e.endTimestamp)})}})]})]},e.name)}))})}):null},xr={votes:[],total:0,page:1,pageSize:10,loading:!1,supportFilter:void 0},wr=r.a.createContext(Object(D.a)("ProposalVotersProvider"));var yr,kr=function(e){var t=e.children,a=M(),o=To().proposal,c=Object(W.a)(xr),s=Object(n.a)(c,2),l=s[0],d=s[1];return r.a.useEffect((function(){null!==o&&void 0!==o&&o.proposalId?(d({loading:!0}),a.fetchProposalVoters(o.proposalId,l.page,l.pageSize,l.supportFilter).then((function(e){d({loading:!1,votes:e.data,total:e.meta.count})})).catch((function(){d({loading:!1,votes:[]})}))):d({votes:[],total:0})}),[o,l.page,l.supportFilter]),Object(h.jsx)(wr.Provider,{value:Object(i.a)(Object(i.a)({},l),{},{changeSupportFilter:function(e){d({supportFilter:e,page:1})},changePage:function(e){d({page:e})}}),children:t})},Nr=a(1905),Ar=a.n(Nr),Cr=[{title:"Address",dataIndex:"address",width:"35%",render:function(e){return Object(h.jsxs)(y.a,{flow:"col",gap:8,align:"center",children:[Object(h.jsx)(ot.a,{address:e,width:32,height:32}),Object(h.jsx)(w.b,{address:e,children:Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"blue",children:Object(V.f)(e)})})]})}},{title:"Votes",dataIndex:"power",width:"38%",align:"right",render:function(e){return Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",className:Ar.a.powerCell,children:Object(V.a)(e,2,"-",2)})}},{title:"Vote type",dataIndex:"support",width:"27%",render:function(e){return e?Object(h.jsx)(N.b,{type:"lb2",weight:"semibold",className:Ar.a.forTag,children:"For"}):Object(h.jsx)(N.b,{type:"lb2",weight:"semibold",className:Ar.a.againstTag,children:"Against"})}}],_r=function(e){var t=Object.assign({},e),a=r.a.useContext(wr);return Object(h.jsxs)(Fe.a,Object(i.a)(Object(i.a)({className:Ar.a.component,width:620},t),{},{children:[Object(h.jsxs)(x,{className:Ar.a.tabs,defaultActiveKey:"all",onChange:function(e){"for"===e?a.changeSupportFilter(!0):"against"===e?a.changeSupportFilter(!1):a.changeSupportFilter(void 0)},children:[Object(h.jsx)(x.Tab,{tab:"All Votes"},"all"),Object(h.jsx)(x.Tab,{tab:"For"},"for"),Object(h.jsx)(x.Tab,{tab:"Against"},"against")]}),Object(h.jsx)(nt,{className:Ar.a.table,columns:Cr,dataSource:a.votes,rowKey:"address",loading:a.loading,locale:{emptyText:"No votes"},pagination:{total:a.total,current:a.page,pageSize:a.pageSize,position:["bottomRight"],showTotal:function(e,t){var a=Object(n.a)(t,2),o=a[0],r=a[1];return Object(h.jsxs)(N.b,{type:"p2",weight:"semibold",color:"secondary",children:["Showing ",o," to ",r," out of ",e," votes"]})},onChange:function(e){a.changePage(e)}}})]}))},Sr=function(e){return Object(h.jsx)(kr,{children:Object(h.jsx)(_r,Object(i.a)({},e))})},Vr=function(){var e,t,a,o,c,i,s,l,d=To(),u=r.a.useState(!1),b=Object(n.a)(u,2),j=b[0],p=b[1];return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("div",{className:"card",children:[Object(h.jsxs)("div",{className:"card-header flex justify-space-between",children:[Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:"Vote results"}),Object(h.jsx)(pe.a,{type:"link",onClick:function(){return p(!0)},children:"View voters"})]}),Object(h.jsxs)(y.a,{flow:"row",className:"card-row p-24",children:[Object(h.jsxs)(y.a,{flow:"col",justify:"space-between",children:[Object(h.jsxs)(y.a,{flow:"row",gap:4,children:[Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"secondary",children:"For"}),Object(h.jsxs)(y.a,{flow:"col",gap:8,children:[Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:null===(e=d.proposal)||void 0===e?void 0:e.forVotes.toFormat(2)}),Object(h.jsxs)(N.b,{type:"p1",color:"secondary",children:["(",null===(t=d.forRate)||void 0===t?void 0:t.toFixed(2),"%)"]})]})]}),Object(h.jsxs)(y.a,{flow:"row",gap:4,align:"end",children:[Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"secondary",align:"right",children:"Against"}),Object(h.jsxs)(y.a,{flow:"col",gap:8,children:[Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:null===(a=d.proposal)||void 0===a?void 0:a.againstVotes.toFormat(2)}),Object(h.jsxs)(N.b,{type:"p1",color:"secondary",children:["(",null===(o=d.againstRate)||void 0===o?void 0:o.toFixed(),"%)"]})]})]})]}),Object(h.jsx)(Ke,{percent:d.forRate,strokeColor:"var(--theme-green-color)",trailColor:"var(--theme-red-color)"})]}),Object(h.jsx)(y.a,{flow:"row",className:"card-row p-24",children:Object(h.jsxs)(y.a,{flow:"col",justify:"space-between",children:[Object(h.jsxs)(y.a,{flow:"row",gap:4,children:[Object(h.jsx)(N.a,{text:"Quorum is the percentage of the amount of tokens staked in the DAO that support for a proposal must be greater than for the proposal to be considered valid. For example, if the Quorum % is set to 20%, then more than 20% of the amount of tokens staked in the DAO must vote to approve a proposal for the vote to be considered valid.",children:Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"secondary",children:"Quorum"})}),Object(h.jsxs)(y.a,{flow:"col",gap:8,children:[Object(h.jsxs)(N.b,{type:"p1",weight:"semibold",color:"primary",children:[null===(c=d.quorum)||void 0===c?void 0:c.toFixed(2),"%"]}),Object(h.jsxs)(N.b,{type:"p1",color:"secondary",children:["(> ",null===(i=d.proposal)||void 0===i?void 0:i.minQuorum,"% required)"]})]})]}),Object(h.jsxs)(y.a,{flow:"row",gap:4,align:"end",children:[Object(h.jsx)(N.a,{text:"Approval is the percentage of votes on a proposal that the total support must be greater than for the proposal to be approved. For example, if \u201cApproval\u201d is set to 51%, then more than 51% of the votes on a proposal must vote \u201cYes\u201d for the proposal to pass.",children:Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"secondary",align:"right",children:"Approval"})}),Object(h.jsxs)(y.a,{flow:"col",gap:8,children:[Object(h.jsxs)(N.b,{type:"p1",weight:"semibold",color:"primary",children:[null===(s=d.forRate)||void 0===s?void 0:s.toFixed(2),"%"]}),Object(h.jsxs)(N.b,{type:"p1",color:"secondary",children:["(> ",null===(l=d.proposal)||void 0===l?void 0:l.acceptanceThreshold,"% required)"]})]})]})]})})]}),j&&Object(h.jsx)(Sr,{onCancel:function(){return p(!1)}})]})},Pr=a(1906),Dr=a.n(Pr),Er=["voteState"];!function(e){e[e.None=0]="None",e[e.VoteFor=1]="VoteFor",e[e.VoteAgainst=2]="VoteAgainst",e[e.VoteChange=3]="VoteChange",e[e.VoteCancel=4]="VoteCancel"}(yr||(yr={}));var Tr={changeOption:void 0,gasPrice:void 0},Fr={submitting:!1},Rr=function(e){var t,a,o,c=e.voteState,l=Object(s.a)(e,Er),d=yt.a.useForm(),u=Object(n.a)(d,1)[0],b=To(),j=Object(W.a)(Fr),p=Object(n.a)(j,2),m=p[0],O=p[1];function f(){return(f=Object(z.a)($.a.mark((function t(a){var n,o;return $.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=a.gasPrice,b.proposal&&n){t.next=3;break}return t.abrupt("return");case 3:return O({submitting:!0}),t.prev=4,t.next=7,u.validateFields();case 7:if(c!==yr.VoteFor){t.next=12;break}return t.next=10,b.proposalCastVote(!0,n.value);case 10:t.next=25;break;case 12:if(c!==yr.VoteAgainst){t.next=17;break}return t.next=15,b.proposalCastVote(!1,n.value);case 15:t.next=25;break;case 17:if(c!==yr.VoteChange){t.next=22;break}return t.next=20,b.proposalCastVote(!0===a.changeOption,n.value);case 20:t.next=25;break;case 22:if(c!==yr.VoteCancel){t.next=25;break}return t.next=25,b.proposalCancelVote(n.value);case 25:null===(o=e.onCancel)||void 0===o||o.call(e),t.next=30;break;case 28:t.prev=28,t.t0=t.catch(4);case 30:O({submitting:!1});case 31:case"end":return t.stop()}}),t,null,[[4,28]])})))).apply(this,arguments)}return r.a.useEffect((function(){var e;c===yr.VoteChange&&u.setFieldsValue({changeOption:null===(e=b.receipt)||void 0===e?void 0:e.support})}),[c]),Object(h.jsx)(Fe.a,Object(i.a)(Object(i.a)({className:Dr.a.component,width:560,title:Object(h.jsxs)(h.Fragment,{children:[c===yr.VoteFor&&"Confirm your vote",c===yr.VoteAgainst&&"Confirm your vote",c===yr.VoteChange&&"Change your vote",c===yr.VoteCancel&&"Cancel your vote"]})},l),{},{children:Object(h.jsxs)(Vt,{form:u,initialValues:Tr,validateTrigger:["onSubmit","onChange"],onFinish:function(e){return f.apply(this,arguments)},children:[Object(h.jsxs)(y.a,{flow:"row",gap:16,className:Dr.a.row,children:[Object(h.jsxs)(y.a,{flow:"col",gap:8,align:"center",children:[Object(h.jsx)(N.b,{type:"h2",weight:"bold",color:"primary",children:Object(V.a)(b.votingPower,2)}),Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"secondary",children:"Votes"})]}),(c===yr.VoteFor||c===yr.VoteAgainst)&&Object(h.jsxs)(y.a,{flow:"row",gap:8,children:[Object(h.jsx)(N.b,{type:"p2",color:"secondary",children:"You are about to vote on proposal"}),Object(h.jsxs)(N.b,{type:"p2",weight:"semibold",color:"secondary",children:["\u201c",null===(t=b.proposal)||void 0===t?void 0:t.title,"\u201d"]}),Object(h.jsx)(N.b,{type:"p2",color:"secondary",children:"Are you sure you want to continue? You can change your vote later."})]}),c===yr.VoteChange&&Object(h.jsxs)(y.a,{flow:"row",gap:8,children:[Object(h.jsx)(N.b,{type:"p2",color:"secondary",children:"You are about to change your vote on proposal"}),Object(h.jsxs)(N.b,{type:"p2",weight:"semibold",color:"secondary",children:["\u201c",null===(a=b.proposal)||void 0===a?void 0:a.title,"\u201d"]}),Object(h.jsx)(N.b,{type:"p2",color:"secondary",children:"Are you sure you want to continue? You can change your vote again later."})]}),c===yr.VoteCancel&&Object(h.jsxs)(y.a,{flow:"row",gap:8,children:[Object(h.jsx)(N.b,{type:"p2",color:"secondary",children:"You are about to cancel your vote on proposal"}),Object(h.jsxs)(N.b,{type:"p2",weight:"semibold",color:"secondary",children:["\u201c",null===(o=b.proposal)||void 0===o?void 0:o.title,"\u201d"]}),Object(h.jsx)(N.b,{type:"p2",color:"secondary",children:"Are you sure you want to continue? You can change your vote again later."})]})]}),Object(h.jsx)(ve,{}),Object(h.jsxs)(y.a,{flow:"row",gap:32,className:Dr.a.row,children:[c===yr.VoteChange&&Object(h.jsx)(Vt.Item,{name:"changeOption",label:"Vote",rules:[{required:!0,message:"Required"}],children:Object(h.jsx)(Dt.a.Group,{className:Dr.a.changeGroup,disabled:m.submitting,children:Object(h.jsxs)(y.a,{gap:16,colsTemplate:"1fr 1fr",children:[Object(h.jsx)(Bt,{label:Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:"For"}),value:!0}),Object(h.jsx)(Bt,{label:Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:"Against"}),value:!1})]})})}),Object(h.jsx)(Vt.Item,{name:"gasPrice",label:"Gas Fee (Gwei)",rules:[{required:!0,message:"Required"}],children:Object(h.jsx)(Gt,{disabled:m.submitting})}),Object(h.jsx)(Vt.Item,{shouldUpdate:!0,children:function(e){var t,a=(0,e.getFieldsValue)().changeOption,n=!1;c===yr.VoteChange&&((null===(t=b.receipt)||void 0===t?void 0:t.support)===a&&(n=!0));return Object(h.jsxs)(pe.a,{htmlType:"submit",type:"primary",loading:m.submitting,disabled:n,className:Dr.a.actionBtn,children:[c===yr.VoteFor&&"Vote for proposal",c===yr.VoteAgainst&&"Vote against proposal",c===yr.VoteCancel&&"Cancel vote",c===yr.VoteChange&&!0===a&&"Vote for proposal",c===yr.VoteChange&&!1===a&&"Vote against proposal"]})}})]})]})}))},Ir={showVotersModal:!1,showVoteModal:!1,voteState:yr.None},Br=function(){var e,t,a,o,c,s,l,d=Object(q.c)(),u=To(),b=r.a.useState(Ir),j=Object(n.a)(b,2),p=j[0],m=j[1];return(null===(e=u.proposal)||void 0===e?void 0:e.state)===g.WARMUP?Object(h.jsxs)("div",{className:"card",children:[Object(h.jsx)("div",{className:"card-header",children:Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:"Votes"})}),Object(h.jsx)("div",{className:"p-24",children:Object(h.jsx)(Jt,{type:"info",message:"Voting on this proposal will start after the Warm-Up period ends."})})]}):Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("div",{className:"card",children:[Object(h.jsxs)("div",{className:"card-header flex justify-space-between",children:[Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:"Votes"}),Object(h.jsx)(pe.a,{type:"link",onClick:function(){m((function(e){return Object(i.a)(Object(i.a)({},e),{},{showVotersModal:!0})}))},children:"View voters"})]}),Object(h.jsxs)(y.a,{className:"card-row p-24",flow:"row",gap:32,children:[Object(h.jsxs)(y.a,{flow:"row",gap:16,children:[Object(h.jsxs)(y.a,{flow:"col",justify:"space-between",children:[Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:"For"}),Object(h.jsxs)(y.a,{flow:"col",gap:8,children:[Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:null===(t=u.proposal)||void 0===t?void 0:t.forVotes.toFormat(2)}),Object(h.jsxs)(N.b,{type:"p1",color:"secondary",children:["(",null===(a=u.forRate)||void 0===a?void 0:a.toFixed(2),"%)"]})]})]}),Object(h.jsx)(Ke,{percent:u.forRate,strokeColor:"var(--theme-green-color)",trailColor:"rgba(var(--theme-green-color-rgb), .16)"})]}),Object(h.jsxs)(y.a,{flow:"row",gap:16,children:[Object(h.jsxs)(y.a,{flow:"col",justify:"space-between",children:[Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:"Against"}),Object(h.jsxs)(y.a,{flow:"col",gap:8,children:[Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:null===(o=u.proposal)||void 0===o?void 0:o.againstVotes.toFormat(2)}),Object(h.jsxs)(N.b,{type:"p1",color:"secondary",children:["(",null===(c=u.againstRate)||void 0===c?void 0:c.toFixed(2),"%)"]})]})]}),Object(h.jsx)(Ke,{percent:u.againstRate,strokeColor:"var(--theme-red-color)",trailColor:"rgba(var(--theme-red-color-rgb), .16)"})]})]}),d.isActive&&Object(h.jsxs)(y.a,{className:"card-row p-24",flow:"row",gap:24,children:[Object(h.jsxs)(y.a,{flow:"row",gap:8,children:[Object(h.jsx)(N.b,{type:"p1",color:"secondary",children:"Your voting power for this proposal"}),Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:Object(V.a)(u.votingPower,2)})]}),Object(h.jsx)(y.a,{flow:"row",gap:24,children:null!==(s=u.receipt)&&void 0!==s&&s.hasVoted?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(Jt,{message:"You already voted ".concat(null!==(l=u.receipt)&&void 0!==l&&l.support?"FOR":"AGAINST"," the proposal")}),Object(h.jsxs)(y.a,{flow:"col",gap:24,colsTemplate:"1fr 1fr",children:[Object(h.jsx)(pe.a,{type:"primary",onClick:function(){m((function(e){return Object(i.a)(Object(i.a)({},e),{},{showVoteModal:!0,voteState:yr.VoteChange})}))},children:"Change vote"}),Object(h.jsx)(pe.a,{type:"default",onClick:function(){m((function(e){return Object(i.a)(Object(i.a)({},e),{},{showVoteModal:!0,voteState:yr.VoteCancel})}))},children:"Cancel vote"})]})]}):Object(h.jsxs)(y.a,{gap:24,colsTemplate:"1fr 1fr",children:[Object(h.jsx)(pe.a,{type:"primary",onClick:function(){m((function(e){return Object(i.a)(Object(i.a)({},e),{},{showVoteModal:!0,voteState:yr.VoteFor})}))},children:"Vote for"}),Object(h.jsx)(pe.a,{type:"default",onClick:function(){m((function(e){return Object(i.a)(Object(i.a)({},e),{},{showVoteModal:!0,voteState:yr.VoteAgainst})}))},children:"Vote against"})]})})]})]}),p.showVotersModal&&Object(h.jsx)(Sr,{onCancel:function(){m((function(e){return Object(i.a)(Object(i.a)({},e),{},{showVotersModal:!1})}))}}),p.showVoteModal&&Object(h.jsx)(Rr,{voteState:p.voteState,onCancel:function(){m((function(e){return Object(i.a)(Object(i.a)({},e),{},{showVoteModal:!1,voteState:yr.None})}))}})]})},Ur=a(1907),Mr=a.n(Ur),Lr={gasPrice:void 0},qr={submitting:!1},Gr=function(e){var t=Object.assign({},e),a=xt.a.useForm(),o=Object(n.a)(a,1)[0],r=To(),c=Object(W.a)(qr),s=Object(n.a)(c,2),l=s[0],d=s[1];function u(){return(u=Object(z.a)($.a.mark((function t(a){var n,c;return $.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=a.gasPrice,r.proposal&&n){t.next=3;break}return t.abrupt("return");case 3:return d({submitting:!0}),t.prev=4,t.next=7,o.validateFields();case 7:return t.next=9,r.queueProposalForExecution(n.value);case 9:null===(c=e.onCancel)||void 0===c||c.call(e),t.next=14;break;case 12:t.prev=12,t.t0=t.catch(4);case 14:d({submitting:!1});case 15:case"end":return t.stop()}}),t,null,[[4,12]])})))).apply(this,arguments)}return Object(h.jsx)(Fe.a,Object(i.a)(Object(i.a)({className:Mr.a.component,width:560,title:"Queue for execution"},t),{},{children:Object(h.jsxs)(Vt,{form:o,initialValues:Lr,validateTrigger:["onSubmit","onChange"],onFinish:function(e){return u.apply(this,arguments)},children:[Object(h.jsx)(y.a,{flow:"row",gap:16,className:Mr.a.row,children:Object(h.jsx)(N.b,{type:"p2",weight:"semibold",color:"secondary",children:"Once a proposal is accepted, it will have to wait in the queue before it can be executed. During this time it can only be cancelled by an abrogation proposal."})}),Object(h.jsx)(ve,{}),Object(h.jsxs)(y.a,{flow:"row",gap:32,className:Mr.a.row,children:[Object(h.jsx)(Vt.Item,{name:"gasPrice",label:"Gas Fee (Gwei)",rules:[{required:!0,message:"Required"}],children:Object(h.jsx)(Gt,{disabled:l.submitting})}),Object(h.jsx)(pe.a,{htmlType:"submit",type:"primary",loading:l.submitting,className:Mr.a.actionBtn,children:"Queue proposal for execution"})]})]})}))},Yr=a(1908),Wr=a.n(Yr),zr={showQueueForExecution:!1,executing:!1},Qr=function(){var e,t,a,o=Object(c.g)(),r=Object(q.c)(),s=To(),l=null===(e=s.proposal)||void 0===e?void 0:e.state,d=Object(W.a)(zr),u=Object(n.a)(d,2),b=u[0],j=u[1];return Object(h.jsxs)("div",{className:"container-limit",children:[Object(h.jsx)("div",{className:"mb-32",children:Object(h.jsxs)("button",{type:"button",onClick:function(){o.push("/governance/proposals")},className:"button-text",children:[Object(h.jsx)(k.a,{name:"arrow-back",width:16,height:16,className:"mr-8",color:"inherit"}),"Proposals"]})}),Object(h.jsxs)(y.a,{flow:"col",gap:32,colsTemplate:"1fr 1fr",className:"mb-32",children:[Object(h.jsxs)(N.b,{type:"h2",weight:"semibold",color:"primary",children:["PID-",null===(t=s.proposal)||void 0===t?void 0:t.proposalId,": ",null===(a=s.proposal)||void 0===a?void 0:a.title]}),Object(h.jsx)(y.a,{flow:"col",justify:"end",children:r.account&&Object(h.jsxs)(h.Fragment,{children:[g.ACCEPTED===l&&Object(h.jsx)(pe.a,{type:"primary",loading:b.executing,onClick:function(){return j({showQueueForExecution:!0})},children:"Queue for execution"}),g.GRACE===l&&Object(h.jsx)(pe.a,{type:"primary",loading:b.executing,onClick:function(){j((function(e){return Object(i.a)(Object(i.a)({},e),{},{executing:!0})})),s.executeProposal().catch(Error).then((function(){j((function(e){return Object(i.a)(Object(i.a)({},e),{},{executing:!1})}))}))},children:"Execute proposal"})]})})]}),Object(h.jsxs)("div",{className:Wr.a.cardsAndSidebarContainer,children:[Object(h.jsxs)(y.a,{flow:"row",gap:32,className:Wr.a.cardsContainer,children:[![g.WARMUP,g.ACTIVE].includes(l)&&Object(h.jsx)(Vr,{}),Object(h.jsx)(pr,{})]}),Object(h.jsxs)(y.a,{flow:"row",gap:32,className:Wr.a.sidebarContainer,children:[Object(h.jsx)(vr,{}),(g.QUEUED===l||s.isCanceled)&&Object(h.jsx)(ur,{}),[g.WARMUP,g.ACTIVE].includes(l)&&Object(h.jsx)(Br,{}),g.ACTIVE===l&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(hr,{}),Object(h.jsx)(br,{})]})]})]}),b.showQueueForExecution&&Object(h.jsx)(Gr,{onCancel:function(){return j({showQueueForExecution:!1})}})]})},Zr=function(){var e=Object(c.i)().params;return Object(h.jsx)(Fo,{proposalId:Number(e.id),children:Object(h.jsx)(Qr,{})})},Hr=a(438),Kr={proposals:[],total:0,page:1,pageSize:10,loading:!1,stateFilter:void 0,searchFilter:void 0},Xr=r.a.createContext(Object(D.a)("ProposalsProvider"));function $r(){return r.a.useContext(Xr)}var Jr=function(e){var t=e.stateFilter,a=e.searchFilter,o=e.children,c=M(),s=Object(W.a)(Kr),l=Object(n.a)(s,2),d=l[0],u=l[1];return r.a.useEffect((function(){u({stateFilter:t,searchFilter:a,page:1})}),[t,a]),r.a.useEffect((function(){u({loading:!0}),c.fetchProposals(d.page,d.pageSize,d.stateFilter,d.searchFilter).then((function(e){u({loading:!1,proposals:e.data.map((function(e){var t;return Object(i.a)(Object(i.a)({},e),{},{stateTimeLeftTs:Date.now()+1e3*(null!==(t=e.stateTimeLeft)&&void 0!==t?t:0)})})),total:e.meta.count})})).catch((function(){u({loading:!1,proposals:[]})}))}),[d.page,d.stateFilter,d.searchFilter]),Object(h.jsx)(Xr.Provider,{value:Object(i.a)(Object(i.a)({},d),{},{changeStateFilter:function(e){u({stateFilter:e})},changeSearchFilter:function(e){u({searchFilter:e})},changePage:function(e){u({page:e})}}),children:o})},ec=a(296),tc=function(e){var t=e.state,a=(e.className,"grey");switch(t){case"ACCEPTED":case"EXECUTED":a="green";break;case"WARMUP":case"ACTIVE":case"QUEUED":case"GRACE":a="blue";break;case"EXPIRED":case"FAILED":case"CANCELED":case"ABROGATED":a="red"}return Object(h.jsx)(ec.a,{color:a,size:"large",children:B.get(t)})},ac=[{title:"Proposal",width:"70%",render:function(e,t){return Object(h.jsxs)(y.a,{flow:"row",gap:8,children:[Object(h.jsx)(jt.b,{to:"proposals/".concat(t.proposalId),children:Object(h.jsxs)(N.b,{type:"p1",weight:"semibold",color:"primary",children:["PID-",t.proposalId,": ",t.title]})}),Object(h.jsxs)(y.a,{flow:"col",gap:16,align:"center",children:[Object(h.jsx)(tc,{state:t.state}),Object(h.jsx)(Te,{end:t.stateTimeLeftTs,delay:1e3,children:function(e){return Object(h.jsx)(N.b,{type:"p2",weight:"semibold",color:"secondary",children:e>0?Object(Re.a)(0,t.stateTimeLeftTs):""})}})]})]})}},{title:"Votes",width:"30%",render:function(e,t){var a=t.forVotes.plus(t.againstVotes),n=C.a.ZERO,o=C.a.ZERO;return a.gt(C.a.ZERO)&&(n=t.forVotes.multipliedBy(100).div(a),o=t.againstVotes.multipliedBy(100).div(a)),Object(h.jsxs)(y.a,{flow:"row",gap:8,children:[Object(h.jsxs)(y.a,{gap:24,colsTemplate:"minmax(0, 196px) 65px",children:[Object(h.jsx)(Ke,{percent:n.toNumber(),strokeColor:"var(--theme-green-color)",trailColor:"rgba(var(--theme-green-color-rgb), .16)"}),Object(h.jsxs)(N.b,{type:"p2",weight:"semibold",color:"secondary",align:"right",children:[n.toFormat(2),"%"]})]}),Object(h.jsxs)(y.a,{gap:24,colsTemplate:"minmax(0, 196px) 65px",children:[Object(h.jsx)(Ke,{percent:o.toNumber(),strokeColor:"var(--theme-red-color)",trailColor:"rgba(var(--theme-red-color-rgb), .16)"}),Object(h.jsxs)(N.b,{type:"p2",weight:"semibold",color:"secondary",align:"right",children:[o.toFormat(2),"%"]})]})]})}}],nc=function(){var e=$r();return Object(h.jsx)(nt,{columns:ac,dataSource:e.proposals,rowKey:"proposalId",loading:e.loading,locale:{emptyText:"No proposals"},pagination:{total:e.total,current:e.page,pageSize:e.pageSize,position:["bottomRight"],showTotal:function(e,t){var a=Object(n.a)(t,2),o=a[0],r=a[1];return Object(h.jsxs)(N.b,{type:"p2",weight:"semibold",color:"secondary",children:["Showing ",o," to ",r," out of ",e," proposals"]})},onChange:function(t){e.changePage(t)}}})},oc=a(1909),rc=a.n(oc),cc={hasActiveProposal:void 0,showWhyReason:!1},ic=function(){var e=Object(c.g)(),t=Object(q.c)(),a=ue(),o=$r(),i=Object(W.a)(cc),s=Object(n.a)(i,2),l=s[0],d=s[1];var u=Object(Hr.a)((function(e){o.changeSearchFilter(e.target.value)}),400);r.a.useEffect((function(){a.actions.hasActiveProposal().then((function(e){d({hasActiveProposal:e})}))}),[t.account]);var b=void 0!==l.hasActiveProposal&&void 0!==a.actions.hasThreshold(),j=!1===l.hasActiveProposal&&!0===a.actions.hasThreshold();return Object(h.jsxs)(y.a,{flow:"row",gap:32,children:[Object(h.jsxs)(y.a,{flow:"col",align:"center",justify:"space-between",children:[Object(h.jsx)(N.b,{type:"h1",weight:"bold",color:"primary",children:"Proposals"}),t.isActive&&Object(h.jsxs)(y.a,{flow:"row",gap:8,align:"end",justify:"end",children:[Object(h.jsx)(pe.a,{type:"primary",disabled:!j,onClick:function(){return e.push("proposals/create")},children:"Create proposal"}),b&&!j&&Object(h.jsxs)(y.a,{flow:"col",gap:8,align:"center",children:[Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"secondary",children:"You are not able to create a proposal."}),Object(h.jsx)(Hn.a,{title:"Why you can\u2019t create a proposal",placement:"bottomLeft",overlayStyle:{width:520},content:Object(h.jsxs)(y.a,{flow:"row",gap:8,children:[Object(h.jsx)(N.b,{type:"p2",weight:"semibold",children:"There are 2 possible reasons for why you can\u2019t create a proposal:"}),Object(h.jsxs)("ul",{children:[Object(h.jsx)("li",{children:Object(h.jsx)(N.b,{type:"p2",weight:"semibold",children:"You already are the creator of an ongoing proposal"})}),Object(h.jsx)("li",{children:Object(h.jsxs)(N.b,{type:"p2",weight:"semibold",children:["You don\u2019t have enough voting power to create a proposal. The creator of a proposal needs to have a voting power of at least ",a.minThreshold,"% of the amount of $BOND staked in the DAO."]})})]}),Object(h.jsx)(w.d,{href:"https://integrations.barnbridge.com/specs/dao-specifications#proposals-and-voting",children:"Learn more"})]}),visible:l.showWhyReason,onVisibleChange:function(e){return d({showWhyReason:e})},children:Object(h.jsx)(pe.a,{type:"link",children:"See why"})})]})]})]}),Object(h.jsxs)("div",{className:"card",children:[Object(h.jsxs)("div",{className:"card-header flex justify-space-between",style:{padding:0},children:[Object(h.jsxs)(x,{className:rc.a.tabs,simple:!0,activeKey:o.stateFilter,onChange:function(e){o.changeStateFilter(e)},children:[Object(h.jsx)(x.Tab,{tab:"All proposals"},"all"),Object(h.jsx)(x.Tab,{tab:"Active"},"active"),Object(h.jsx)(x.Tab,{tab:"Executed"},"executed"),Object(h.jsx)(x.Tab,{tab:"Failed"},"failed")]}),Object(h.jsx)(Ca,{className:rc.a.search,prefix:Object(h.jsx)(k.a,{name:"search-outlined",width:16,height:16}),placeholder:"Search proposal",onChange:function(e){return u(e)}})]}),Object(h.jsx)(nc,{})]})]})},sc=function(){var e=Object(c.g)(),t=ue();return void 0===t.isActive?Object(h.jsx)(Tt.a,{}):t.isActive?Object(h.jsx)(Jr,{children:Object(h.jsx)(ic,{})}):Object(h.jsxs)(y.a,{flow:"row",gap:24,align:"start",children:[Object(h.jsxs)("button",{type:"button",onClick:function(){e.push("/governance/overview")},className:"button-text",children:[Object(h.jsx)(k.a,{name:"arrow-back",width:16,height:16,className:"mr-8",color:"inherit"}),"Overview"]}),Object(h.jsx)(Xe,{className:"full-width"})]})},lc=a(85),dc=a(1910),uc=a.n(dc);var bc=function(e){var t=e.className,a=e.total,n=e.current,r=e.pageSize,c=e.onChange,i=Math.ceil(a/r),s=Object(o.useMemo)((function(){return function(e,t){var a,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,o=e-n,r=e+n+1,c=[],i=[];if(t<2)return[1];c.push(1);for(var s=e-n;s<=e+n;s++)s>=o&&s<r&&s<t&&s>1&&c.push(s);return c.push(t),c.forEach((function(e){a&&(e-a===2?i.push(a+1):e-a!==1&&i.push(null)),i.push(e),a=e})),i}(n,i)}),[n,i]);return i<2?null:Object(h.jsxs)("div",{className:b()(uc.a.pagination,t),children:[Object(h.jsx)("button",{className:b()(uc.a.page,uc.a.prev),type:"button",onClick:function(){return c(n-1)},disabled:n<=1,children:Object(h.jsx)(it.a,{name:"chevron",rotate:180,size:24})}),s.map((function(e,t){return e?Object(h.jsx)("button",{onClick:function(){return c(e)},className:b()(uc.a.page,Object(bt.a)({},uc.a.active,e===n)),type:"button",disabled:e===n,children:e},t):Object(h.jsx)("div",{className:uc.a.separator,children:"..."},t)})),Object(h.jsx)("button",{className:b()(uc.a.page,uc.a.next),type:"button",onClick:function(){return c(n+1)},disabled:n>=i,children:Object(h.jsx)(it.a,{name:"chevron",size:24})})]})},jc=a(1911),pc=a.n(jc),hc=function(e){var t,a=e.columns,n=e.data,o=e.loading,r=e.rowKey,s=e.variation,l=void 0===s?"standard":s,d=e.link,u=Object(c.g)();return Object(h.jsxs)("div",{className:b()("table-container",pc.a.tableContainer,Object(bt.a)({},pc.a.loading,o)),children:[Object(h.jsxs)("table",{className:b()(pc.a.table,(t={table:"standard"===l,"table-separated":"separated"===l},Object(bt.a)(t,pc.a.clickable,d),Object(bt.a)(t,pc.a.loading,o),t)),children:[Object(h.jsx)("thead",{children:Object(h.jsxs)("tr",{children:[a.map((function(e,t){var a=e.heading,n=e.align;return Object(h.jsx)("th",{className:n?"text-".concat(n):void 0,children:a},t)})),d?Object(h.jsx)("th",{}):null]})}),Object(h.jsx)("tbody",{children:n.map((function(e,t){var n;return Object(h.jsxs)("tr",{onClick:d?function(){return u.push(d(e))}:void 0,children:[a.map((function(t,a){var n=t.render,o=t.align;return Object(h.jsx)("td",{className:o?"text-".concat(o):void 0,children:Object(h.jsx)(n,Object(i.a)({},e))},a)})),d?Object(h.jsx)("td",{children:Object(h.jsx)(it.a,{name:"arrow",color:"red",className:pc.a.arrowIcon})}):null]},null!==(n=null===r||void 0===r?void 0:r(e))&&void 0!==n?n:t)}))})]}),o&&Object(h.jsx)(Oa,{className:pc.a.spinner,style:{width:40,height:40,position:"absolute",marginTop:-20,marginLeft:-20}})]})},mc=function(e){e.children;var t=e.text,a=e.total,n=e.current,o=e.pageSize,r=e.onChange,c=function(e){var t,a=e.text,n=e.total,o=e.current,r=e.pageSize;if(a){var c=n?(o-1)*r+1:0,i=o*r>n?n:o*r;"function"===typeof a&&(t=a({total:n,from:c,to:i})),!0===a&&(t=Object(h.jsxs)(h.Fragment,{children:["Showing ",c," to ",i," out of ",n," entries"]}))}return t}({text:t,total:a,current:n,pageSize:o});return Object(h.jsxs)("div",{className:b()(pc.a.tableFooter,"p-24"),children:[c?Object(h.jsx)(N.b,{type:"p2",weight:"semibold",color:"secondary",children:c}):null,Object(h.jsx)(bc,{total:a,current:n,pageSize:o,onChange:r})]})};var Oc=function(e){var t=e.filters,a=e.value,r=e.onChange,c=e.className,s=yt.a.useForm(),l=Object(n.a)(s,1)[0],d=Object(o.useState)(!1),u=Object(n.a)(d,2),j=u[0],p=u[1],m=Object(o.useMemo)((function(){return t.reduce((function(e,t){return Object(i.a)(Object(i.a)({},e),{},Object(bt.a)({},t.name,t.defaultValue))}),{})}),[t]),O=Object(o.useMemo)((function(){var e=0;return a&&t.forEach((function(t){a[t.name]!==t.defaultValue&&e++})),e}),[t,a]);Object(o.useEffect)((function(){a&&l.setFieldsValue(a)}),[a]);var f=Object(h.jsxs)(Vt,{form:l,initialValues:m,validateTrigger:["onSubmit"],onFinish:function(e){p(!1),r(e)},children:[t.map((function(e){return Object(h.jsx)(Vt.Item,{name:e.name,label:e.label,className:"mb-32",children:e.itemRender()},e.name)})),Object(h.jsxs)("div",{className:"grid flow-col align-center justify-space-between",children:[Object(h.jsx)("button",{type:"button",onClick:function(){return l.resetFields()},className:"button-text",children:"Reset filters"}),Object(h.jsx)("button",{type:"submit",className:"button-primary",children:"Apply filters"})]})]});return Object(h.jsx)(Hn.a,{title:"Filters",overlayStyle:{width:348},content:f,visible:j,onVisibleChange:p,placement:"bottomRight",children:Object(h.jsxs)("button",{type:"button",className:b()("button-ghost-monochrome pv-16",c),children:[Object(h.jsx)(it.a,{name:"filter",className:"mr-8"}),Object(h.jsx)("span",{className:"mr-8",children:"Filters"}),Object(h.jsx)(ec.b,{children:O})]})})},fc=a(292),gc=(a(420),a(605));function vc(e){var t=(null!==e&&void 0!==e?e:{}).listeners,a=void 0===t||t,r=Object(q.c)(),c=r.account,i=r.provider,s=Object(Zn.d)().activeProvider,l=Object(Pe.a)(),d=Object(n.a)(l,2),u=d[0],b=d[1],j=Object(o.useRef)(s),p=Object(o.useRef)(i),m=Object(o.useRef)(c),O=Object(o.useRef)(new Map),f=Object(o.useCallback)((function(e,t,a){var n,o=t();return o.setCallProvider(j.current),o.setProvider(p.current),o.setAccount(m.current),O.current.set(e,{address:e,factory:t,options:a,instance:o}),null===a||void 0===a||null===(n=a.afterInit)||void 0===n||n.call(a,o),u(),o}),[s,c,u]),g=Object(Hr.a)((function(){O.current.forEach((function(e){var t,a;null===(t=e.options)||void 0===t||null===(a=t.onDestroy)||void 0===a||a.call(t,e.instance),f(e.address,(function(){return e.instance}),e.options)}))}),250);j.current!==s&&(j.current=s,g()),p.current!==i&&(p.current=i,g()),m.current!==c&&(m.current=c,g());var v=Object(o.useCallback)((function(e,t,a){return O.current.has(e)?O.current.get(e).instance:f(e,t,a)}),[f]);return{getOrCreateContract:v,getContract:Object(o.useCallback)((function(e){if(O.current.has(e))return O.current.get(e).instance}),[f]),Listeners:Object(o.useMemo)((function(){return a?Object(h.jsx)(h.Fragment,{children:Array.from(O.current).map((function(e){var t=Object(n.a)(e,2),a=t[0],o=t[1];return Object(h.jsx)(gc.a,{contract:o.instance},a)}))}):null}),[b,a])}}var xc=[{heading:"Token Name",render:function(e){var t,a,n,o;return Object(h.jsxs)("div",{className:"flex flow-col col-gap-12 align-center",children:[Object(h.jsx)(_e.a,{name:null===(t=e.token)||void 0===t?void 0:t.icon,className:"mr-16",size:32}),Object(h.jsxs)("div",{className:"flex flow-row row-gap-4",children:[Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:null!==(a=e.tokenSymbol)&&void 0!==a?a:"-"}),Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"secondary",children:null!==(n=null===(o=e.token)||void 0===o?void 0:o.name)&&void 0!==n?n:"-"})]})]})}},{heading:"Transaction Hash",render:function(e){return Object(h.jsx)(w.c,{address:e.transactionHash,children:Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"blue",children:Object(V.f)(e.transactionHash)})})}},{heading:"Date",render:function(e){return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",className:"mb-4",children:Object(mr.a)(1e3*e.blockTimestamp,"MM.dd.yyyy")}),Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"secondary",children:Object(mr.a)(1e3*e.blockTimestamp,"HH:mm")})]})}},{heading:Object(h.jsx)("div",{className:"text-right",children:"Amount"}),render:function(e){var t,a;return Object(h.jsx)(Ce.a,{placement:"bottomRight",title:Object(V.b)(e.amount,{decimals:e.tokenDecimals,tokenName:e.tokenSymbol}),children:Object(h.jsxs)("div",{className:"text-right",children:[Object(h.jsxs)(N.b,{type:"p1",weight:"semibold",color:"IN"===e.transactionDirection?"green":"red",children:["IN"===e.transactionDirection?"+":"-"," ",null!==(t=Object(V.b)(e.amount))&&void 0!==t?t:"-"]}),Object(h.jsx)(N.b,{type:"small",weight:"semibold",children:null!==(a=Object(V.c)(e.amountUSD))&&void 0!==a?a:"-"})]})})}},{heading:"From",render:function(e){return Object(h.jsx)(w.b,{address:"IN"===e.transactionDirection?e.counterpartyAddress:e.accountAddress,children:Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"blue",children:"IN"===e.transactionDirection?e.counterpartyLabel||Object(V.f)(e.counterpartyAddress):e.accountLabel||Object(V.f)(e.accountAddress)})})}},{heading:"To",render:function(e){return Object(h.jsx)(w.b,{address:"OUT"===e.transactionDirection?e.counterpartyAddress:e.accountAddress,children:Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"blue",children:"OUT"===e.transactionDirection?e.counterpartyLabel||Object(V.f)(e.counterpartyAddress):e.accountLabel||Object(V.f)(e.accountAddress)})})}}],wc=function(){var e,t,a,r=Object(P.b)(),c=Object(Pe.a)(),s=Object(n.a)(c,2),l=s[0],d=s[1],u=Object(fc.b)(),b=u.getAmountInUSD,j=u.getToken,p=vc(),m=p.getOrCreateContract,O=p.getContract,f=Object(o.useState)(1),g=Object(n.a)(f,2),v=g[0],x=g[1],w=Object(o.useState)("all"),y=Object(n.a)(w,2),k=y[0],A=y[1],_=Object(o.useState)("all"),S=Object(n.a)(_,2),D=S[0],T=S[1],F=Object(o.useMemo)((function(){return{token:k,direction:D}}),[k,D]),R=function(){var e,t=Object(P.b)(),a=new URL("/api/governance/treasury/tokens?address=".concat(null===(e=t.contracts.dao)||void 0===e?void 0:e.governance),t.api.baseUrl);return Object(E.c)(a,{transform:function(e){return e.data}})}(),I=R.data,B=void 0===I?[]:I,U=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,o=Object(P.b)(),r=Object(E.b)({address:null===(e=o.contracts.dao)||void 0===e?void 0:e.governance,limit:10,page:t,tokenAddress:a,transactionDirection:n}),c=new URL("/api/governance/treasury/transactions?".concat(r),o.api.baseUrl);return Object(E.c)(c,{transform:function(e){var t=e.data,a=void 0===t?[]:t;return{meta:e.meta,data:a.map((function(e){return Object(i.a)(Object(i.a)({},e),{},{amount:Number(e.amount)})}))}}})}(v,k,D),M=U.data,L=U.loading,q=null!==(e=null===M||void 0===M?void 0:M.data)&&void 0!==e?e:[],G=null!==(t=null===M||void 0===M?void 0:M.meta.count)&&void 0!==t?t:0,Y=Object(o.useMemo)((function(){var e=(null!==B&&void 0!==B?B:[]).map((function(e){var t,a,n=j(e.symbol);if(n){var o=O(e.address),c=null===o||void 0===o||null===(t=o.getBalanceOf(null===(a=r.contracts.dao)||void 0===a?void 0:a.governance))||void 0===t?void 0:t.unscaleBy(e.decimals),s=b(c,e.symbol);return Object(i.a)(Object(i.a)({},e),{},{balanceAmount:c,balanceAmountUSD:s,token:n})}})).filter(Boolean);return e.sort((function(e,t){return e.balanceAmountUSD&&t.balanceAmountUSD?t.balanceAmountUSD.minus(e.balanceAmountUSD).toNumber():0})),e}),[b,O,B,d]),W=Object(o.useMemo)((function(){return C.a.sumEach(Y,(function(e){var t;return null!==(t=e.balanceAmountUSD)&&void 0!==t?t:C.a.ZERO}))}),[Y]),z=Object(o.useMemo)((function(){var e;return null!==(e=null===q||void 0===q?void 0:q.map((function(e){var t=j(e.tokenSymbol),a=C.a.from(e.amount),n=b(a,e.tokenSymbol);return Object(i.a)(Object(i.a)({},e),{},{token:t,amount:a,amountUSD:n})})))&&void 0!==e?e:[]}),[q]),Q=Object(o.useMemo)((function(){return[{name:"token",label:"Token address",defaultValue:"all",itemRender:function(){var e=[{value:"all",label:"All tokens"}].concat(Object(Ua.a)(Y.map((function(e){var t,a;return{value:e.address,label:null!==(t=null===(a=e.token)||void 0===a?void 0:a.name)&&void 0!==t?t:e.symbol}}))));return Object(h.jsx)(qn.a,{options:e,className:"full-width"})}},{name:"direction",label:"Transaction direction",defaultValue:"all",itemRender:function(){return Object(h.jsx)(qn.a,{options:[{value:"all",label:"All pool transactions"},{value:"in",label:"In"},{value:"out",label:"Out"}],className:"full-width"})}}]}),[Y]);return Object(o.useEffect)((function(){null===B||void 0===B||B.forEach((function(e){m(e.address,(function(){return new lc.a([],e.address)}),{afterInit:function(e){var t;e.on(J.c.UPDATE_DATA,l),e.loadCommon().catch(Error),e.loadBalance(null===(t=r.contracts.dao)||void 0===t?void 0:t.governance).catch(Error)}})}))}),[B]),Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(N.b,{type:"h2",weight:"bold",color:"primary",className:"mb-4",children:null!==(a=Object(V.c)(W))&&void 0!==a?a:"-"}),Object(h.jsx)(N.b,{type:"p2",weight:"semibold",color:"secondary",className:"mb-32",children:"Total holdings balance"}),Object(h.jsx)("div",{className:"grid gap-16 mb-32",style:{gridTemplateColumns:"repeat(3, 1fr)"},children:Y.map((function(e){var t,a,n,o,r,c;return Object(h.jsxs)("div",{className:"card flex flow-col col-gap-12 align-center p-24",children:[Object(h.jsx)(_e.a,{name:null===(t=e.token)||void 0===t?void 0:t.icon,className:"mr-8",size:32}),Object(h.jsxs)("div",{className:"flex flow-row row-gap-4",children:[Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:null!==(a=e.symbol)&&void 0!==a?a:"-"}),Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"secondary",children:null!==(n=null===(o=e.token)||void 0===o?void 0:o.name)&&void 0!==n?n:"-"})]}),Object(h.jsxs)("div",{className:"flex flow-row row-gap-4 align-end ml-auto",children:[Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:null!==(r=Object(V.b)(e.balanceAmount))&&void 0!==r?r:"-"}),Object(h.jsx)(N.b,{type:"small",weight:"semibold",color:"secondary",children:null!==(c=Object(V.c)(e.balanceAmountUSD))&&void 0!==c?c:"-"})]})]},e.address)}))}),Object(h.jsxs)("div",{className:"card",children:[Object(h.jsxs)("div",{className:"card-header flex flow-col align-center justify-space-between pv-12",children:[Object(h.jsx)(N.b,{type:"p1",weight:"semibold",color:"primary",children:"Transaction history"}),Object(h.jsx)(Oc,{filters:Q,value:F,onChange:function(e){x(1),A(e.token),T(e.direction)}})]}),Object(h.jsx)(hc,{columns:xc,data:z,rowKey:function(e){return"".concat(e.transactionHash,"_").concat(e.tokenSymbol)},loading:L}),Object(h.jsx)(mc,{total:G,current:v,pageSize:10,onChange:x,text:function(e){var t=e.total,a=e.from,n=e.to;return Object(h.jsxs)(h.Fragment,{children:["Showing ",a," to ",n," out of ",t," transactions"]})}})]})]})},yc=function(){var e=Object(c.i)().params.tab,t=void 0===e?"holdings":e,a=Object(c.g)(),r=Object(o.useState)(t),i=Object(n.a)(r,2),s=i[0],l=i[1];return Object(o.useEffect)((function(){t!==s&&l(t)}),[t]),Object(h.jsxs)("div",{className:"container-limit",children:[Object(h.jsx)("div",{className:"card mb-32",children:Object(h.jsx)("div",{className:"card-header pv-0",children:Object(h.jsx)(gt,{tabs:[{id:"holdings",children:"Holdings",onClick:function(){var e;e="holdings",a.push("/governance/treasury/".concat(e))}}],size:"small",activeKey:s,onClick:l})})}),Object(h.jsx)(c.d,{children:Object(h.jsx)(c.b,{path:"/governance/treasury/holdings",exact:!0,component:wc})})]})},kc=a(1912),Nc=a.n(kc),Ac=function(){var e=Object(c.g)(),t=Object(c.i)().params.vt,a=void 0===t?"overview":t,o=Object(q.c)(),i=r.a.useState(a),s=Object(n.a)(i,2),l=s[0],d=s[1];return r.a.useEffect((function(){a!==l&&d(a)}),[a]),Object(h.jsxs)(y.a,{flow:"row",children:[o.account&&Object(h.jsx)(Ye,{}),Object(h.jsxs)(x,{className:Nc.a.tabs,activeKey:l,onChange:function(t){t&&(d(t),e.push("/governance/".concat(t)))},children:[Object(h.jsx)(x.Tab,{tab:Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(k.a,{name:"bar-charts-outlined"})," Overview"]})},"overview"),Object(h.jsx)(x.Tab,{disabled:!o.account,tab:Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(k.a,{name:"wallet-outlined"})," Portfolio"]})},"portfolio"),Object(h.jsx)(x.Tab,{tab:Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(k.a,{name:"proposal-outlined"})," Proposals"]})},"proposals"),Object(h.jsx)(x.Tab,{tab:Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(k.a,{name:"treasury-outlined"})," Treasury"]})},"treasury"),Object(h.jsx)(x.Tab,{tab:Object(h.jsx)(w.d,{href:"https://signal.barnbridge.com/",style:{color:"inherit"},children:Object(h.jsxs)(y.a,{flow:"col",gap:8,align:"center",children:[Object(h.jsx)(k.a,{name:"chats-outlined"}),Object(h.jsx)(N.b,{type:"p1",weight:"semibold",children:"Signal"}),Object(h.jsx)(k.a,{name:"arrow-top-right",width:8,height:8,style:{alignSelf:"start",color:"inherit"}})]})})},"signal"),Object(h.jsx)(x.Tab,{tab:Object(h.jsx)(w.d,{href:"https://forum.barnbridge.com/",style:{color:"inherit"},children:Object(h.jsxs)(y.a,{flow:"col",gap:8,align:"center",children:[Object(h.jsx)(k.a,{name:"forum-outlined"}),Object(h.jsx)(N.b,{type:"p1",weight:"semibold",children:"Forum"}),Object(h.jsx)(k.a,{name:"arrow-top-right",width:8,height:8,style:{alignSelf:"start",color:"inherit"}})]})})},"forum")]}),Object(h.jsx)("div",{className:"content-container-fix content-container",children:Object(h.jsxs)(c.d,{children:[Object(h.jsx)(c.b,{path:"/governance/overview",exact:!0,component:ut}),Object(h.jsx)(c.a,{exact:!0,from:"/governance/portfolio",to:"/governance/portfolio/deposit"}),Object(h.jsx)(c.b,{path:"/governance/portfolio/:action(\\w+)",component:Cn}),Object(h.jsx)(c.a,{exact:!0,from:"/governance/treasury",to:"/governance/treasury/holdings"}),Object(h.jsx)(c.b,{path:"/governance/treasury/:tab(\\w+)",exact:!0,component:yc}),Object(h.jsx)(c.b,{path:"/governance/proposals/create",exact:!0,component:Vo}),Object(h.jsx)(c.b,{path:"/governance/proposals/:id(\\d+)",exact:!0,component:Zr}),Object(h.jsx)(c.b,{path:"/governance/proposals",exact:!0,component:sc}),Object(h.jsx)(c.a,{from:"/governance",to:"/governance/overview"})]})})]})};t.default=function(e){return Object(h.jsx)(L,{children:Object(h.jsx)(be,{children:Object(h.jsx)(Ac,{children:e.children})})})}}}]);
//# sourceMappingURL=7.c845c24e.chunk.js.map
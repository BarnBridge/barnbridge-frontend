{"version":3,"sources":["components/radio-card/index.tsx","components/radio-card/s.module.scss","modules/smart-alpha/views/deposit-view/depositForm.tsx","modules/smart-alpha/views/deposit-view/select.tsx","modules/smart-alpha/views/deposit-view/index.tsx"],"names":["RadioCard","props","children","selected","rest","type","className","cn","s","card","RadioCards","cards","module","exports","DepositForm","pool","smartAlphaContract","poolTokenContract","tranche","useParams","toLowerCase","contracts","useConfig","wallet","useWallet","useTokens","getToken","getAsset","useReload","reload","version","useState","tokenState","setTokenState","depositQueueBalance","setDepositQueueBalance","unclaimedTokens","setUnclaimedTokens","enabling","setEnabling","saving","setSaving","confirmModalVisible","setConfirmModalVisible","isSenior","poolToken","symbol","oracleToken","oracleAssetSymbol","tokenMax","getBalanceOf","unscaleBy","decimals","isPoolTokenEnabled","isAllowedOf","poolAddress","getOrCreateContract","useContractFactory","loupeContract","useMemo","loupeAddress","sa","loupe","LoupeContract","a","approve","address","console","error","gasPrice","amount","BigNumber","from","scaleBy","depositSenior","depositJunior","call","useEffect","account","loadBalance","loadAllowance","seniorEntryQueue","juniorEntryQueue","then","getUserRedeemableSeniorTokens","getUserRedeemableJuniorTokens","weight","color","tag","classNames","depositBalance","text","formatToken","name","icon","size","outline","bubble1Name","bubble2Name","before","value","onChange","slider","max","placeholder","variation","disabled","onClick","title","header","submitText","onCancel","onConfirm","handleDeposit","SelectTranche","location","useLocation","setTranche","width","height","to","pathname","DepositView","id","useFetchPool","data","Listeners","SmartAlphaContract","afterInit","contract","onUpdateData","loadCommon","Erc20Contract","on","Web3Contract","UPDATE_DATA","style","margin","path","exact","iconPosition","iconRotate","poolName","state","epoch","fallback"],"mappings":"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","file":"static/js/sa-deposit-view.1760b635.chunk.js","sourcesContent":["import React from 'react';\nimport cn from 'classnames';\n\nimport s from './s.module.scss';\n\ntype Props = {\n  children?: any;\n  selected?: boolean;\n  onClick: (e: any) => void;\n};\n\nexport const RadioCard: React.FC<Props> = props => {\n  const { children, selected = false, ...rest } = props;\n\n  return (\n    <button type=\"button\" className={cn(s.card, { [s.selected]: selected })} {...rest}>\n      {children}\n    </button>\n  );\n};\n\nexport const RadioCards: React.FC<{ className?: string }> = ({ className, ...rest }) => (\n  <div className={cn(s.cards, className)} {...rest} />\n);\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"cards\":\"s_cards__SMmvy\",\"card\":\"s_card__3ZxAU\",\"selected\":\"s_selected__5uLwB\"};","import { useEffect, useMemo, useState } from 'react';\nimport { useParams } from 'react-router-dom';\nimport BigNumber from 'bignumber.js';\nimport classNames from 'classnames';\nimport TxConfirmModal from 'web3/components/tx-confirm-modal';\nimport Erc20Contract from 'web3/erc20Contract';\nimport { formatToken } from 'web3/utils';\n\nimport { Alert } from 'components/alert';\nimport { Button } from 'components/button';\nimport { Spinner } from 'components/custom/spinner';\nimport { TokenAmount } from 'components/custom/token-amount-new';\nimport { Hint, Text } from 'components/custom/typography';\nimport { Icon } from 'components/icon';\nimport { useConfig } from 'components/providers/configProvider';\nimport { useTokens } from 'components/providers/tokensProvider';\nimport { TokenIcon } from 'components/token-icon';\nimport { useContractFactory } from 'hooks/useContract';\nimport { useReload } from 'hooks/useReload';\nimport { PoolApiType } from 'modules/smart-alpha/api';\nimport LoupeContract from 'modules/smart-alpha/contracts/loupeContract';\nimport SmartAlphaContract from 'modules/smart-alpha/contracts/smartAlphaContract';\nimport { useWallet } from 'wallets/walletProvider';\n\nimport s from './s.module.scss';\n\ntype Props = {\n  pool: PoolApiType;\n  smartAlphaContract: SmartAlphaContract | undefined;\n  poolTokenContract: Erc20Contract | undefined;\n};\n\nexport const DepositForm = ({ pool, smartAlphaContract, poolTokenContract }: Props) => {\n  const params = useParams<{ tranche: 'senior' | 'junior' }>();\n  const tranche = params.tranche.toLowerCase();\n\n  const { contracts } = useConfig();\n  const wallet = useWallet();\n  const { getToken, getAsset } = useTokens();\n  const [reload, version] = useReload();\n\n  const [tokenState, setTokenState] = useState('');\n  const [depositQueueBalance, setDepositQueueBalance] = useState<BigNumber | undefined>();\n  const [unclaimedTokens, setUnclaimedTokens] = useState<BigNumber | undefined>();\n  const [enabling, setEnabling] = useState(false);\n  const [saving, setSaving] = useState(false);\n  const [confirmModalVisible, setConfirmModalVisible] = useState(false);\n\n  const isSenior = tranche === 'senior';\n  const poolToken = getToken(pool.poolToken.symbol);\n  const oracleToken = getAsset(pool.oracleAssetSymbol);\n  const tokenMax = poolTokenContract?.getBalanceOf()?.unscaleBy(pool.poolToken.decimals);\n  const isPoolTokenEnabled = poolTokenContract?.isAllowedOf(pool.poolAddress);\n\n  const { getOrCreateContract } = useContractFactory();\n\n  const loupeContract = useMemo<LoupeContract | undefined>(() => {\n    const loupeAddress = contracts.sa?.loupe;\n\n    if (!loupeAddress) {\n      return undefined;\n    }\n\n    return getOrCreateContract(loupeAddress, () => {\n      return new LoupeContract(loupeAddress);\n    });\n  }, [contracts.sa?.loupe]);\n\n  useEffect(() => {\n    if (!wallet.account) {\n      return;\n    }\n\n    poolTokenContract?.loadBalance();\n    poolTokenContract?.loadAllowance(pool.poolAddress);\n\n    (isSenior ? smartAlphaContract?.seniorEntryQueue : smartAlphaContract?.juniorEntryQueue)\n      ?.call(smartAlphaContract, wallet.account)\n      .then(([epoch, amount]) => {\n        setDepositQueueBalance(amount);\n      });\n\n    (isSenior ? loupeContract?.getUserRedeemableSeniorTokens : loupeContract?.getUserRedeemableJuniorTokens)\n      ?.call(loupeContract, smartAlphaContract?.address!, wallet.account)\n      .then(amount => {\n        setUnclaimedTokens(amount);\n      });\n  }, [wallet.account, version]);\n\n  async function handlePoolTokenEnable() {\n    setEnabling(true);\n\n    try {\n      await poolTokenContract?.approve(smartAlphaContract?.address, true);\n    } catch (e) {\n      console.error(e);\n    }\n\n    setEnabling(false);\n  }\n\n  async function handleDeposit(gasPrice?: number) {\n    setConfirmModalVisible(false);\n    setSaving(true);\n\n    try {\n      const amount = BigNumber.from(tokenState)?.scaleBy(pool.poolToken.decimals);\n\n      if (amount) {\n        await (isSenior ? smartAlphaContract?.depositSenior : smartAlphaContract?.depositJunior)?.call(\n          smartAlphaContract,\n          amount,\n          gasPrice,\n        );\n        setTokenState('');\n        reload();\n      }\n    } catch (e) {\n      console.error(e);\n    }\n\n    setSaving(false);\n  }\n\n  return (\n    <div className=\"card p-24\">\n      <Text type=\"h3\" weight=\"bold\" color=\"primary\" tag=\"h3\" className=\"mb-16\">\n        {isSenior ? 'Senior' : 'Junior'} deposit\n      </Text>\n      <Text type=\"p2\" weight=\"semibold\" color=\"secondary\" tag=\"p\" className=\"mb-32\">\n        Choose the amount of tokens you want to deposit in the {tranche} side. Make sure you double check the amounts.\n      </Text>\n\n      <div className={classNames(s.depositBalance, 'flex col-gap-32 mb-32')}>\n        <div>\n          <Hint\n            text={`This amount of ${pool.poolToken.symbol} is already in the deposit queue and will be considered towards your overall position in the next epoch.`}\n            className=\"mb-4\">\n            <Text type=\"small\" weight=\"semibold\" color=\"secondary\">\n              Balance in deposit queue\n            </Text>\n          </Hint>\n          <Text type=\"p1\" weight=\"semibold\" color=\"primary\" className=\"flex align-center\">\n            {formatToken(depositQueueBalance?.unscaleBy(pool.poolToken.decimals)) ?? '-'}\n            <TokenIcon name={poolToken?.icon} size={16} className=\"ml-8\" />\n          </Text>\n        </div>\n        <div>\n          <Hint\n            text={`This amount of ${\n              isSenior ? 'senior' : 'junior'\n            } tokens is available to be redeemed from your deposits made in either the ongoing or previous epochs. It will be automatically redeemed if you add more ${\n              pool.poolToken.symbol\n            } to the deposit queue.`}\n            className=\"mb-4\">\n            <Text type=\"small\" weight=\"semibold\" color=\"secondary\">\n              Unclaimed {tranche} tokens\n            </Text>\n          </Hint>\n          <Text type=\"p1\" weight=\"semibold\" color=\"primary\" className=\"flex align-center\">\n            {formatToken(unclaimedTokens?.unscaleBy(pool.poolToken.decimals)) ?? '-'}\n            <TokenIcon\n              className=\"ml-8\"\n              name={poolToken?.icon}\n              outline={isSenior ? 'green' : 'purple'}\n              bubble1Name=\"bond\"\n              bubble2Name={oracleToken?.icon}\n              size={16}\n            />\n          </Text>\n        </div>\n      </div>\n\n      <Text type=\"small\" weight=\"semibold\" color=\"secondary\" className=\"mb-8\">\n        {pool.poolToken.symbol} amount\n      </Text>\n      <TokenAmount\n        before={<TokenIcon name={poolToken?.icon} size={24} />}\n        value={tokenState}\n        onChange={setTokenState}\n        slider\n        max={tokenMax}\n        placeholder={`0 (Max ${tokenMax ?? 0})`}\n        className=\"mb-32\"\n      />\n\n      <Alert type=\"info\" className=\"mb-32\">\n        Deposits made during an epoch will be added to the deposit queue and will count toward your position in the next\n        epoch.\n      </Alert>\n\n      <div className=\"flex justify-end align-center\">\n        {isPoolTokenEnabled === false && (\n          <>\n            <Button variation=\"primary\" disabled={enabling} onClick={handlePoolTokenEnable}>\n              {enabling && <Spinner className=\"mr-8\" />}\n              Enable {pool.poolToken.symbol}\n            </Button>\n            <Icon name=\"chevron\" size={16} color=\"icon\" className=\"ml-12 mr-12\" />\n          </>\n        )}\n        <Button\n          variation=\"primary\"\n          disabled={saving || !isPoolTokenEnabled || !tokenState}\n          onClick={() => setConfirmModalVisible(true)}>\n          {saving && <Spinner className=\"mr-8\" />}\n          Deposit\n        </Button>\n      </div>\n\n      {confirmModalVisible && (\n        <TxConfirmModal\n          title=\"Initiate deposit\"\n          header={\n            <div className=\"flex flow-row row-gap-16\">\n              <Text type=\"p2\" weight=\"semibold\" color=\"secondary\">\n                Your balance of{' '}\n                <Text tag=\"span\" type=\"p2\" weight=\"bold\" color=\"primary\">\n                  {formatToken(BigNumber.from(tokenState), { decimals: pool.poolToken.decimals })}{' '}\n                  {pool.poolToken.symbol}\n                </Text>{' '}\n                will be added to the deposit queue for the next epoch.\n              </Text>\n              <div className=\"container-box flex flow-col col-gap-32\">\n                <div className=\"flex flow-row\">\n                  <Text type=\"small\" weight=\"semibold\" color=\"secondary\" className=\"mb-4\">\n                    Deposited amount\n                  </Text>\n                  <Text type=\"p1\" weight=\"semibold\" color=\"primary\" className=\"flex align-center\">\n                    {formatToken(BigNumber.from(tokenState)) ?? '-'}\n                    <TokenIcon name={poolToken?.icon} size={16} className=\"ml-8\" />\n                  </Text>\n                </div>\n                <div className=\"flex flow-row\">\n                  <Text type=\"small\" weight=\"semibold\" color=\"secondary\" className=\"mb-4\">\n                    Redeemable unclaimed tokens\n                  </Text>\n                  <Text type=\"p1\" weight=\"semibold\" color=\"primary\" className=\"flex align-center\">\n                    {formatToken(unclaimedTokens?.unscaleBy(pool.poolToken.decimals)) ?? '-'}\n                    <TokenIcon\n                      name={poolToken?.icon}\n                      bubble1Name=\"bond\"\n                      bubble2Name={oracleToken?.icon}\n                      outline={isSenior ? 'green' : 'purple'}\n                      className=\"ml-8\"\n                    />\n                  </Text>\n                </div>\n              </div>\n            </div>\n          }\n          submitText=\"Confirm your deposit\"\n          onCancel={() => setConfirmModalVisible(false)}\n          onConfirm={({ gasPrice }) => handleDeposit(gasPrice)}\n        />\n      )}\n    </div>\n  );\n};\n","import { useState } from 'react';\nimport { useLocation } from 'react-router-dom';\n\nimport { Alert } from 'components/alert';\nimport { Link } from 'components/button';\nimport Icon from 'components/custom/icon';\nimport { Text } from 'components/custom/typography';\nimport { RadioCard, RadioCards } from 'components/radio-card';\nimport { PoolApiType } from 'modules/smart-alpha/api';\n\nexport const SelectTranche = ({ pool }: { pool: PoolApiType }) => {\n  const location = useLocation();\n  const [tranche, setTranche] = useState<'senior' | 'junior' | undefined>();\n\n  return (\n    <div className=\"card p-24\">\n      <Text type=\"h3\" weight=\"bold\" color=\"primary\" tag=\"h3\" className=\"mb-16\">\n        Select your preferred side\n      </Text>\n      <Text type=\"p2\" weight=\"semibold\" color=\"secondary\" tag=\"p\" className=\"mb-32\">\n        You can choose between senior or junior positions. Be aware of the risk involved and read the warnings before\n        going further.\n      </Text>\n      <RadioCards className=\"mb-32\">\n        <RadioCard selected={tranche === 'senior'} onClick={() => setTranche('senior')}>\n          <Icon name=\"senior-side\" width={64} height={64} className=\"mb-24\" />\n          <Text type=\"p1\" weight=\"semibold\" color=\"primary\" className=\"mb-8\">\n            Senior side\n          </Text>\n        </RadioCard>\n        <RadioCard selected={tranche === 'junior'} onClick={() => setTranche('junior')}>\n          <Icon name=\"junior-side\" width={64} height={64} className=\"mb-24\" />\n          <Text type=\"p1\" weight=\"semibold\" color=\"primary\" className=\"mb-8\">\n            Junior side\n          </Text>\n        </RadioCard>\n      </RadioCards>\n\n      {tranche === 'senior' ? (\n        <Alert type=\"warning\" className=\"mb-32\">\n          Senior positions offer dampened exposure to the underlying asset's price volatility. Because the position's\n          upside exposure is limited and its downside is protected, it will experience low volatility relative to the\n          underlying asset.\n        </Alert>\n      ) : null}\n      {tranche === 'junior' ? (\n        <Alert type=\"warning\" className=\"mb-32\">\n          Junior positions offer leveraged exposure to the underlying asset's price volatility. The junior positions\n          have amplified exposure to both upside and downside price volatility. Upside and downside leverage are NOT\n          symmetrical and both will vary week-to-week.\n        </Alert>\n      ) : null}\n\n      <div className=\"flex\">\n        <Link to={`${location.pathname}/${tranche}`} variation=\"primary\" aria-disabled={!tranche} className=\"ml-auto\">\n          Next step\n        </Link>\n      </div>\n    </div>\n  );\n};\n","import { Suspense, useMemo } from 'react';\nimport { Redirect, Route, Switch, useParams } from 'react-router-dom';\nimport Erc20Contract from 'web3/erc20Contract';\nimport { formatToken } from 'web3/utils';\nimport Web3Contract from 'web3/web3Contract';\n\nimport { Link } from 'components/button';\nimport { Spinner } from 'components/custom/spinner';\nimport { Text } from 'components/custom/typography';\nimport { useTokens } from 'components/providers/tokensProvider';\nimport { TokenIcon } from 'components/token-icon';\nimport { useContractFactory } from 'hooks/useContract';\nimport { useReload } from 'hooks/useReload';\nimport { useFetchPool } from 'modules/smart-alpha/api';\nimport SmartAlphaContract from 'modules/smart-alpha/contracts/smartAlphaContract';\nimport { DepositForm } from 'modules/smart-alpha/views/deposit-view/depositForm';\n\nimport { SelectTranche } from './select';\n\nconst DepositView = () => {\n  const { id: poolAddress } = useParams<{ id: string }>();\n  const [reload] = useReload();\n  const { data: pool } = useFetchPool(poolAddress);\n  const { getToken, getAsset } = useTokens();\n\n  const { getOrCreateContract, Listeners } = useContractFactory();\n\n  const smartAlphaContract = useMemo(() => {\n    if (!pool) {\n      return;\n    }\n\n    return getOrCreateContract(\n      pool.poolAddress,\n      () => {\n        return new SmartAlphaContract(pool.poolAddress);\n      },\n      {\n        afterInit: async contract => {\n          contract.onUpdateData(reload);\n          await contract.loadCommon();\n        },\n      },\n    );\n  }, [pool]);\n\n  const poolTokenContract = useMemo(() => {\n    if (!pool) {\n      return;\n    }\n\n    return getOrCreateContract(\n      pool.poolToken.address,\n      () => {\n        const contract = new Erc20Contract([], pool.poolToken.address);\n        contract.on(Web3Contract.UPDATE_DATA, reload);\n        return contract;\n      },\n      {\n        afterInit: async contract => {\n          await contract.loadBalance();\n        },\n      },\n    );\n  }, [pool?.poolToken.address]);\n\n  if (!pool) {\n    return <Spinner style={{ margin: 'auto' }} />;\n  }\n\n  const poolToken = getToken(pool.poolToken.symbol);\n  const oracleToken = getAsset(pool.oracleAssetSymbol);\n\n  return (\n    <>\n      <div className=\"container-fit\">\n        <div className=\"mb-16\">\n          <Switch>\n            <Route path=\"/smart-alpha/pools/:id/deposit\" exact>\n              <Link\n                to={`/smart-alpha/pools/${poolAddress}`}\n                variation=\"text-alt\"\n                icon=\"arrow\"\n                iconPosition=\"left\"\n                iconRotate={180}>\n                Pool details\n              </Link>\n            </Route>\n            <Route path=\"/smart-alpha/pools/:id/deposit\">\n              <Link\n                to={`/smart-alpha/pools/${poolAddress}/deposit`}\n                variation=\"text-alt\"\n                icon=\"arrow\"\n                iconPosition=\"left\"\n                iconRotate={180}>\n                Sides\n              </Link>\n            </Route>\n          </Switch>\n        </div>\n        <div className=\"flex col-gap-64 align-center mb-32\">\n          <div className=\"flex align-center\">\n            <TokenIcon name={poolToken?.icon} size={40} bubble2Name={oracleToken?.icon} className=\"mr-16\" />\n            <div>\n              <Text type=\"p1\" weight=\"semibold\" color=\"primary\" tag=\"h2\" className=\"mb-4\">\n                {pool.poolName}\n              </Text>\n              <Text type=\"small\" weight=\"semibold\" color=\"red\">\n                Epoch {pool.state.epoch}\n              </Text>\n            </div>\n          </div>\n          <div>\n            <Text type=\"small\" weight=\"semibold\" color=\"secondary\" className=\"mb-4\">\n              Wallet balance\n            </Text>\n            <div className=\"flex align-center\">\n              <Text type=\"p1\" weight=\"semibold\" color=\"primary\" className=\"mr-4\">\n                {formatToken(poolTokenContract?.getBalanceOf()?.unscaleBy(pool.poolToken.decimals)) ?? '-'}\n              </Text>\n              <Text type=\"small\" weight=\"semibold\" color=\"secondary\">\n                {pool.poolToken.symbol}\n              </Text>\n            </div>\n          </div>\n          <Switch>\n            <Route path=\"/smart-alpha/pools/:id/deposit/senior\">\n              <div>\n                <Text type=\"small\" weight=\"semibold\" color=\"secondary\" className=\"mb-4\">\n                  Side\n                </Text>\n                <Text type=\"p1\" weight=\"semibold\" color=\"primary\" className=\"mr-4\">\n                  Senior\n                </Text>\n              </div>\n            </Route>\n            <Route path=\"/smart-alpha/pools/:id/deposit/junior\">\n              <div>\n                <Text type=\"small\" weight=\"semibold\" color=\"secondary\" className=\"mb-4\">\n                  Side\n                </Text>\n                <Text type=\"p1\" weight=\"semibold\" color=\"primary\" className=\"mr-4\">\n                  Junior\n                </Text>\n              </div>\n            </Route>\n          </Switch>\n        </div>\n        <Suspense fallback={<Spinner />}>\n          <Switch>\n            <Route path=\"/smart-alpha/pools/:id/deposit\" exact>\n              <SelectTranche pool={pool} />\n            </Route>\n            <Route path=\"/smart-alpha/pools/:id/deposit/:tranche(senior|junior)\" exact>\n              <DepositForm pool={pool} smartAlphaContract={smartAlphaContract} poolTokenContract={poolTokenContract} />\n            </Route>\n            <Redirect to={`/smart-alpha/pools/${poolAddress}/deposit`} />\n          </Switch>\n        </Suspense>\n      </div>\n      {Listeners}\n    </>\n  );\n};\n\nexport default DepositView;\n"],"sourceRoot":""}
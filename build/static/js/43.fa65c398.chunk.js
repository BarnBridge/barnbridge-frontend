(this["webpackJsonpbarnbridge-frontend"]=this["webpackJsonpbarnbridge-frontend"]||[]).push([[43],{1356:function(e,t,n){"use strict";var a=n(4),c=n(17),o=(n(0),n(1364)),s=n.n(o),l=n(8),r=n.n(l),i=n(33),d=n(48),u=n(99),b=n(1360),m=n.n(b),j=n(1),f=["children"],O=["className","label","hint","extra","children"],p=["className","children"],v=function(e){var t=e.className,n=e.children,o=Object(c.a)(e,p);return Object(j.jsx)(s.a,Object(a.a)(Object(a.a)({className:r()(m.a.form,t),layout:"vertical",requiredMark:!1},o),{},{children:n}))};v.Item=function(e){var t=e.className,n=e.label,o=e.hint,l=e.extra,b=e.children,f=Object(c.a)(e,O);return Object(j.jsx)(s.a.Item,Object(a.a)(Object(a.a)({className:r()(m.a.item,t)},f),{},{label:Object(j.jsxs)(j.Fragment,{children:[Object(j.jsxs)(d.a,{flow:"col",gap:4,align:"center",children:[n,o&&Object(j.jsx)(u.a,{title:o,children:Object(j.jsx)("span",{children:Object(j.jsx)(i.a,{name:"info",size:15})})})]}),l]}),children:b}))},v.List=function(e){var t=e.children,n=Object(c.a)(e,f);return Object(j.jsx)(s.a.List,Object(a.a)(Object(a.a)({},n),{},{children:t}))},t.a=v},1357:function(e,t,n){"use strict";var a=n(4),c=n(17),o=(n(0),n(1393)),s=n.n(o),l=n(8),r=n.n(l),i=n(1362),d=n.n(i),u=n(1),b=["className"];t.a=function(e){var t=e.className,n=Object(c.a)(e,b);return Object(u.jsx)(s.a,Object(a.a)({className:r()(d.a.divider,t)},n))}},1360:function(e,t,n){e.exports={form:"s_form__36nMg",item:"s_item__2gbuN"}},1361:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(4),c=n(17),o=n(8),s=n.n(o),l=n(33),r=n(1429),i=n.n(r),d=n(1),u=["className","children","spinning"],b=function(e){var t=e.className,n=e.children,o=e.spinning,r=Object(c.a)(e,u);return n?o?Object(d.jsxs)("div",{className:i.a.container,children:[Object(d.jsx)("div",{className:i.a.children,children:n}),Object(d.jsx)(l.a,Object(a.a)({name:"loader",className:s()(i.a.spinner,t)},r))]}):Object(d.jsx)(d.Fragment,{children:n}):Object(d.jsx)(l.a,Object(a.a)({name:"loader",className:s()(i.a.spinner,t)},r))}},1362:function(e,t,n){e.exports={divider:"s_divider__3YM-J"}},1365:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return v})),n.d(t,"c",(function(){return h}));var a=n(5),c=n(0),o=n(423),s=n(419),l=n.n(s),r=n(425),i=n(80),d=n(37),u=n(20),b=n(73),m=n(66),j=n(116),f=n(1);function O(e){var t=Object(c.useRef)();return l()(e,t.current)||(t.current=e),t.current}var p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.loadBalance,o=t.loadCommon,s=t.loadAllowance,l=Object(b.c)(),r=l.provider,u=l.account,f=Object(j.a)(),p=Object(a.a)(f,1),v=p[0],h=Object(m.c)(),x=h.getContract,y=Object(c.useMemo)((function(){if(!e)return null;var t=x(e,(function(){return new i.a([],e)}));return t.on(d.d.UPDATE_DATA,v),t}),[e,r,v]);Object(c.useEffect)((function(){y&&n&&(y.setAccount(u),y.loadBalance())}),[y,n,u]),Object(c.useEffect)((function(){y&&o&&y.loadCommon().then((function(){return v()})).catch(Error)}),[y,o,v]);var k=O(s);return Object(c.useEffect)((function(){y&&k&&(Array.isArray(k)?k.forEach((function(e){return y.loadAllowance(e)})):y.loadAllowance(k))}),[y,k]),y};function v(e){var t=(null!==e&&void 0!==e?e:{}).listeners,n=void 0===t||t,s=Object(b.c)(),l=s.account,i=s.provider,d=Object(u.h)().activeProvider,m=Object(j.a)(),O=Object(a.a)(m,2),p=O[0],v=O[1],h=Object(c.useRef)(d),x=Object(c.useRef)(i),y=Object(c.useRef)(l),k=Object(c.useRef)(new Map),g=Object(c.useCallback)((function(e,t,n){var a,c=t();return c.setCallProvider(h.current),c.setProvider(x.current),c.setAccount(y.current),k.current.set(e,{address:e,factory:t,options:n,instance:c}),null===n||void 0===n||null===(a=n.afterInit)||void 0===a||a.call(n,c),p(),c}),[d,l,p]),N=Object(o.a)((function(){k.current.forEach((function(e){var t,n;null===(t=e.options)||void 0===t||null===(n=t.onDestroy)||void 0===n||n.call(t,e.instance),g(e.address,(function(){return e.instance}),e.options)}))}),250);h.current!==d&&(h.current=d,N()),x.current!==i&&(x.current=i,N()),y.current!==l&&(y.current=l,N());var w=Object(c.useCallback)((function(e,t,n){return k.current.has(e)?k.current.get(e).instance:g(e,t,n)}),[g]);return{getOrCreateContract:w,getContract:Object(c.useCallback)((function(e){if(k.current.has(e))return k.current.get(e).instance}),[g]),Listeners:Object(c.useMemo)((function(){return n?Object(f.jsx)(f.Fragment,{children:Array.from(k.current).map((function(e){var t=Object(a.a)(e,2),n=t[0],c=t[1];return Object(f.jsx)(r.a,{contract:c.instance},n)}))}):null}),[v,n])}}function h(e,t){return v({listeners:!1}).getOrCreateContract("$address",e,t)}},1378:function(e,t,n){"use strict";var a=n(4),c=n(17),o=(n(0),n(1461)),s=n.n(o),l=n(8),r=n.n(l),i=n(1430),d=n.n(i),u=n(1),b=["className","disabled"];t.a=function(e){var t=e.className,n=e.disabled,o=Object(c.a)(e,b);return Object(u.jsx)(s.a,Object(a.a)({className:r()(d.a.component,t,n&&d.a.disabled),disabled:n,autoComplete:"off"},o))}},1383:function(e,t,n){"use strict";n.d(t,"a",(function(){return w})),n.d(t,"b",(function(){return A})),n.d(t,"c",(function(){return _}));var a=n(15),c=n(4),o=n(13),s=n(17),l=n(0),r=n(19),i=n.n(r),d=n(8),u=n.n(d),b=n(1394),m=n(1402),j=n.n(m),f=n(1),O=["className","value"],p=function(e){var t=e.className,n=e.value,a=Object(s.a)(e,O),o=Number(a.max)||0,l=Math.floor(1e6*o)/1e6,r=Math.floor(1e6*Number(n))/1e6/l*100||0,i=0===l;return Object(f.jsx)("input",Object(c.a)(Object(c.a)({},a),{},{type:"range",className:u()(j.a.input,t),style:{"--track-fill":"".concat(i?0:r,"%")},max:i?1:l,disabled:i,value:i?"0":n||"0"}))},v=n(12),h=n(33),x=n(183),y=n(415),k=n(1403),g=n.n(k),N=["onChange","before","secondary","className","classNameBefore","slider","errors","decimals","max"],w=Object(l.forwardRef)((function(e,t){var n,a,l=e.onChange,r=e.before,d=e.secondary,b=e.className,m=e.classNameBefore,j=e.slider,O=e.errors,h=void 0===O?[]:O,x=e.decimals,y=void 0===x?6:x,k=e.max,w=Object(s.a)(e,N),A=null!==(n=i.a.from(k))&&void 0!==n?n:i.a.ZERO;return Object(f.jsxs)("div",{className:b,children:[Object(f.jsxs)("div",{className:u()(g.a.tokenAmount,Object(o.a)({},g.a.error,h.length)),children:[r&&Object(f.jsx)("div",{className:u()(g.a.tokenAmountBefore,m),children:r}),Object(f.jsxs)("div",{className:g.a.tokenAmountValues,children:[Object(f.jsx)("input",Object(c.a)({ref:t,className:g.a.tokenAmountValue,type:"text",inputMode:"decimal",pattern:"[0-9]+([\\.,][0-9]+)?",onWheel:function(e){e.currentTarget.blur()},onChange:function(e){l(e.target.value)}},w)),Object(f.jsx)("div",{className:g.a.tokenAmountHint,children:d})]}),!A.isZero()&&Object(f.jsx)("button",{type:"button",className:"button-ghost",style:{alignSelf:"center"},disabled:w.disabled||A.isZero(),onClick:function(){return l(A.toString())},children:"MAX"})]}),!!h.length&&h.map((function(e,t){return Object(f.jsx)(v.b,{type:"small",weight:"semibold",color:"red",style:{marginTop:"8px"},children:e},t)})),j&&!A.isZero()?Object(f.jsx)(p,{type:"range",className:g.a.tokenAmountSlider,min:"0",max:A.toString(),step:1/Math.pow(10,Math.min(y,6)),value:null!==(a=w.value)&&void 0!==a?a:0,disabled:w.disabled||A.isZero(),onChange:function(e){l(e.target.value)}}):null]})})),A=function(e){var t=e.value,n=e.before,a=e.secondary,c=e.className,o=e.classNameBefore;return Object(f.jsxs)("div",{className:u()(g.a.tokenAmountPreview,c),children:[n&&Object(f.jsx)("div",{className:u()(g.a.tokenAmountPreviewBefore,o),children:n}),Object(f.jsxs)("div",{className:g.a.tokenAmountPreviewValues,children:[Object(f.jsx)("input",{className:g.a.tokenAmountPreviewValue,type:"text",value:t||"",readOnly:!0}),Object(f.jsx)("div",{className:g.a.tokenAmountPreviewHint,children:a})]})]})},_=function(e){var t=e.value,n=e.onChange,c=e.tokens,o=e.className,s=e.style,l=Object(x.c)().getTokenBySymbol,r=l(t);return Object(f.jsx)(b.b,{items:c.reduce((function(e,t){var c,o,s=l(t);return s?[].concat(Object(a.a)(e),[{onClick:function(){n(t)},children:Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(y.a,{name:null===(c=l(t))||void 0===c?void 0:c.icon,className:"mr-8"}),null===(o=l(t))||void 0===o?void 0:o.name]}),"aria-selected":(null===r||void 0===r?void 0:r.symbol)===s.symbol?"true":"false"}]):e}),[]),children:function(e){var t=e.ref,n=e.setOpen,a=e.open;return Object(f.jsxs)("button",{type:"button",ref:t,onClick:function(){return n((function(e){return!e}))},className:u()(g.a.tokenAmountSelectToken,o),style:s,children:[r?Object(f.jsx)(y.a,{name:r.icon,size:24,className:"mr-16"}):null,Object(f.jsx)(v.b,{type:"p1",weight:"semibold",color:"primary",children:null===r||void 0===r?void 0:r.symbol}),Object(f.jsx)(h.a,{name:a?"dropdown-active":"dropdown",size:"24",className:"token-select-chevron",style:{marginLeft:4}})]})}})}},1394:function(e,t,n){"use strict";n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return N}));var a=n(17),c=n(4),o=n(5),s=n(0),l=n.n(s),r=n(51),i=n.n(r),d=n(2286),u=n(58),b=n(8),m=n.n(b),j=n(1545),f=n.n(j),O=n(33),p=n(1397),v=n.n(p),h=n(1),x=["onClick"],y=[{name:"offset",options:{offset:[0,8]}},{name:"sameWidth",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(e){var t=e.state;t.styles.popper.minWidth="".concat(t.rects.reference.width,"px")},effect:function(e){var t=e.state;t.elements.popper.style.minWidth="".concat(t.elements.reference.offsetWidth,"px")}}],k=function(e){var t=e.content,n=e.children,a=e.options,s=l.a.useState(!1),r=Object(o.a)(s,2),u=r[0],b=r[1],m=l.a.useRef(null),j=l.a.useRef(null),O=Object(d.a)(m.current,j.current,Object(c.a)({placement:"bottom-start",strategy:"absolute",modifiers:y},a)),p=O.styles,v=O.attributes,x=O.forceUpdate;return l.a.useEffect((function(){var e;if(x&&x(),u){var t=[],n=m.current;n&&t.push(n);var a=j.current;a&&t.push(a),e=f()(t,["click","touchstart"],(function(){return b(!1)}))}return function(){var t;null===(t=e)||void 0===t||t.remove()}}),[u]),Object(h.jsxs)(h.Fragment,{children:[n({ref:m,setOpen:b,open:u}),i.a.createPortal(Object(h.jsx)("div",Object(c.a)(Object(c.a)({ref:j,style:Object(c.a)(Object(c.a)({},p.popper),{},{display:u?"":"none"})},v.popper),{},{children:t(b)})),document.querySelector("#tooltip-root")||document.body)]})},g=function(e){var t=e.items,n=e.children,o=e.options;return Object(h.jsx)(k,{content:function(e){return Object(h.jsx)("ul",{className:v.a.tokenSelectList,children:t.map((function(t,n){var o=t.onClick,s=Object(a.a)(t,x);return s.href?Object(h.jsx)("li",{children:Object(h.jsx)("a",Object(c.a)(Object(c.a)({href:s.href},s),{},{className:v.a.tokenSelectListButton,onClick:function(t){e(!1)},children:s.children}))},n):s.to?Object(h.jsx)("li",{children:Object(h.jsx)(u.b,Object(c.a)(Object(c.a)({},s),{},{className:v.a.tokenSelectListButton,onClick:function(t){e(!1)}}))},n):Object(h.jsx)("li",{children:Object(h.jsx)("button",Object(c.a)(Object(c.a)({},s),{},{className:v.a.tokenSelectListButton,onClick:function(t){o&&o(t),e(!1)}}))},n)}))})},options:o,children:n})},N=function(e){var t=e.items,n=e.children,a=e.className,c=e.size,o=void 0===c?"normal":c,s=e.style;return Object(h.jsx)(g,{items:t,children:function(e){var t=e.ref,c=e.setOpen,l=e.open;return Object(h.jsxs)("button",{type:"button",ref:t,onClick:function(){return c((function(e){return!e}))},className:m()(v.a.dropdown,v.a[o],a),style:s,children:[Object(h.jsx)("div",{className:"flex align-center flex-grow pr-16",children:n}),Object(h.jsx)(O.a,{name:"dropdown",size:"24",className:v.a.dropdownChevron,style:{transform:l?"rotate(180deg)":""}})]})}})}},1397:function(e,t,n){e.exports={tokenSelectList:"s_tokenSelectList__1rsig",tokenSelectListButton:"s_tokenSelectListButton__898YC",active:"s_active__1VA0m",dropdown:"s_dropdown__2I7kF",large:"s_large__uF7P8",dropdownChevron:"s_dropdownChevron__3cfM7"}},1402:function(e,t,n){e.exports={input:"s_input__1b3rZ"}},1403:function(e,t,n){e.exports={tokenAmount:"s_tokenAmount__2n5WY",error:"s_error__3x3RW",tokenAmountBefore:"s_tokenAmountBefore__3YeAZ",tokenAmountValues:"s_tokenAmountValues__1qT2P",tokenAmountValue:"s_tokenAmountValue__2mG1w",tokenAmountHint:"s_tokenAmountHint__3Jk8f",tokenAmountSlider:"s_tokenAmountSlider__2LNhd",tokenAmountPreview:"s_tokenAmountPreview__1qEON",tokenAmountPreviewBefore:"s_tokenAmountPreviewBefore__2ZTVO",tokenAmountPreviewValues:"s_tokenAmountPreviewValues__3WU83",tokenAmountPreviewValue:"s_tokenAmountPreviewValue__2CGmA",tokenAmountPreviewHint:"s_tokenAmountPreviewHint__1XGYo",tokenSelectTrigger:"s_tokenSelectTrigger__39PsM",tokenSelectChevron:"s_tokenSelectChevron__3_diD",tokenSelectListButton:"s_tokenSelectListButton__qrRSq",active:"s_active__hEyw6",tokenAmountSelectToken:"s_tokenAmountSelectToken__8QBHp"}},1429:function(e,t,n){e.exports={spinner:"s_spinner__2lxg5",rotate:"s_rotate__K9I_G",container:"s_container__2DwVy",children:"s_children__1ZC_G"}},1430:function(e,t,n){e.exports={component:"s_component__2HckH",disabled:"s_disabled__3ybza"}},1456:function(e,t,n){"use strict";var a=n(5),c=n(0),o=n.n(c),s=n(2287),l=n(8),r=n.n(l),i=n(74),d=n(1357),u=n(1356),b=n(1378),m=n(214),j=n(12),f=n(33),O=n(1457),p=n.n(O),v=n(1),h=[.1,.3,.5],x=function(e){var t=e.showSlippage,n=e.slippage,c=e.showDeadline,l=e.deadline,r=e.onChange,d=s.a.useForm(),m=Object(a.a)(d,1)[0],f=o.a.useCallback((function(e){if(e.deadline){var t=String(e.deadline).slice(0,6);m.setFieldsValue({deadline:Number(t)})}}),[]),O=o.a.useCallback((function(){m.resetFields()}),[]),x=o.a.useCallback((function(e){null===r||void 0===r||r(e)}),[]);return Object(v.jsx)(u.a,{form:m,initialValues:{slippage:n,deadline:l},validateTrigger:["onSubmit"],onValuesChange:f,onFinish:x,children:Object(v.jsxs)("div",{className:"grid flow-row row-gap-32",children:[t&&Object(v.jsx)(u.a.Item,{label:"Slippage tolerance",children:Object(v.jsxs)("div",{className:"grid flow-col col-gap-16",children:[h.map((function(e){return Object(v.jsxs)(i.a,{type:"ghost",style:{width:70},onClick:function(){m.setFieldsValue({slippage:Number(e)})},children:[e,"%"]},e)})),Object(v.jsx)(u.a.Item,{name:"slippage",rules:[{required:!0,message:"Required"},{validator:function(e,t){return t>0&&t<=100?Promise.resolve():Promise.reject()},message:"Enter a valid slippage percentage"}],noStyle:!0,children:Object(v.jsx)(b.a,{type:"number"})})]})}),c&&Object(v.jsx)(u.a.Item,{name:"deadline",label:"Transaction deadline",rules:[{required:!0,message:"Required"}],children:Object(v.jsx)(b.a,{type:"number",className:p.a.deadlineInput,suffix:Object(v.jsx)(j.b,{type:"p1",weight:"semibold",color:"primary",children:"minutes"})})}),Object(v.jsxs)("div",{className:"grid flow-col align-center justify-space-between",children:[Object(v.jsx)(i.a,{type:"light",onClick:O,children:"Reset changes"}),Object(v.jsx)(i.a,{type:"primary",htmlType:"submit",children:"Apply changes"})]})]})})};t.a=function(e){var t=e.className,n=e.showSlippage,s=void 0!==n&&n,l=e.slippage,u=e.slippageHint,b=e.showDeadline,O=void 0!==b&&b,h=e.deadline,y=e.onChange,k=Object(c.useState)(!1),g=Object(a.a)(k,2),N=g[0],w=g[1],A=o.a.useCallback((function(e){w(!1),null===y||void 0===y||y(e)}),[]);return Object(v.jsxs)("section",{className:r()(p.a.container,t),children:[Object(v.jsxs)("header",{className:"flex ph-24 pv-16",children:[Object(v.jsx)(j.b,{type:"p2",weight:"semibold",color:"secondary",children:e.children}),Object(v.jsx)(m.a,{title:"Customize transaction",overlayStyle:{width:423},content:Object(v.jsx)(x,{showSlippage:s,slippage:l,showDeadline:O,deadline:h,onChange:A}),visible:N,onVisibleChange:w,children:Object(v.jsx)(i.a,{type:"light",className:"ml-auto",children:Object(v.jsx)(f.a,{name:"gear"})})})]}),Object(v.jsx)(d.a,{}),Object(v.jsxs)("div",{className:"ph-24 pv-16",children:[s&&Object(v.jsxs)("div",{className:"flex mb-24",children:[Object(v.jsx)(j.a,{text:u,children:Object(v.jsx)(j.b,{type:"small",weight:"semibold",color:"secondary",children:"Slippage tolerance"})}),Object(v.jsxs)(j.b,{type:"small",weight:"semibold",color:"primary",className:"ml-auto",children:[l,"%"]})]}),O&&Object(v.jsxs)("div",{className:"flex",children:[Object(v.jsx)(j.a,{text:"Your transaction will revert if it isn't mined in this amount of time.",children:Object(v.jsx)(j.b,{type:"small",weight:"semibold",color:"secondary",children:"Transaction deadline"})}),Object(v.jsxs)(j.b,{type:"small",weight:"semibold",color:"primary",className:"ml-auto",children:[h," minutes"]})]})]})]})}},1457:function(e,t,n){e.exports={container:"s_container__2ZM0_",deadlineInput:"s_deadlineInput__pUUH-"}},1464:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(4),c=n(99),o=n(33),s=n(1),l=function(e){var t=e.children,n=e.className,l=e.style;return Object(s.jsx)(c.a,{title:t,children:Object(s.jsx)(o.a,{name:"info",size:16,className:n,style:Object(a.a)({flexShrink:0},l)})})}},1683:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return u}));var a=n(4),c=n(5),o=n(0),s=n(8),l=n.n(s),r=n(1361),i=n(1),d=function(e){var t=e.tokenAContract,n=e.tokenBContract,a=e.poolAddress,c=e.tranche,o=e.className;return!1!==t.isAllowedOf(a)&&!1!==n.isAllowedOf(a)?null:Object(i.jsxs)("div",{className:l()("flex align-center col-gap-24",o),children:[Object(i.jsx)(u,{contract:t,address:a,tokenSymbol:c.tokenA.symbol}),!1===t.isAllowedOf(a)&&!1===n.isAllowedOf(a)&&Object(i.jsx)("span",{className:"middle-dot color-border"}),Object(i.jsx)(u,{contract:n,address:a,tokenSymbol:c.tokenB.symbol})]})},u=function(e){var t=e.contract,n=e.address,s=e.tokenSymbol,d=e.className,u=e.style,b=void 0===u?{}:u,m=Object(o.useState)(!1),j=Object(c.a)(m,2),f=j[0],O=j[1];return!1!==t.isAllowedOf(n)?null:Object(i.jsxs)("button",{type:"button",className:l()("button-primary",d),style:Object(a.a)({flexGrow:1},b),disabled:f,onClick:function(){O(!0),t.approve(n,!0).finally((function(){return O(!1)}))},children:[f&&Object(i.jsx)(r.a,{className:"mr-8"}),"Enable ",s]})}},2291:function(e,t,n){"use strict";n.r(t);var a=n(5),c=n(0),o=n(56),s=n(65),l=n(38),r=n(1361),i=n(1368),d=n(12),u=n(183),b=n(415),m=n(1365),j=n(1437),f=n(1618),O=n(29),p=n(9),v=n.n(p),h=n(423),x=n(19),y=n.n(x),k=n(1683),g=n(63),N=n(1383),w=n(1464),A=n(1),_=function(e){var t,n,i,m,j,p,x,_,B,C=e.tranche,S=e.tokenAContract,T=e.tokenBContract,E=e.tokenEContract,P=Object(o.i)(),R=P.pool,M=P.tranche,F=Object(c.useState)(""),I=Object(a.a)(F,2),V=I[0],L=I[1],z=Object(c.useState)(""),D=Object(a.a)(z,2),Z=D[0],W=D[1],H=Object(c.useState)(),q=Object(a.a)(H,2),Y=q[0],G=q[1],U=Object(f.b)(R),J=Object(f.c)().ePoolHelperContract,$=Object(c.useState)(!1),K=Object(a.a)($,2),X=K[0],Q=K[1],ee=Object(u.c)().getTokenIconBySymbol,te=ee(C.tokenA.symbol),ne=ee(C.tokenB.symbol),ae=null!==(t=null===(n=S.balance)||void 0===n?void 0:n.unscaleBy(S.decimals))&&void 0!==t?t:y.a.ZERO,ce=null!==(i=null===(m=T.balance)||void 0===m?void 0:m.unscaleBy(T.decimals))&&void 0!==i?i:y.a.ZERO,oe=Object(h.a)((function(e){var t;if(J){var n=null===(t=y.a.from(e))||void 0===t?void 0:t.scaleBy(C.tokenA.decimals);n?J.getTokenBForTokenA(R,M,n).then((function(e){var t,n;return W(null!==(t=null===e||void 0===e||null===(n=e.unscaleBy(C.tokenB.decimals))||void 0===n?void 0:n.toString())&&void 0!==t?t:"")})):W("")}}),400),se=Object(h.a)((function(e){var t;if(J){var n=null===(t=y.a.from(e))||void 0===t?void 0:t.scaleBy(C.tokenB.decimals);n?J.getTokenAForTokenB(R,M,n).then((function(e){var t,n;return L(null!==(t=null===e||void 0===e||null===(n=e.unscaleBy(C.tokenA.decimals))||void 0===n?void 0:n.toString())&&void 0!==t?t:"")})):L("")}}),400);Object(c.useEffect)((function(){var e,t,n=null===(e=y.a.from(V))||void 0===e?void 0:e.scaleBy(C.tokenA.decimals),a=null===(t=y.a.from(Z))||void 0===t?void 0:t.scaleBy(C.tokenB.decimals);n&&a?null===J||void 0===J||J.getETokenForTokenATokenB(R,M,n,a).then((function(e){return G(y.a.from(e))})):G(void 0)}),[V,Z,J,C,R,M]);var le=function(){var e=Object(O.a)(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),Y){e.next=3;break}return e.abrupt("return");case 3:return Q(!0),e.prev=4,e.next=7,null===U||void 0===U?void 0:U.deposit(M,Y);case 7:L(""),W(""),G(void 0),S.loadBalance(),T.loadBalance(),E.loadBalance(),e.next=17;break;case 15:e.prev=15,e.t0=e.catch(4);case 17:return e.prev=17,Q(!1),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[4,15,17,20]])})));return function(t){return e.apply(this,arguments)}}(),re=Object(c.useMemo)((function(){var e=[];return V&&!V.match(/^(\d+\.?\d*|\.\d+)$/)&&e.push("Wrong number format"),ae.isLessThan(V)&&e.push("Insufficient balance"),e}),[ae,V]),ie=Object(c.useMemo)((function(){var e=[];return Z&&!Z.match(/^(\d+\.?\d*|\.\d+)$/)&&e.push("Wrong number format"),ce.isLessThan(Z)&&e.push("Insufficient balance"),e}),[ce,Z]),de=!V||!Z||!!re.length||!!ie.length||!1===S.isAllowedOf(R)||!1===T.isAllowedOf(R);return U?Object(A.jsxs)("form",{onSubmit:le,children:[Object(A.jsxs)("div",{className:"flex mb-8",children:[Object(A.jsxs)("span",{className:"text-sm fw-semibold color-secondary",children:[C.tokenA.symbol," amount"]}),Object(A.jsxs)("span",{className:"text-sm fw-semibold color-secondary ml-auto",children:["Current ratio: ",Object(s.c)(Number(C.tokenARatio))]})]}),Object(A.jsx)(N.a,{before:Object(A.jsx)(b.a,{name:te,size:24}),value:V,secondary:Object(s.e)(null!==(j=null===(p=y.a.from(V))||void 0===p?void 0:p.multipliedBy(C.tokenA.state.price))&&void 0!==j?j:0),onChange:function(e){L(e),oe(e)},max:ae,placeholder:"0 (Max ".concat(null!==ae&&void 0!==ae?ae:0,")"),className:"mb-16",errors:re}),Object(A.jsx)(g.a,{name:"plus-circle",width:32,height:32,style:{display:"block",margin:"0 auto"}}),Object(A.jsxs)("div",{className:"flex mb-8",children:[Object(A.jsxs)("span",{className:"text-sm fw-semibold color-secondary",children:[C.tokenB.symbol," amount"]}),Object(A.jsxs)("span",{className:"text-sm fw-semibold color-secondary ml-auto",children:["Current ratio: ",Object(s.c)(Number(C.tokenBRatio))]})]}),Object(A.jsx)(N.a,{before:Object(A.jsx)(b.a,{name:ne,size:24}),value:Z,secondary:Object(s.e)(null!==(x=null===(_=y.a.from(Z))||void 0===_?void 0:_.multipliedBy(C.tokenB.state.price))&&void 0!==x?x:0),onChange:function(e){W(e),se(e)},max:ce,placeholder:"0 (Max ".concat(null!==ce&&void 0!==ce?ce:0,")"),className:"mb-16",errors:ie}),Object(A.jsx)(g.a,{name:"down-arrow-circle",width:32,height:32,style:{display:"block",margin:"0 auto"}}),Object(A.jsxs)("div",{className:"flex mb-8",children:[Object(A.jsxs)(d.b,{type:"small",weight:"semibold",color:"secondary",className:"flex align-middle col-gap-4",children:[C.eTokenSymbol," amount ",Object(A.jsx)(w.a,{children:"These tokens represent your share in the tranche."})]}),Object(A.jsxs)("span",{className:"text-sm fw-semibold color-secondary ml-auto",children:[Object(s.e)(Number(C.state.eTokenPrice))," per ",C.eTokenSymbol]})]}),Object(A.jsx)(N.b,{before:Object(A.jsx)(b.b,{name1:te,name2:ne,size:24}),value:null!==(B=Object(s.d)(null===Y||void 0===Y?void 0:Y.dividedBy(C.sFactorE)))&&void 0!==B?B:"0",secondary:Object(s.e)(null===Y||void 0===Y?void 0:Y.dividedBy(C.sFactorE).multipliedBy(C.state.eTokenPrice)),className:"mb-32"}),Object(A.jsx)(k.b,{tokenAContract:S,tokenBContract:T,poolAddress:R,tranche:C,className:"mb-32"}),Object(A.jsxs)("div",{className:"grid flow-col col-gap-32 align-center justify-space-between",children:[Object(A.jsx)(l.e,{to:"/smart-exposure/pools/".concat(R,"/").concat(M),variation:"text-alt",size:"small",icon:"arrow",iconPosition:"left",iconRotate:180,children:"Cancel"}),Object(A.jsxs)("button",{type:"submit",className:"button-primary",disabled:X||de,children:[X&&Object(A.jsx)(r.a,{className:"mr-8"}),"Deposit"]})]})]}):null},B=n(66),C=n(1456),S=n(14),T=n(16),E=n(23),P=n(24),R=n(37),M=function(e){Object(E.a)(n,e);var t=Object(P.a)(n);function n(e){return Object(S.a)(this,n),t.call(this,[Object(R.c)("getAmountsOut",["uint256","address[]"],["uint256[]"]),{inputs:[{internalType:"uint256",name:"amountOut",type:"uint256"},{internalType:"address[]",name:"path",type:"address[]"}],name:"getAmountsIn",outputs:[{internalType:"uint256[]",name:"amounts",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"amountOut",type:"uint256"},{internalType:"uint256",name:"amountInMax",type:"uint256"},{internalType:"address[]",name:"path",type:"address[]"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"deadline",type:"uint256"}],name:"swapTokensForExactTokens",outputs:[{internalType:"uint256[]",name:"amounts",type:"uint256[]"}],stateMutability:"nonpayable",type:"function"}],e,"UniswapRouter")}return Object(T.a)(n,[{key:"getAmountsOut",value:function(e,t){return this.call("getAmountsOut",[e,t]).then((function(e){return e.map((function(e){var t;return null!==(t=y.a.from(e))&&void 0!==t?t:y.a.ZERO}))}))}},{key:"getAmountsIn",value:function(e,t){return this.call("getAmountsIn",[e,t]).then((function(e){return e.map((function(e){var t;return null!==(t=y.a.from(e))&&void 0!==t?t:y.a.ZERO}))}))}},{key:"swapTokensForExactTokens",value:function(e,t,n,a,c){return this.send("swapTokensForExactTokens",[e,t,n,a,c])}}]),n}(R.d),F=n(73),I=n(60),V=function(e){var t,n,i,d,m,j,O,p,v,x,w,_,S,T=e.tranche,E=e.tokenAContract,P=e.tokenBContract,R=e.tokenEContract,V=Object(F.c)(),L=Object(o.i)(),z=L.pool,D=L.tranche,Z=[T.tokenA.symbol,T.tokenB.symbol],W=Object(u.c)().getTokenIconBySymbol,H=Object(c.useState)(Z[0]),q=Object(a.a)(H,2),Y=q[0],G=q[1],U=Object(c.useState)(""),J=Object(a.a)(U,2),$=J[0],K=J[1],X=Object(c.useState)(),Q=Object(a.a)(X,2),ee=Q[0],te=Q[1],ne=Object(c.useState)(),ae=Object(a.a)(ne,2),ce=ae[0],oe=ae[1],se=Object(c.useState)(),le=Object(a.a)(se,2),re=le[0],ie=le[1],de=Object(c.useState)(),ue=Object(a.a)(de,2),be=ue[0],me=ue[1],je=Object(f.c)(),fe=je.ePoolPeripheryContract,Oe=je.ePoolHelperContract,pe=Object(c.useState)({deadline:20,slippage:.5}),ve=Object(a.a)(pe,2),he=ve[0],xe=ve[1],ye=Object(c.useState)(!1),ke=Object(a.a)(ye,2),ge=ke[0],Ne=ke[1],we=Object(B.c)().getContract,Ae=Y===T.tokenA.symbol,_e=Ae?E:P,Be=T[Ae?"tokenA":"tokenB"].decimals;Object(c.useEffect)((function(){K(""),te(void 0),oe(void 0),me(void 0)}),[Ae]),Object(c.useEffect)((function(){null===fe||void 0===fe||fe.getRouter().then((function(e){var t=we(e,(function(){return new M(e)}));ie(t)}))}),[fe]),Object(c.useEffect)((function(){null!==re&&void 0!==re&&re.address&&_e.loadAllowance(null===re||void 0===re?void 0:re.address)}),[_e,null===re||void 0===re?void 0:re.address]);var Ce=W(T.tokenA.symbol),Se=W(T.tokenB.symbol),Te=null!==(t=null===(n=_e.getBalanceOf(V.account))||void 0===n?void 0:n.unscaleBy(Be))&&void 0!==t?t:y.a.ZERO,Ee=Object(c.useCallback)((function(e,t){var n;me(void 0);var a=null===(n=y.a.from(e))||void 0===n?void 0:n.scaleBy(Be);a&&Oe&&(null===Oe||void 0===Oe||Oe[t?"getTokenATokenBForTokenA":"getTokenATokenBForTokenB"](z,D,a).then((function(e){var n=e.amountA,a=e.amountB;te(n),oe(a),null===re||void 0===re||re.getAmountsIn(t?a:n,t?[T.tokenA.address,T.tokenB.address]:[T.tokenB.address,T.tokenA.address]).then((function(e){me(e[t?0:1])})).catch((function(e){console.error(e)}))})).catch((function(e){console.error(e)})))}),[Oe,z,D,Be,T.tokenA.address,T.tokenB.address,re]),Pe=Object(h.a)(Ee,400);Object(c.useEffect)((function(){te(void 0),oe(void 0),Pe($,Ae)}),[Pe,$,Ae]);var Re=null!==(i=null===(d=_e.balance)||void 0===d?void 0:d.unscaleBy(_e.decimals))&&void 0!==i?i:y.a.ZERO,Me=Object(c.useMemo)((function(){var e=[];return $&&!$.match(/^(\d+\.?\d*|\.\d+)$/)&&e.push("Wrong number format"),Re.isLessThan($)&&e.push("Insufficient balance"),e}),[Re,$]),Fe=!$||!!Me.length||!(null===re||void 0===re||!re.address)&&!1===_e.isAllowedOf(null!==(m=null===re||void 0===re?void 0:re.address)&&void 0!==m?m:"");return Object(A.jsxs)("form",{onSubmit:function(e){var t,n;e.preventDefault();var a=Ae?ce:ee;if(a&&V.account){Ne(!0);var c=Math.floor(Date.now()/1e3+60*Number(he.deadline));null===re||void 0===re||re.swapTokensForExactTokens(a,null!==(t=null===be||void 0===be?void 0:be.multipliedBy(1+(null!==(n=he.slippage)&&void 0!==n?n:0)/100).integerValue())&&void 0!==t?t:y.a.ZERO,Ae?[T.tokenA.address,T.tokenB.address]:[T.tokenB.address,T.tokenA.address],V.account,c).then((function(){K(""),E.loadBalance(),P.loadBalance(),R.loadBalance()})).catch((function(e){console.error(e)})),Ne(!1)}},children:[Object(A.jsx)("div",{className:"flex mb-8",children:Object(A.jsxs)("span",{className:"text-sm fw-semibold color-secondary",children:[Y," amount"]})}),Object(A.jsx)(N.a,{before:Object(A.jsx)(N.c,{value:Y,onChange:G,tokens:Z}),value:$,secondary:Object(s.e)(null!==(j=null===(O=y.a.from($))||void 0===O?void 0:O.multipliedBy(T[Ae?"tokenA":"tokenB"].state.price))&&void 0!==j?j:0),onChange:K,max:Te,placeholder:"0 (Max ".concat(Te,")"),className:"mb-16",classNameBefore:"ph-0",errors:Me}),Object(A.jsx)(g.a,{name:"down-arrow-circle",width:32,height:32,style:{display:"block",margin:"0 auto"}}),Object(A.jsxs)("div",{className:"css-grid mb-32",style:{"--gap":"32px"},children:[Object(A.jsxs)("div",{children:[Object(A.jsxs)("div",{className:"flex mb-8",children:[Object(A.jsxs)("span",{className:"text-sm fw-semibold color-secondary",children:[T.tokenA.symbol," amount"]}),Object(A.jsxs)("span",{className:"text-sm fw-semibold color-secondary ml-auto",children:[Object(I.i)(100*Number(T.tokenARatio),{minimumFractionDigits:2}),"%"]})]}),Object(A.jsx)(N.b,{before:Object(A.jsx)(b.a,{name:Ce,size:24}),value:(null===ee||void 0===ee||null===(p=ee.unscaleBy(T.tokenA.decimals))||void 0===p?void 0:p.toString())||"0",secondary:Object(s.e)(null!==(v=null===ee||void 0===ee||null===(x=ee.unscaleBy(T.tokenA.decimals))||void 0===x?void 0:x.multipliedBy(T.tokenA.state.price))&&void 0!==v?v:0)})]}),Object(A.jsxs)("div",{children:[Object(A.jsxs)("div",{className:"flex mb-8",children:[Object(A.jsxs)("span",{className:"text-sm fw-semibold color-secondary",children:[T.tokenB.symbol," amount"]}),Object(A.jsxs)("span",{className:"text-sm fw-semibold color-secondary ml-auto",children:[Object(I.i)(100*Number(T.tokenBRatio),{minimumFractionDigits:2}),"%"]})]}),Object(A.jsx)(N.b,{before:Object(A.jsx)(b.a,{name:Se,size:24}),value:(null===ce||void 0===ce||null===(w=ce.unscaleBy(T.tokenB.decimals))||void 0===w?void 0:w.toString())||"0",secondary:Object(s.e)(null!==(_=null===ce||void 0===ce||null===(S=ce.unscaleBy(T.tokenB.decimals))||void 0===S?void 0:S.multipliedBy(T.tokenB.state.price))&&void 0!==_?_:0)})]})]}),Object(A.jsx)(C.a,{className:"mb-32",showSlippage:!0,slippage:he.slippage,slippageHint:"Your transaction will revert if the amount of tokens you actually receive is smaller by this percentage.",showDeadline:!0,deadline:he.deadline,onChange:xe,children:"Swap transaction details"}),null!==re&&void 0!==re&&re.address?Object(A.jsx)(k.a,{contract:_e,address:re.address,tokenSymbol:Y,className:"mb-32",style:{width:"100%"}}):null,Object(A.jsxs)("div",{className:"grid flow-col col-gap-32 align-center justify-space-between",children:[Object(A.jsx)(l.e,{to:"/smart-exposure/pools/".concat(z,"/").concat(D),variation:"text-alt",size:"small",icon:"arrow",iconPosition:"left",iconRotate:180,children:"Cancel"}),Object(A.jsxs)("button",{type:"submit",className:"button-primary",disabled:ge||Fe,children:[ge&&Object(A.jsx)(r.a,{className:"mr-8"}),"Swap"]})]})]})},L=[{children:"Deposit",id:"deposit"},{children:"Swap",id:"swap"}];t.default=function(){var e,t,n,O=Object(o.i)(),p=O.pool,v=O.tranche,h=Object(u.c)(),x=h.getTokenBySymbol,y=h.getTokenIconBySymbol,k=Object(c.useState)(),g=Object(a.a)(k,2),N=g[0],w=g[1],B=Object(c.useState)("deposit"),C=Object(a.a)(B,2),S=C[0],T=C[1],E=Object(f.c)().ePoolPeripheryContract,P=Object(j.c)(),R=Object(m.a)(null===N||void 0===N?void 0:N.tokenA.address,{loadAllowance:[p,E.address],loadCommon:!0,loadBalance:!0}),M=Object(m.a)(null===N||void 0===N?void 0:N.tokenB.address,{loadAllowance:[p,E.address],loadCommon:!0,loadBalance:!0}),F=Object(m.a)(v,{loadCommon:!0,loadBalance:!0});if(Object(c.useEffect)((function(){P.fetchTranche(v).then((function(e){w(e)}))}),[v]),!N||!R||!M||!F)return Object(A.jsx)(r.a,{className:"mh-auto"});var I=x(N.tokenA.symbol),z=x(N.tokenB.symbol),D=y(N.tokenA.symbol),Z=y(N.tokenB.symbol);return Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)("div",{className:"flex mb-16",children:Object(A.jsx)(l.e,{to:"/smart-exposure/pools/".concat(p,"/").concat(v),variation:"text-alt",icon:"arrow",iconPosition:"left",iconRotate:180,children:"Tranche details"})}),Object(A.jsxs)("div",{className:"flex justify-center row-gap-12 col-gap-64 mb-40",children:[Object(A.jsxs)("div",{className:"flex",children:[Object(A.jsx)(b.b,{name1:D,name2:Z,size:40,className:"mr-16"}),Object(A.jsxs)("div",{children:[Object(A.jsx)("div",{className:"text-p1 fw-semibold color-primary mr-4",children:"".concat(100*Number(N.tokenARatio),"% ").concat(N.tokenA.symbol," / ").concat(100*Number(N.tokenBRatio),"% ").concat(N.tokenB.symbol)}),Object(A.jsx)("div",{className:"text-sm fw-semibold color-secondary",children:"".concat(null===I||void 0===I?void 0:I.name," / ").concat(null===z||void 0===z?void 0:z.name)})]})]}),Object(A.jsxs)("div",{children:[Object(A.jsxs)("div",{className:"text-sm fw-semibold color-secondary mb-4",children:["Wallet ",N.tokenA.symbol," balance"]}),Object(A.jsxs)("div",{children:[Object(A.jsx)("span",{className:"text-p1 fw-semibold color-primary mr-8",children:null!==(e=Object(s.d)(R.balance,{scale:N.tokenA.decimals}))&&void 0!==e?e:"-"}),Object(A.jsx)("span",{className:"text-sm fw-semibold color-secondary",children:N.tokenA.symbol})]})]}),Object(A.jsxs)("div",{children:[Object(A.jsxs)("div",{className:"text-sm fw-semibold color-secondary mb-4",children:["Wallet ",N.tokenB.symbol," balance"]}),Object(A.jsxs)("div",{children:[Object(A.jsxs)("span",{className:"text-p1 fw-semibold color-primary mr-8",children:[" ",null!==(t=Object(s.d)(M.balance,{scale:N.tokenB.decimals}))&&void 0!==t?t:"-"]}),Object(A.jsx)("span",{className:"text-sm fw-semibold color-secondary",children:N.tokenB.symbol})]})]}),Object(A.jsxs)("div",{children:[Object(A.jsxs)("div",{className:"text-sm fw-semibold color-secondary mb-4",children:["Wallet ",N.eTokenSymbol," balance"]}),Object(A.jsxs)("div",{children:[Object(A.jsx)("span",{className:"text-p1 fw-semibold color-primary mr-8",children:null!==(n=Object(s.d)(F.balance,{scale:F.decimals}))&&void 0!==n?n:"-"}),Object(A.jsx)("span",{className:"text-sm fw-semibold color-secondary",children:N.eTokenSymbol})]})]})]}),Object(A.jsxs)("div",{className:"card ph-32 pv-32 mh-auto",style:{width:"100%",maxWidth:640},children:[Object(A.jsx)(d.b,{type:"h3",weight:"semibold",color:"primary",className:"mb-16",children:"deposit"===S?"Deposit":"Swap"}),Object(A.jsx)(d.b,{type:"p2",weight:"semibold",color:"secondary",className:"mb-32",children:"deposit"===S?"Build your SMART Exposure position by minting eTokens with both the tokens in the tranche according to the current tranche ratio.":"Start building your SMART Exposure position by swapping a specified amount of input token, in order to be able to purchase eTokens. This is where the slippage and deadline parameters will be used."}),Object(A.jsx)(i.g,{tabs:L,activeKey:S,onClick:T,className:"mb-32",variation:"elastic",size:"small"}),"deposit"===S?Object(A.jsx)(_,{tranche:N,tokenAContract:R,tokenBContract:M,tokenEContract:F}):Object(A.jsx)(V,{tranche:N,tokenAContract:R,tokenBContract:M,tokenEContract:F})]})]})}}}]);
//# sourceMappingURL=43.fa65c398.chunk.js.map